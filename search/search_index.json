{"config":{"lang":["ja"],"separator":"[\\s\\-\uff0c\u3002]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u4f7f\u7528","text":"<p>\u672c\u6846\u67b6\u4f7f\u7528Android\u4e3b\u6d41\u7684Http\u6846\u67b6OkHttp\u4f5c\u4e3a\u8bf7\u6c42\u5185\u6838, \u9075\u5b88\u4e0d\u5f71\u54cdOkHttp\u539f\u6709\u7684\u51fd\u6570\u7ec4\u4ef6\u4f7f\u7528\u539f\u5219\u5f00\u53d1</p> <p></p> <p>STAR/\u5206\u4eab\u53ef\u4ee5\u8ba9\u66f4\u591a\u4eba\u53c2\u4e0e\u5230\u672c\u5f00\u6e90\u9879\u76ee, \u70b9\u51fb\u6587\u6863\u53f3\u4e0a\u89d2\u5c0f\u94c5\u7b14\u53ef\u76f4\u63a5\u4fee\u8ba2\u6587\u6863 \u2197</p> <p></p>"},{"location":"#_1","title":"\u524d\u8a00","text":"<ol> <li>\u4efb\u4f55\u672c\u6587\u6863\u6ca1\u6709\u63d0\u5230\u7684\u529f\u80fd\u90fd\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22<code>\"OkHttp\u5982\u4f55**\"</code>\u6765\u89e3\u51b3, \u56e0\u4e3a\u672c\u6846\u67b6\u652f\u6301OkHttp\u6240\u6709\u529f\u80fd/\u7ec4\u4ef6</li> <li>\u5efa\u8bae\u521b\u5efa\u4e00\u4e2aApi.kt\u7684<code>object</code>\u5355\u4f8b\u7c7b\u5b58\u50a8\u6240\u6709\u8bf7\u6c42\u8def\u5f84\u5e38\u91cf</li> <li><code>Post/Get\u7b49</code>\u51fd\u6570\u5c5e\u4e8e\u8bf7\u6c42\u52a8\u4f5c. <code>scope**</code>\u7b49\u51fd\u6570\u5c5e\u4e8e\u4f5c\u7528\u57df, \u5047\u8bbe\u4f60\u6709\u67d0\u4e2a\u8bf7\u6c42\u9700\u8981\u91cd\u590d\u4f7f\u7528\u5efa\u8bae\u5c01\u88c5<code>\u8bf7\u6c42\u52a8\u4f5c</code>\u800c\u4e0d\u662f\u4f5c\u7528\u57df</li> <li>\u5982\u679c\u4f60\u89c9\u5f97\u6587\u6863\u770b\u4e0d\u61c2\u6216\u8005\u6709\u6b67\u4e49\u90a3\u80af\u5b9a\u662f\u4f5c\u8005\u95ee\u9898, \u8bf7\u53cd\u9988\u7ed9\u4f5c\u8005\u6216\u8005\u81ea\u6211\u4fee\u8ba2</li> </ol>"},{"location":"#_2","title":"\u4f7f\u7528","text":"<p> \u8fd9\u91cc\u6f14\u793a\u53d1\u8d77\u7f51\u7edc<code>\u8bf7\u6c42\u767e\u5ea6\u7f51\u7ad9</code>\u5185\u5bb9\u7684\u4e09\u4e2a\u6b65\u9aa4</p> <ol> <li>\u521b\u5efa\u4f5c\u7528\u57df</li> <li>\u53d1\u8d77\u8bf7\u6c42</li> <li>\u63a5\u6536\u6570\u636e</li> </ol> \u5355\u4e2a\u8bf7\u6c42 <pre><code>scopeNetLife { // \u521b\u5efa\u4f5c\u7528\u57df\n// \u8fd9\u4e2a\u5927\u62ec\u53f7\u5185\u5c31\u5c5e\u4e8e\u4f5c\u7528\u57df\u5185\u90e8\nval data = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await() // \u53d1\u8d77GET\u8bf7\u6c42\u5e76\u8fd4\u56de`String`\u7c7b\u578b\u6570\u636e\n}\n</code></pre> \u4e32\u884c\u8bf7\u6c42 <pre><code>scopeNetLife {\nval data = Get&lt;String&gt;(\"http://www.baidu.com/\").await() // \u8bf7\u6c42A \u53d1\u8d77GET\u8bf7\u6c42\u5e76\u8fd4\u56de\u6570\u636e\nval data = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await() // \u8bf7\u6c42B \u5c06\u7b49\u5f85A\u8bf7\u6c42\u5b8c\u6bd5\u540e\u53d1\u8d77GET\u8bf7\u6c42\u5e76\u8fd4\u56de\u6570\u636e\n}\n</code></pre> \u5e76\u53d1\u8bf7\u6c42 <pre><code>scopeNetLife {\n// \u4ee5\u4e0b\u4e24\u4e2a\u7f51\u7edc\u8bf7\u6c42\u5c5e\u4e8e\u540c\u65f6\u8fdb\u884c\u4e2d\nval aDeferred = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\") // \u53d1\u8d77GET\u8bf7\u6c42\u5e76\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61(Deferred)\u8868\u793a\"\u4efb\u52a1A\"\nval bDeferred = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\") // \u53d1\u8d77\u8bf7\u6c42\u5e76\u8fd4\u56de\"\u4efb\u52a1B\"\n\n// \u968f\u4efb\u52a1\u540c\u65f6\u8fdb\u884c, \u4f46\u662f\u6570\u636e\u4f9d\u7136\u53ef\u4ee5\u6309\u5e8f\u8fd4\u56de\nval aData = aDeferred.await() // \u7b49\u5f85\u4efb\u52a1A\u8fd4\u56de\u6570\u636e\nval bData = bDeferred.await() // \u7b49\u5f85\u4efb\u52a1B\u8fd4\u56de\u6570\u636e\n}\n</code></pre> <p>\u591a\u4e2a\u7f51\u7edc\u8bf7\u6c42\u653e\u5728\u540c\u4e00\u4e2a\u4f5c\u7528\u57df\u5185\u5c31\u53ef\u4ee5\u7edf\u4e00\u63a7\u5236, \u5982\u679c\u4f60\u7684\u591a\u4e2a\u7f51\u7edc\u8bf7\u6c42\u6beb\u65e0\u5173\u8054, \u4f60\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u4f5c\u7528\u57df.</p> <p>\u591a\u8fdb\u7a0b\u6216Xposed\u9879\u76ee\u8981\u6c42\u521d\u59cb\u5316</p> <p></p> <p>\u5f53<code>Get</code>\u6216<code>Post</code>\u7b49\u51fd\u6570\u8c03\u7528\u5c31\u4f1a\u5f00\u59cb\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42, <code>await</code>\u53ea\u662f\u7b49\u5f85\u5176\u8bf7\u6c42\u6210\u529f\u8fd4\u56de\u7ed3\u679c, \u6240\u4ee5\u5982\u679c\u4f60\u5728<code>await</code>\u540e\u6267\u884c\u7684\u7f51\u7edc\u8bf7\u6c42,\u8fd9\u4e0d\u5c5e\u4e8e\u5e76\u53d1(\u5c5e\u4e8e\u4e32\u884c)</p> <p>\u5e76\u53d1\u7684\u9519\u8bef\u793a\u4f8b <pre><code>scopeNetLife {\n// \u8bf7\u6c42A\nval aDeferred = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\n// \u8bf7\u6c42B, \u7531\u4e8e\u4e0a\u9762\u4f7f\u7528`await()`\u51fd\u6570, \u6240\u4ee5\u5fc5\u987b\u7b49\u5f85A\u8bf7\u6c42\u8fd4\u56de\u7ed3\u679c\u540e\u624d\u4f1a\u6267\u884cB\nval bDeferred = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\")\n\nval bData = bDeferred.await() // \u7b49\u5f85\u4efb\u52a1B\u8fd4\u56de\u6570\u636e\n}\n</code></pre></p>"},{"location":"#_3","title":"\u8fd4\u56de\u7ed3\u679c","text":"<p>\u8fd4\u56de\u7ed3\u679c\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b(\u5373Post\u7b49\u51fd\u6570\u7684<code>\u6cdb\u578b</code>)\u7531\u8f6c\u6362\u5668\u51b3\u5b9a, \u9ed8\u8ba4\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b</p> \u51fd\u6570 \u63cf\u8ff0 String \u5b57\u7b26\u4e32 ByteArray \u5b57\u8282\u6570\u7ec4 ByteString \u5185\u90e8\u5b9a\u4e49\u7684\u4e00\u79cd\u5b57\u7b26\u4e32\u5bf9\u8c61 Response \u6700\u57fa\u7840\u7684\u54cd\u5e94 File \u6587\u4ef6\u5bf9\u8c61, \u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5e94\u5f53\u79f0\u4e3a\u4e0b\u8f7d\u6587\u4ef6 <p>\u975e\u4ee5\u4e0a\u7c7b\u578b\u8981\u6c42\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668</p> <p>\u8f6c\u6362\u5668\u7684\u8fd4\u56de\u503c\u51b3\u5b9a\u4f60\u7684\u7f51\u7edc\u8bf7\u6c42\u7684\u8fd4\u56de\u7ed3\u679c\u7c7b\u578b, \u4f60\u751a\u81f3\u53ef\u4ee5\u8fd4\u56denull, \u524d\u63d0\u662f\u6cdb\u578b\u4e3a\u53ef\u7a7a\u7c7b\u578b</p>"},{"location":"#restful","title":"RestFul","text":"<p>Net\u652f\u6301RestFul\u8bbe\u8ba1\u98ce\u683c</p> <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Post&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Head&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Put&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Patch&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Delete&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Trace&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\ntvFragment.text = Options&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\n}\n</code></pre>"},{"location":"#_4","title":"\u51fd\u6570","text":"<p>\u9ed8\u8ba4\u5728IO\u7ebf\u7a0b\u6267\u884c\u7f51\u7edc\u8bf7\u6c42(\u901a\u8fc7\u4f5c\u7528\u57df\u53c2\u6570\u53ef\u4ee5\u63a7\u5236Dispatch\u8c03\u5ea6\u5668), \u8981\u6c42\u5728\u534f\u7a0b\u4f5c\u7528\u57df\u5185\u6267\u884c.</p> \u8bf7\u6c42\u51fd\u6570 \u63cf\u8ff0 Get \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Post \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Head \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Options \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Trace \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Delete \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Put \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Patch \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5"},{"location":"auto-dialog/","title":"\u81ea\u52a8\u52a0\u8f7d\u6846","text":"<p>Net\u652f\u6301\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\u81ea\u52a8\u5f39\u51fa\u548c\u5173\u95ed\u5bf9\u8bdd\u6846(Loading Dialog)</p>"},{"location":"auto-dialog/#_1","title":"\u81ea\u52a8\u663e\u793a\u52a0\u8f7d\u6846","text":"<p>\u53ea\u9700\u8981\u4f7f\u7528<code>scopeDialog</code>\u4f5c\u7528\u57df\u5373\u53ef. <pre><code>scopeDialog {\ntvFragment.text = Post&lt;String&gt;(\"dialog\") {\nparam(\"u_name\", \"drake\") // \u8bf7\u6c42\u53c2\u6570\nparam(\"pwd\", \"123456\")\n}.await()\n}\n</code></pre></p> <p></p> <p>\u52a0\u8f7d\u6846\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fAndroid\u539f\u751f\u52a0\u8f7d\u6846(MaterialDesign Dialog), \u5f53\u7136\u4e5f\u63d0\u4f9b\u53c2\u6570\u4f20\u5165\u6307\u5b9a\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5bf9\u8bdd\u6846</p> <p></p>"},{"location":"auto-dialog/#_2","title":"\u6307\u5b9a\u5355\u4f8b\u52a0\u8f7d\u6846","text":"<p>\u5c31\u662f\u4ec5\u9488\u5bf9\u5f53\u524d\u7f51\u7edc\u8bf7\u6c42\u6307\u5b9a\u52a0\u8f7d\u6846</p> <pre><code>val dialog = BubbleDialog(requireActivity(), \"\u52a0\u8f7d\u4e2d\")\n\nscopeDialog(dialog) {\nbinding.tvFragment.text = Post&lt;String&gt;(\"dialog\") {\nparam(\"u_name\", \"drake\")\nparam(\"pwd\", \"123456\")\n}.await()\n}\n</code></pre> <p></p> <p>\u8fd9\u91cc\u4f7f\u7528\u7684iOS\u98ce\u683c\u5bf9\u8bdd\u6846: BubbleDialog</p>"},{"location":"auto-dialog/#_3","title":"\u6307\u5b9a\u5168\u5c40\u52a0\u8f7d\u6846","text":"<p>\u5728Application\u4e2d\u914d\u7f6eNet\u65f6\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u9ed8\u8ba4\u7684Dialog</p> \u521d\u59cb\u914d\u7f6e\u5168\u5c40\u52a0\u8f7d\u6846 <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nsetDialogFactory { // \u5168\u5c40\u52a0\u8f7d\u5bf9\u8bdd\u6846\nProgressDialog(it).apply {\nsetMessage(\"\u6211\u662f\u5168\u5c40\u81ea\u5b9a\u4e49\u7684\u52a0\u8f7d\u5bf9\u8bdd\u6846...\")\n}\n}\n}\n</code></pre> \u4fee\u6539\u5168\u5c40\u52a0\u8f7d\u6846 <pre><code>NetConfig.dialogFactory = NetDialogFactory {\nProgressDialog(it).apply {\nsetMessage(\"\u6211\u662f\u5168\u5c40\u81ea\u5b9a\u4e49\u7684\u52a0\u8f7d\u5bf9\u8bdd\u6846...\")\n}\n}\n</code></pre> <p></p> <p>\u5982\u679c\u4e0d\u60f3\u4fee\u6539\u5168\u5c40\u52a0\u8f7d\u6846\u6837\u5f0f\u53ea\u662f\u4fee\u6539\u52a0\u8f7d\u6846\u6587\u672c, \u53ef\u4ee5\u8986\u76d6\u6587\u672c(\u56fd\u9645\u5316\u540c\u7406)</p> <p>\u5728\u5f53\u524d\u9879\u76ee\u4e0b\u7684values\u76ee\u5f55\u4e0b\u7684strings.xml\u6dfb\u52a0\u4ee5\u4e0b\u4e00\u884c\u53ef\u4ee5\u4fee\u6539\u6587\u672c</p> <pre><code>&lt;!--\u5bf9\u8bdd\u6846--&gt;\n&lt;string name=\"net_dialog_msg\"&gt;\u52a0\u8f7d\u4e2d&lt;/string&gt;\n</code></pre>"},{"location":"auto-dialog/#_4","title":"\u751f\u547d\u5468\u671f","text":"<p>\u4f7f\u7528<code>scopeDialog</code>\u53d1\u8d77\u8bf7\u6c42\u540e, Dialog\u5206\u4e3a\u4ee5\u4e0b\u4e09\u4e2a\u751f\u547d\u5468\u671f</p> \u751f\u547d\u5468\u671f \u63cf\u8ff0 Dialog \u663e\u793a \u6267\u884c<code>scopeDialog</code>\u65f6\u663e\u793a\u52a0\u8f7d\u6846 Dialog \u81ea\u52a8\u7ed3\u675f \u4f5c\u7528\u57df\u5185\u4efb\u52a1\u7ed3\u675f\u65f6\u5173\u95ed\u52a0\u8f7d\u6846 Dialog \u624b\u52a8\u7ed3\u675f \u52a0\u8f7d\u6846\u88ab\u624b\u52a8\u53d6\u6d88\u65f6\u53d6\u6d88\u4f5c\u7528\u57df\u5185\u7f51\u7edc\u8bf7\u6c42"},{"location":"auto-dialog/#_5","title":"\u81ea\u5b9a\u4e49\u52a0\u8f7d\u5bf9\u8bdd\u6846","text":"<p>\u6211\u60f3\u8981\u81ea\u5b9a\u4e49\u52a0\u8f7d\u6846\u89c6\u56fe</p> <ul> <li>Dialog\u5c5e\u4e8e\u5e03\u5c40\u5bb9\u5668, \u4f60\u53ef\u4ee5\u7ee7\u627fDialog\u7136\u540e\u521b\u5efa\u5c5e\u4e8e\u81ea\u5df1\u7684\u663e\u793a\u5185\u5bb9(\u7c7b\u4f3cActivity/Fragment), \u6bd4\u5982\u8be5iOS\u98ce\u683c\u5bf9\u8bdd\u6846</li> </ul> <p></p> <p>\u6211\u7684\u52a0\u8f7d\u6846\u4e0d\u662fDialog</p> <ul> <li>\u867d\u7136\u6211\u4eec\u6307\u5b9a<code>scopeDialog</code>\u7684\u52a0\u8f7d\u6846\u6216\u8005<code>setNetDialogFactory</code>\u65f6\u53ea\u5141\u8bb8\u4f20\u5165\u4e00\u4e2aDialog\u5bf9\u8c61, \u4f46\u5373\u4f7f\u4f60\u4f7f\u7528\u7684\u4e0d\u662fDialog\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7c7b\u7ee7\u627fDialog, \u7136\u540e\u5728\u5176\u751f\u547d\u5468\u671f\u51fd\u6570\u4e2d\u5904\u7406<code>\u81ea\u5df1\u7279\u6b8a\u5bf9\u8bdd\u6846</code>\u7684\u5c55\u793a\u548c\u9690\u85cf</li> </ul>"},{"location":"auto-page/","title":"\u81ea\u52a8\u5206\u9875\u52a0\u8f7d","text":"<p>\u9605\u8bfb\u81ea\u52a8\u5206\u9875\u52a0\u8f7d\u4e4b\u524d\u8bf7\u5148\u9605\u8bfb\u81ea\u52a8\u5237\u65b0</p> <p>Net\u5c5e\u4e8e\u4f4e\u8026\u5408\u6846\u67b6, \u5206\u9875\u52a0\u8f7d\u540c\u6837\u9700\u8981\u4f9d\u8d56\u7b2c\u4e09\u65b9\u7ec4\u4ef6: BRV(\u70b9\u51fb\u94fe\u63a5\u6309\u6587\u6863\u4f9d\u8d56)</p> <p>\u521b\u5efa\u5e03\u5c40 <pre><code>&lt;com.drake.brv.PageRefreshLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\nxmlns:tools=\"http://schemas.android.com/tools\"\nandroid:id=\"@+id/page\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\"\ntools:context=\".ui.fragment.PullRefreshFragment\"&gt;\n\n&lt;androidx.recyclerview.widget.RecyclerView\nandroid:id=\"@+id/rv_pull\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\" /&gt;\n\n&lt;/com.drake.brv.PageRefreshLayout&gt;\n</code></pre></p> <p>\u521b\u5efa\u5217\u8868 <pre><code>rv_pull.linear().setup {\naddType&lt;String&gt;(R.layout.item_list)\n}\n</code></pre></p> <p>\u521b\u5efa\u7f51\u7edc <pre><code>page.onRefresh {\nscope {\nval data = Get&lt;ListModel&gt;(\"list\") {\nparam(\"page\", index)\n}.await().data\naddData(data.list) {\nindex &lt; data.total\n}\n}\n}.autoRefresh()\n</code></pre></p> <ul> <li><code>index</code> \u5c5e\u4e8ePageRefreshLayout\u7684\u5b57\u6bb5, \u6bcf\u6b21\u4e0a\u62c9\u52a0\u8f7d\u81ea\u52a8+1\u9012\u589e, \u4e0b\u62c9\u5237\u65b0\u81ea\u52a8\u91cd\u7f6e</li> <li><code>data.total</code>\u5c5e\u4e8e\u670d\u52a1\u5668\u8fd4\u56de\u7684<code>\u5217\u8868\u5168\u90e8\u6570\u91cf</code>\u7684\u5b57\u6bb5, \u6700\u7ec8\u4f7f\u7528\u4ec0\u4e48\u5b57\u6bb5\u6216\u8005\u5224\u65ad\u6761\u4ef6\u8bf7\u81ea\u5df1\u6839\u636e\u9879\u76ee\u4e0d\u540c\u51b3\u5b9a</li> <li><code>addData</code> \u5c5e\u4e8ePageRefreshLayout\u7684\u51fd\u6570     <pre><code>fun addData(\ndata: List&lt;Any?&gt;?,\nadapter: BindingAdapter? = null,\nisEmpty: () -&gt; Boolean = { data.isNullOrEmpty() },\nhasMore: BindingAdapter.() -&gt; Boolean = { true }\n)\n</code></pre>     \u5177\u4f53\u8bf7\u67e5\u770b\u51fd\u6570\u6ce8\u91ca</li> </ul>"},{"location":"auto-refresh/","title":"\u81ea\u52a8\u4e0b\u62c9\u5237\u65b0","text":"<p>Net\u5c5e\u4e8e\u4f4e\u8026\u5408\u6846\u67b6, \u81ea\u52a8\u4e0b\u62c9\u5237\u65b0\u9700\u8981\u4f9d\u8d56\u7b2c\u4e09\u65b9\u7ec4\u4ef6: BRV(\u70b9\u51fb\u94fe\u63a5\u6309\u6587\u6863\u4f9d\u8d56) </p> <p></p> <p>\u4f7f\u7528\u56fa\u5b9a\u7248\u672c\u53f7\u66ff\u6362+\u7b26\u53f7</p> <pre><code>implementation 'com.github.liangjingkanji:BRV:+'\n</code></pre> <p>\u5f53\u7136\u5982\u679c\u81ea\u5df1\u5904\u7406\u4e0b\u62c9\u5237\u65b0\u4e5f\u662f\u53ef\u4ee5\u7684, Net\u53ef\u4ee5\u4ec5\u4ec5\u4f5c\u4e3a\u7f51\u7edc\u6846\u67b6\u5b58\u5728</p> <p>\u521b\u5efaPageRefreshLayout <pre><code>&lt;com.drake.brv.PageRefreshLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\nxmlns:tools=\"http://schemas.android.com/tools\"\nxmlns:app=\"http://schemas.android.com/apk/res-auto\"\nandroid:id=\"@+id/page\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\"\ntools:context=\".ui.fragment.PushRefreshFragment\"&gt;\n\n&lt;androidx.recyclerview.widget.RecyclerView\nandroid:id=\"@+id/rv_push\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\" /&gt;\n\n&lt;/com.drake.brv.PageRefreshLayout&gt;\n</code></pre></p> <p>\u521b\u5efa\u5217\u8868 <pre><code>rv_push.linear().setup {\naddType&lt;String&gt;(R.layout.item_list)\n}\n</code></pre></p> <p>\u521b\u5efa\u7f51\u7edc\u8bf7\u6c42 <pre><code>page.onRefresh {\nscope {\n// \u8bf7\u6c42\u5230\u6570\u636e\u8bbe\u7f6e\u5230RecyclerView\nrv_push.models = Get&lt;ListModel&gt;(\"list\").await().data.list\n}\n}.autoRefresh()\n</code></pre></p> <p></p> <p>\u6ce8\u610f\u9ad8\u4eae\u5904\u4f7f\u7528\u7684\u662f<code>scope</code>\u800c\u4e0d\u662f\u5176\u4ed6\u4f5c\u7528\u57df, \u53ea\u80fd\u4f7f\u7528scope, \u5426\u5219\u65e0\u6cd5\u8ddf\u968fPageRefreshLayout\u751f\u547d\u5468\u671f\u7b49\u529f\u80fd</p> <p></p> <ul> <li>\u4f7f\u7528\u4e0a\u548c\u81ea\u52a8\u7f3a\u7701\u9875\u76f8\u4f3c</li> <li>BRV\u540c\u6837\u5c5e\u4e8e\u5177\u5907\u5b8c\u5584\u529f\u80fd\u72ec\u7acb\u7684RecyclerView\u6846\u67b6</li> <li>BRV\u7684\u4e0b\u62c9\u5237\u65b0\u6269\u5c55\u81eaSmartRefreshLayout_v2, \u652f\u6301\u5176\u5168\u90e8\u529f\u80fd\u4e14\u66f4\u591a</li> </ul>"},{"location":"auto-refresh/#_1","title":"\u751f\u547d\u5468\u671f","text":"\u751f\u547d\u5468\u671f \u63cf\u8ff0 \u5f00\u59cb PageRefreshLayout\u6267\u884c<code>showLoading/autoRefresh</code>\u540e\u89e6\u53d1<code>onRefresh</code>, \u7136\u540e\u5f00\u59cb\u7f51\u7edc\u8bf7\u6c42 \u7ed3\u675f PageRefreshLayout\u88ab\u9500\u6bc1(\u4f8b\u5982\u5176\u6240\u5728\u7684Activity\u6216Fragment\u88ab\u9500\u6bc1), \u7f51\u7edc\u8bf7\u6c42\u81ea\u52a8\u53d6\u6d88"},{"location":"auto-state/","title":"\u81ea\u52a8\u7f3a\u7701\u9875","text":"<p>\u8003\u8651\u5230\u4f4e\u8026\u5408, \u6240\u4ee5\u81ea\u5b9a\u4e49\u7f3a\u7701\u9875\u9700\u8981\u5bfc\u5165\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u4f9d\u8d56(\u70b9\u51fb\u94fe\u63a5\u6309\u7167\u6587\u6863\u4f9d\u8d56), \u5f53\u7136\u5982\u679c\u4f60\u4f7f\u7528\u5176\u4ed6\u65b9\u5f0f\u5904\u7406\u7f3a\u7701\u9875\u53ef\u4ee5\u8df3\u8fc7\u672c\u7ae0.</p> <p>\u4f9d\u8d56\u4ee5\u4e0b\u4e24\u79cd\u5e93\u5176\u4e2d\u4e4b\u4e00\u5373\u53ef\u652f\u6301\u81ea\u52a8\u663e\u793a\u7f3a\u7701\u9875</p> <ol> <li>\u4f9d\u8d56 StateLayout      \u4f7f\u7528\u56fa\u5b9a\u7248\u672c\u53f7\u66ff\u6362+\u7b26\u53f7     <pre><code>implementation 'com.github.liangjingkanji:StateLayout:+'\n</code></pre></li> <li>\u4f9d\u8d56 BRV (\u56e0\u4e3aBRV\u5305\u542bStateLayout)       \u4f7f\u7528\u56fa\u5b9a\u7248\u672c\u53f7\u66ff\u6362+\u7b26\u53f7     <pre><code>implementation 'com.github.liangjingkanji:BRV:+'\n</code></pre></li> </ol> <p> \u521d\u59cb\u5316\u7f3a\u7701\u9875</p> <p>\u9700\u8981\u5728<code>Application</code>\u91cc\u914d\u7f6e\u5168\u5c40\u81ea\u5b9a\u4e49\u7684 <code>\u52a0\u8f7d\u4e2d/\u52a0\u8f7d\u5931\u8d25/\u7a7a\u6570\u636e\u5e03\u5c40</code>\uff0c\u53ef\u4ee5\u590d\u5236\u4f7f\u7528Demo\u91cc\u81ea\u5b9a\u4e49\u7684\u5e03\u5c40\u8d44\u6e90\uff0cDemo\u4e2d\u7684<code>App.kt</code>\u914d\u7f6e\u5982\u4e0b</p> <pre><code>//\u5168\u5c40\u7f3a\u7701\u9875\u914d\u7f6e [https://github.com/liangjingkanji/StateLayout]\nStateConfig.apply {\nemptyLayout = R.layout.layout_empty\nloadingLayout = R.layout.layout_loading\nerrorLayout = R.layout.layout_error\n}\n</code></pre> <p> \u58f0\u660e\u7f3a\u7701\u9875</p> <pre><code>&lt;com.drake.statelayout.StateLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\nxmlns:tools=\"http://schemas.android.com/tools\"\nandroid:layout_width=\"match_parent\"\nandroid:id=\"@+id/state\"\nandroid:layout_height=\"match_parent\"\ntools:context=\".ui.fragment.StateLayoutFragment\"&gt;\n\n&lt;TextView\nandroid:id=\"@+id/tvFragment\"\nandroid:padding=\"32dp\"\nandroid:textStyle=\"bold\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\"\nandroid:text=\"\u5185\u5bb9\" /&gt;\n\n&lt;/com.drake.statelayout.StateLayout&gt;\n</code></pre> <p>\u81ea\u52a8\u663e\u793a\u7f3a\u7701\u9875</p> <p><pre><code>state.onRefresh {\nscope {\ntvFragment.text = Get&lt;String&gt;(\"api\").await()\n}\n}.showLoading()\n</code></pre> </p> <p>\u6ce8\u610f\u9ad8\u4eae\u5904\u4f7f\u7528\u7684\u662f<code>scope</code>\u800c\u4e0d\u662f\u5176\u4ed6\u4f5c\u7528\u57df, \u53ea\u80fd\u4f7f\u7528scope, \u5426\u5219\u65e0\u6cd5\u8ddf\u968fStateLayout\u751f\u547d\u5468\u671f(\u81ea\u52a8\u663e\u793a\u5bf9\u5e94\u7f3a\u7701\u9875)\u7b49\u529f\u80fd</p>"},{"location":"auto-state/#_1","title":"\u751f\u547d\u5468\u671f","text":"\u751f\u547d\u5468\u671f \u63cf\u8ff0 \u5f00\u59cb StateLayout\u6267\u884c<code>showLoading</code>\u540e\u89e6\u53d1<code>onRefresh</code>, \u7136\u540e\u5f00\u59cb\u7f51\u7edc\u8bf7\u6c42 \u7ed3\u675f \u7f3a\u7701\u9875\u88ab\u9500\u6bc1(\u4f8b\u5982\u5176\u6240\u5728\u7684Activity\u6216Fragment\u88ab\u9500\u6bc1), \u7f51\u7edc\u8bf7\u6c42\u81ea\u52a8\u53d6\u6d88"},{"location":"cache/","title":"\u7f13\u5b58","text":"<ol> <li>\u7f13\u5b58\u4efb\u4f55\u8bf7\u6c42\u65b9\u5f0f, POST/GET/PUT/HEAD...</li> <li>\u7f13\u5b58\u4efb\u4f55\u6570\u636e\u7c7b\u578b, File/\u56fe\u7247/JSON/ProtoBuf/...</li> <li>\u9650\u5236\u6700\u5927\u7f13\u5b58\u4f53\u79ef, \u7f13\u5b58\u9075\u5b88\u78c1\u76d8LRU\u7f13\u5b58\u7b97\u6cd5, \u5f53\u7f13\u5b58\u8fbe\u5230\u9650\u5236\u65f6, \u5c06\u4f1a\u5220\u9664\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u7f13\u5b58</li> <li>\u9ad8\u6027\u80fdDiskLruCache\u6765\u5b9e\u73b0\u7edf\u4e00\u7f13\u5b58</li> </ol>"},{"location":"cache/#_1","title":"\u914d\u7f6e\u7f13\u5b58","text":"<p>\u4e0d\u914d\u7f6e\u7f13\u5b58\u8bbe\u7f6e\u662f\u4e0d\u4f1a\u89e6\u53d1\u7f13\u5b58\u7684 <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// ...\n// \u672c\u6846\u67b6\u652f\u6301Http\u7f13\u5b58\u534f\u8bae\u548c\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f\ncache(Cache(cacheDir, 1024 * 1024 * 128)) // \u7f13\u5b58\u8bbe\u7f6e, \u5f53\u8d85\u8fc7maxSize\u6700\u5927\u503c\u4f1a\u6839\u636e\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7b97\u6cd5\u6e05\u9664\u7f13\u5b58\u6765\u9650\u5236\u7f13\u5b58\u5927\u5c0f\n}\n</code></pre> \u8fd9\u4e5f\u662fNet\u7f13\u5b58\u5f3a\u5927\u4e4b\u5904, \u548cOkHttp\u5171\u4eab\u7f13\u5b58\u4f46\u662f\u5374\u53ef\u4ee5\u7f13\u5b58\u4efb\u4f55\u8bf7\u6c42\u65b9\u5f0f</p>"},{"location":"cache/#http","title":"Http\u7f13\u5b58\u534f\u8bae","text":"<p>\u8fd9\u5c5e\u4e8eOkHttp\u9ed8\u8ba4\u7684Http\u7f13\u5b58\u534f\u8bae\u63a7\u5236, \u8981\u6c42\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6</p> <ul> <li>\u8bf7\u6c42\u65b9\u5f0f\u4e3aGet</li> <li>URL\u7684MD5\u503c\u4f5c\u4e3aKey, \u6240\u4ee5\u4e00\u65e6URL\u53d1\u751f\u6539\u53d8\u5373\u4e0d\u4f1a\u7b97\u540c\u4e00\u7f13\u5b58</li> <li>\u5b58\u5728\u54cd\u5e94\u5934\u5b58\u5728\u7f13\u5b58\u63a7\u5236: Cache-Control</li> </ul> <p> \u901a\u8fc7\u6307\u5b9a<code>CacheControl</code>\u4e5f\u53ef\u4ee5\u63a7\u5236Http\u7f13\u5b58\u534f\u8bae(\u539f\u7406\u662f\u6dfb\u52a0\u8bf7\u6c42\u5934)</p> <pre><code>scopeNetLife {\nPost&lt;String&gt;(\"api\") {\nsetCacheControl(CacheControl.FORCE_CACHE) // \u5f3a\u5236\u4f7f\u7528\u7f13\u5b58\n// setCacheControl(CacheControl.FORCE_NETWORK) // \u5f3a\u5236\u4f7f\u7528\u7f51\u7edc\n// setCacheControl(CacheControl.Builder().noStore().noCache().build()) // \u5b8c\u5168\u7981\u6b62\u8bfb\u53d6/\u5199\u5165\u7f13\u5b58\n}.await()\n}\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u6307\u5b9a\u7f13\u5b58\u6709\u6548\u671f, \u66f4\u591a\u4f7f\u7528\u8bf7\u67e5\u770b\u4ee3\u7801\u6216\u8005\u641c\u7d22Cache-Control</p> <p> \u5982\u679c\u4f60\u540e\u7aef\u540c\u4e8b\u7684\u6280\u672f\u6c34\u5e73\u65e0\u6cd5\u5b9e\u73b0Http\u6807\u51c6\u7f13\u5b58\u534f\u8bae, \u6216\u8005\u4f60\u9700\u8981\u7f13\u5b58Get\u4ee5\u5916\u7684\u8bf7\u6c42\u65b9\u6cd5. \u4e0b\u9762\u6211\u4eec\u4ecb\u7ecd\u4f7f\u7528<code>\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f</code>\u6765\u5b8c\u5168\u7531\u5ba2\u6237\u7aef\u63a7\u5236\u7f13\u5b58</p>"},{"location":"cache/#_2","title":"\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f","text":"<p>\u65e0\u8bba\u8bf7\u6c42\u662f\u5426\u5b58\u5728Http\u6807\u51c6\u7f13\u5b58\u534f\u8bae, \u5f53\u4f60\u8bbe\u7f6e\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f\u65f6\u5176\u4f1a\u65e0\u89c6Http\u6807\u51c6\u7f13\u5b58\u534f\u8bae</p> <pre><code>scopeNetLife {\nbinding.tvFragment.text =\nPost&lt;String&gt;(\"api\") {\nsetCacheMode(CacheMode.REQUEST_THEN_READ) // \u8bf7\u6c42\u7f51\u7edc\u5931\u8d25\u4f1a\u8bfb\u53d6\u7f13\u5b58, \u8bf7\u65ad\u7f51\u6d4b\u8bd5\n}.await()\n}\n</code></pre> <p>\u8bfb\u53d6\u7f13\u5b58\u5931\u8d25\u4f1a\u5f15\u53d1<code>NoCacheException</code>\u5f02\u5e38(\u88ab\u5168\u5c40\u9519\u8bef\u5904\u7406\u5668\u63a5\u6536), \u524d\u63d0\u662f\u4f60\u6ca1\u6709\u4f7f\u7528\u8bfb\u53d6\u7f13\u5b58\u5931\u8d25\u540e\u8bf7\u6c42\u7f51\u7edc\u6a21\u5f0f</p> \u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f \u63cf\u8ff0 READ \u53ea\u8bfb\u53d6\u7f13\u5b58, \u672c\u64cd\u4f5c\u5e76\u4e0d\u4f1a\u8bf7\u6c42\u7f51\u7edc\u6545\u4e0d\u5b58\u5728\u5199\u5165\u7f13\u5b58 WRITE \u53ea\u8bf7\u6c42\u7f51\u7edc, \u5f3a\u5236\u5199\u5165\u7f13\u5b58 READ_THEN_REQUEST \u5148\u4ece\u7f13\u5b58\u8bfb\u53d6\uff0c\u5982\u679c\u5931\u8d25\u518d\u4ece\u7f51\u7edc\u8bfb\u53d6, \u5f3a\u5236\u5199\u5165\u7f13\u5b58 REQUEST_THEN_READ \u5148\u4ece\u7f51\u7edc\u8bfb\u53d6\uff0c\u5982\u679c\u5931\u8d25\u518d\u4ece\u7f13\u5b58\u8bfb\u53d6, \u5f3a\u5236\u5199\u5165\u7f13\u5b58 <p>\u5982\u679c<code>response.cacheResponse</code>\u4e0d\u4e3anull\u7684\u65f6\u5019\u5373\u4ee3\u8868response\u6765\u81ea\u4e8e\u672c\u5730\u7f13\u5b58, \u5f3a\u5236\u7f13\u5b58\u6216Http\u7f13\u5b58\u534f\u8bae\u90fd\u5982\u6b64</p>"},{"location":"cache/#key","title":"\u81ea\u5b9a\u7f13\u5b58Key","text":"<p>\u7f13\u5b58Key\u9ed8\u8ba4\u662f<code>\u8bf7\u6c42\u65b9\u5f0f+URL</code>\u540e\u4ea7\u751f\u7684sha1\u503c, \u6240\u4ee5\u5e76\u4e0d\u4f1a\u4f7f\u7528\u8bf7\u6c42\u53c2\u6570\u5224\u65ad(\u7efc\u5408\u8003\u8651\u90fd\u4e0d\u9002\u7528)</p> <p>\u5982\u679c\u4f60\u8981\u5b9e\u73b0\u533a\u522b\u8bf7\u6c42\u53c2\u6570\u7684\u7f13\u5b58\u8bf7\u81ea\u5b9a\u4e49\u7f13\u5b58key, \u5982\u4e0b</p> <pre><code>scopeNetLife {\nbinding.tvFragment.text =\nPost&lt;String&gt;(\"api\") {\nsetCacheMode(CacheMode.REQUEST_THEN_READ) // \u8bf7\u6c42\u7f51\u7edc\u5931\u8d25\u4f1a\u8bfb\u53d6\u7f13\u5b58, \u8bf7\u65ad\u7f51\u6d4b\u8bd5\nsetCacheKey(\"\u8bf7\u6c42\u70ed\u95e8\u4fe1\u606f\" + params) // \u5177\u4f53\u503c\u90fd\u884c\n}.await()\n}\n</code></pre>"},{"location":"cache/#_3","title":"\u7f13\u5b58\u6709\u6548\u671f","text":"<ol> <li>\u7f13\u5b58\u6709\u6548\u671f\u53ea\u9488\u5bf9<code>\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f</code>, \u6807\u51c6Http\u7f13\u5b58\u534f\u8bae\u9075\u5b88\u534f\u8bae\u672c\u8eab\u7684\u6709\u6548\u671f</li> <li>\u7f13\u5b58\u6709\u6548\u671f\u8fc7\u671f\u53ea\u662f\u8ba9\u7f13\u5b58\u65e0\u6548, \u5e76\u4e0d\u4f1a\u88ab\u5220\u9664(\u5373\u65e0\u6cd5\u8bfb\u53d6). \u7f13\u5b58\u5220\u9664\u9075\u5b88LRU(\u6700\u8fd1\u6700\u5c11\u4f7f\u7528)\u539f\u5219\u5728\u6240\u6709\u7f13\u5b58\u4f53\u79ef\u8fbe\u5230\u914d\u7f6e\u7684\u503c\u65f6\u81ea\u52a8\u5220\u9664(\u5373\u4f7f\u7f13\u5b58\u6709\u6548\u671f\u672a\u5230)</li> </ol> <pre><code>scopeNetLife {\nbinding.tvFragment.text =\nPost&lt;String&gt;(\"api\") {\nsetCacheMode(CacheMode.REQUEST_THEN_READ) // \u8bf7\u6c42\u7f51\u7edc\u5931\u8d25\u4f1a\u8bfb\u53d6\u7f13\u5b58, \u8bf7\u65ad\u7f51\u6d4b\u8bd5\nsetCacheValidTime(1, TimeUnit.DAYS) // \u7f13\u5b58\u4ec5\u4e00\u5929\u5185\u6709\u6548\n}.await()\n}\n</code></pre>"},{"location":"cache/#_4","title":"\u7f13\u5b58+\u7f51\u7edc","text":"<p>\u8fd9\u91cc\u53ef\u4ee5\u7528\u5230Net\u7684\u9884\u89c8\u6a21\u5f0f(preview)\u6765\u5b9e\u73b0, \u5176\u5b9e\u4e0d\u4ec5\u4ec5\u662f\u9884\u89c8\u7f13\u5b58\u4e5f\u53ef\u4ee5\u7528\u4e8e\u56de\u9000\u8bf7\u6c42</p> <pre><code>scopeNetLife {\n// \u7136\u540e\u6267\u884c\u8fd9\u91cc(\u7f51\u7edc\u8bf7\u6c42)\nbinding.tvFragment.text = Get&lt;String&gt;(\"api\") {\nsetCacheMode(CacheMode.WRITE)\n}.await()\nLog.d(\"\u65e5\u5fd7\", \"\u7f51\u7edc\u8bf7\u6c42\")\n}.preview(true) {\n// \u5148\u6267\u884c\u8fd9\u91cc(\u4ec5\u8bfb\u7f13\u5b58), \u4efb\u4f55\u5f02\u5e38\u90fd\u89c6\u4e3a\u8bfb\u53d6\u7f13\u5b58\u5931\u8d25\nbinding.tvFragment.text = Get&lt;String&gt;(\"api\") {\nsetCacheMode(CacheMode.READ)\n}.await()\nLog.d(\"\u65e5\u5fd7\", \"\u8bfb\u53d6\u7f13\u5b58\")\n}\n</code></pre> <p>\u4e00\u822c\u7528\u4e8e\u79d2\u5f00\u9996\u9875\u6216\u8005\u56de\u9000\u52a0\u8f7d\u6570\u636e. \u6211\u4eec\u53ef\u4ee5\u5728preview{}\u53ea\u52a0\u8f7d\u7f13\u5b58. \u7136\u540e\u518d\u6267\u884cscopeNetLife\u6765\u8bf7\u6c42\u7f51\u7edc, \u505a\u5230\u7f13\u5b58+\u7f51\u7edc\u53cc\u91cd\u52a0\u8f7d\u7684\u6548\u679c</p> <p>\u6709\u4eba\u53ef\u80fd\u89c9\u5f97\u8fd9\u548c\u81ea\u5df1\u52a0\u8f7d\u4e24\u6b21\u6709\u4ec0\u4e48\u533a\u522b, \u533a\u522b\u662fpreview\u7684\u65b9\u6cd5\u53c2\u6570\u53ef\u4ee5\u63a7\u5236\u52a0\u8f7d</p> <ul> <li><code>breakError</code> \u8bfb\u53d6\u7f13\u5b58\u6210\u529f\u540e\u4e0d\u518d\u5904\u7406\u9519\u8bef\u4fe1\u606f, \u9ed8\u8ba4false</li> <li><code>breakLoading</code> \u8bfb\u53d6\u7f13\u5b58\u6210\u529f\u540e\u7ed3\u675f\u52a0\u8f7d\u52a8\u753b, \u9ed8\u8ba4true</li> </ul>"},{"location":"callback/","title":"Callback","text":"<p>Net\u652f\u6301OkHttp\u7684\u539f\u6709\u7684\u961f\u5217\u8bf7\u6c42<code>Callback</code></p> <p>Callback\u5c5e\u4e8e\u63a5\u53e3\u56de\u8c03\u8bf7\u6c42, \u5176\u4ee3\u7801\u5197\u4f59\u53ef\u8bfb\u6027\u4e0d\u9ad8, \u5e76\u4e14\u65e0\u6cd5\u652f\u6301\u5e76\u53d1\u8bf7\u6c42\u534f\u4f5c</p> <pre><code>Net.post(\"api\").enqueue(object : Callback {\noverride fun onFailure(call: Call, e: IOException) {\n}\n\noverride fun onResponse(call: Call, response: Response) {\n// \u6b64\u5904\u4e3a\u5b50\u7ebf\u7a0b\nval body = response.body?.string() ?: \"\u65e0\u6570\u636e\"\nrunMain {\n// \u6b64\u5904\u4e3a\u4e3b\u7ebf\u7a0b\nbinding.tvFragment.text = body\n}\n}\n})\n</code></pre>"},{"location":"cancel/","title":"\u53d6\u6d88\u8bf7\u6c42","text":"<p>Net\u867d\u7136\u652f\u6301\u81ea\u52a8\u8ddf\u968f\u751f\u547d\u5468\u671f\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42, \u7edd\u5927\u90e8\u5206\u573a\u666f\u4e5f\u8db3\u591f. \u4f46\u662f\u6709\u65f6\u8fd8\u662f\u9700\u8981\u624b\u52a8\u53d6\u6d88, \u4f8b\u5982\u53d6\u6d88\u4e0b\u8f7d\u6587\u4ef6. </p> <p>Net\u53d6\u6d88\u534f\u7a0b\u4f5c\u7528\u57df\u81ea\u52a8\u53d6\u6d88\u5185\u90e8\u7f51\u7edc\u8bf7\u6c42, \u4e5f\u652f\u6301\u4efb\u610f\u4f4d\u7f6e\u53d6\u6d88\u6307\u5b9a\u7f51\u7edc\u8bf7\u6c42.</p> <p><pre><code>downloadScope = scopeNetLife {\n// \u4e0b\u8f7d\u6587\u4ef6\nval file = Get&lt;File&gt;(\"download\").await()\n}\n\ndownloadScope.cancel() // \u53d6\u6d88\u4e0b\u8f7d\n</code></pre> \u5b8c\u6574\u793a\u4f8b: \u6e90\u7801</p>"},{"location":"cancel/#_1","title":"\u4efb\u610f\u4f4d\u7f6e\u53d6\u6d88","text":"<p>\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\u8981\u6c42\u5b9a\u4e49\u4e00\u4e2a<code>Id</code>\u7528\u4e8e\u6307\u5b9a\u7f51\u7edc\u8bf7\u6c42, \u7136\u540e\u5728\u9700\u8981\u7684\u5730\u65b9\u4f7f\u7528\u5355\u4f8b\u5bf9\u8c61<code>Net.cancelId</code>\u53d6\u6d88\u8bf7\u6c42.</p> <p>\u521b\u5efa\u8bf7\u6c42 <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"api\"){\nsetId(\"\u8bf7\u6c42\u7528\u6237\u4fe1\u606f\")\n}.await()\n}\n</code></pre></p> <p>\u7136\u540e\u6839\u636eId\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42 <pre><code>Net.cancelId(\"\u8bf7\u6c42\u7528\u6237\u4fe1\u606f\")\n\nNet.cancelGroup(\"\u8bf7\u6c42\u5206\u7ec4\u540d\u79f0\") // \u8bbe\u7f6e\u5206\u7ec4\n</code></pre></p> <p>\u5982\u679c\u4f60\u8981\u95ee\u6211\u8bf7\u6c42\u7684Group\u548cId\u6709\u4ec0\u4e48\u533a\u522b, \u5176\u5b9e\u672c\u8d28\u4e0a\u4e24\u8005\u57fa\u672c\u4e0a\u6ca1\u533a\u522b, \u53ea\u662f\u4e3a\u4e86\u9002\u914d\u4e0d\u540c\u573a\u666f\u4e0b\u4f7f\u7528.</p> <p></p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e00\u65e6\u4e3a\u7f51\u7edc\u8bf7\u6c42\u8bbe\u7f6e\u5206\u7ec4<code>setGroup</code>\u4f60\u5c31\u65e0\u6cd5\u5728\u4f5c\u7528\u57df\u6267\u884c\u5b8c\u6bd5\u81ea\u52a8\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42\u4e86, \u56e0\u4e3a\u81ea\u52a8\u53d6\u6d88\u7684\u539f\u7406\u5c31\u662f\u4f7f\u7528\u4f5c\u7528\u57df \u7684\u4e0a\u4e0b\u6587\u6765\u4f5c\u4e3aGroup</p>"},{"location":"config/","title":"\u5168\u5c40\u914d\u7f6e","text":"<p>\u5168\u5c40\u914d\u7f6e\u5efa\u8bae\u5728Application\u7684onCreate\u51fd\u6570\u4e2d\u914d\u7f6e</p>"},{"location":"config/#_1","title":"\u521d\u59cb\u914d\u7f6e","text":"\u666e\u901a\u521d\u59cb\u5316 <pre><code>class App : Application() {\noverride fun onCreate() {\nsuper.onCreate()\n\n// https://github.com/liangjingkanji/Net/  \u8fd9\u662f\u63a5\u53e3\u5168\u5c40\u57df\u540d, \u53ef\u4ee5\u4f7f\u7528NetConfig.host\u8fdb\u884c\u5355\u72ec\u7684\u4fee\u6539\nNetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// \u8d85\u65f6\u914d\u7f6e, \u9ed8\u8ba4\u662f10\u79d2, \u8bbe\u7f6e\u592a\u957f\u65f6\u95f4\u4f1a\u5bfc\u81f4\u7528\u6237\u7b49\u5f85\u8fc7\u4e45\nconnectTimeout(30, TimeUnit.SECONDS)\nreadTimeout(30, TimeUnit.SECONDS)\nwriteTimeout(30, TimeUnit.SECONDS)\nsetDebug(BuildConfig.DEBUG)\nsetConverter(SerializationConverter())\n}\n}\n}\n</code></pre> OkHttpClient.Builder <pre><code>class App : Application() {\noverride fun onCreate() {\nsuper.onCreate()\n// https://github.com/liangjingkanji/Net/  \u8fd9\u662f\u63a5\u53e3\u5168\u5c40\u57df\u540d, \u53ef\u4ee5\u4f7f\u7528NetConfig.host\u8fdb\u884c\u5355\u72ec\u7684\u4fee\u6539\nval okHttpClientBuilder = OkHttpClient.Builder()\n.setDebug(BuildConfig.DEBUG)\n.setConverter(SerializationConverter())\n.addInterceptor(LogRecordInterceptor(BuildConfig.DEBUG))\n\nNetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this, okHttpClientBuilder)\n}\n}\n</code></pre> <p>\u914d\u7f6e\u90fd\u662f\u53ef\u9009\u9879, \u4e0d\u662f\u4e0d\u521d\u59cb\u5316\u5c31\u4e0d\u80fd\u4f7f\u7528. \u5982\u679c\u4f60\u662fXposed\u6216\u8005\u591a\u8fdb\u7a0b\u9879\u76ee\u4e2d\u5fc5\u987b\u521d\u59cb\u5316\u4f20\u5165\u4e0a\u4e0b\u6587\u6216\u8005\u8d4b\u503c <code>NetConfig.app = this</code></p> <p>\u5728initNet\u51fd\u6570\u4f5c\u7528\u57df\u4e2d\u7684this\u5c5e\u4e8e<code>OkHttpClient.Builder()</code>, \u53ef\u4ee5\u914d\u7f6e\u4efb\u4f55OkHttpClient.Builder\u7684\u5c5e\u6027\u4ee5\u5916\u8fd8\u652f\u6301\u4ee5\u4e0bNet\u72ec\u6709\u914d\u7f6e</p> \u51fd\u6570 \u63cf\u8ff0 setDebug \u662f\u5426\u8f93\u51fa\u7f51\u7edc\u65e5\u5fd7, \u548c<code>LogRecordInterceptor</code>\u4e92\u4e0d\u5f71\u54cd setSSLCertificate \u914d\u7f6eHttps\u8bc1\u4e66 trustSSLCertificate \u4fe1\u4efb\u6240\u6709Https\u8bc1\u4e66 setConverter \u914d\u7f6e\u6570\u636e\u8f6c\u6362\u5668, \u5c06\u7f51\u7edc\u8fd4\u56de\u7684\u6570\u636e\u8f6c\u6362\u6210\u4f60\u60f3\u8981\u7684\u6570\u636e\u7ed3\u6784 setRequestInterceptor \u914d\u7f6e\u8bf7\u6c42\u62e6\u622a\u5668, \u9002\u7528\u4e8e\u6dfb\u52a0\u5168\u5c40\u8bf7\u6c42\u5934/\u53c2\u6570 setErrorHandler \u914d\u7f6e\u5168\u5c40\u9519\u8bef\u5904\u7406 setDialogFactory \u914d\u7f6e\u5168\u5c40\u5bf9\u8bdd\u6846"},{"location":"config/#_2","title":"\u91cd\u8bd5\u6b21\u6570","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f60\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\u5373\u53ef, OkHttp\u5185\u90e8\u4e5f\u6709\u91cd\u8bd5\u673a\u5236.</p> <p>\u4f46\u662f\u4e2a\u522b\u5f00\u53d1\u8005\u9700\u6c42\u6307\u5b9a\u91cd\u8bd5\u6b21\u6570\u5219\u53ef\u4ee5\u6dfb\u52a0<code>RetryInterceptor</code>\u62e6\u622a\u5668\u5373\u53ef\u5b9e\u73b0\u5931\u8d25\u4ee5\u540e\u4f1a\u91cd\u8bd5\u6307\u5b9a\u6b21\u6570</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// ... \u5176\u4ed6\u914d\u7f6e\naddInterceptor(RetryInterceptor(3)) // \u5982\u679c\u5168\u90e8\u5931\u8d25\u4f1a\u91cd\u8bd5\u4e09\u6b21\n}\n</code></pre>"},{"location":"config/#_3","title":"\u4fee\u6539\u914d\u7f6e","text":"<p>NetConfig\u7684\u5b57\u6bb5\u5373\u4e3a\u5168\u5c40\u914d\u7f6e, \u53ef\u968f\u65f6\u4fee\u6539</p> <pre><code>NetConfig.converter = MyNewConverter() // \u4fee\u6539\u5168\u5c40\u6570\u636e\u8f6c\u6362\u5668\nNetConfig.okHttpClient // \u4fee\u6539\u5168\u5c40\u9ed8\u8ba4\u5ba2\u6237\u7aef\n</code></pre> <p>\u66f4\u591a\u8bf7\u8bbf\u95ee\u6e90\u7801\u67e5\u770b</p>"},{"location":"config/#baseurl","title":"BaseUrl","text":"<p>\u8fd9\u4e2a\u6982\u5ff5\u6765\u6e90\u4e8eRetrofit, \u56e0\u4e3aRetrofit\u65e0\u6cd5\u52a8\u6001\u4fee\u6539Host, \u4f46\u662f\u8fd9\u4e2aNet\u652f\u6301\u968f\u65f6\u4fee\u6539. \u4ee5\u4e0b\u4ecb\u7ecd\u4e09\u79cd\u4fee\u6539\u65b9\u5f0f</p> <p>1) \u76f4\u63a5\u4fee\u6539</p> <pre><code>NetConfig.host = \"\u65b0\u7684BaseUrl\"\n</code></pre> <p>2) \u4f20\u5165\u8def\u5f84 \u5982\u4f20\u5165\u53c2\u6570\u4e3a\u8def\u5f84(\u4f8b\u5982<code>/api/index</code>)\u4f1a\u81ea\u52a8\u548c<code>host</code>\u62fc\u63a5\u7ec4\u6210\u5b8c\u6210URL, \u4f46\u5982\u679c\u4f20\u5165\u7684\u4ee5<code>http/https</code>\u5f00\u5934\u7684\u5168\u8def\u5f84\u5219\u4f1a\u76f4\u63a5\u4f5c\u4e3a\u8bf7\u6c42URL</p> <pre><code>scopeNetLife {\nval data = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\n}\n</code></pre> <p>3) \u4f7f\u7528\u62e6\u622a\u5668</p> <p>\u6216\u8005\u901a\u8fc7\u6307\u5b9a<code>tag</code>, \u7136\u540e\u62e6\u622a\u5668(interceptor)\u4e2d\u6839\u636etag\u52a8\u6001\u4fee\u6539host, \u56e0\u4e3a\u62e6\u622a\u5668\u80fd\u4fee\u6539\u4e00\u5207\u8bf7\u6c42\u53c2\u6570</p> <pre><code>scopeNetLife {\nval data = Get&lt;String&gt;(\"/api/index\", \"User\").await() // User\u5373\u4e3atag\n}\n// \u62e6\u622a\u5668\u4fee\u6539\u8bf7\u6c42URL\u4e0d\u505a\u4ecb\u7ecd\n</code></pre>"},{"location":"config/#_4","title":"\u591a\u57df\u540d","text":"<pre><code>scopeNetLife {\nGet&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await() // \u4f20\u5165\u57df\u540d\u5c31\u4f1a\u4f7f\u7528\u5f53\u524d\u57df\u540d\nGet&lt;String&gt;(\"/liangjingkanji/Net/\").await() // \u81ea\u52a8\u548cNetConfig.host\u62fc\u63a5\nGet&lt;String&gt;(Api.Host2 + \"/liangjingkanji/Net/\").await() // \u81ea\u5df1\u624b\u52a8\u62fc\u63a5\n}\n</code></pre> <p>\u548cBaseUrl\u4e00\u6837\u4f60\u8fd8\u53ef\u4ee5\u5728\u62e6\u622a\u5668\u91cc\u9762\u7edf\u4e00\u5904\u7406, \u5728\u62e6\u622a\u5668\u91cc\u9762\u5224\u65adtag\u6216\u8005path\u6765\u62fc\u63a5\u57df\u540d</p>"},{"location":"convert-special/","title":"\u7279\u6b8a\u7ed3\u6784\u89e3\u6790","text":""},{"location":"convert-special/#json","title":"\u89e3\u6790\u5b8c\u6574Json","text":"<p>\u4e00\u822c\u7684\u89e3\u6790\u8fc7\u7a0b\u662f\u4ee5\u4e0b</p> <ol> <li>\u540e\u7aef\u8fd4\u56de\u7684JSON\u6570\u636e</li> </ol> <pre><code>{\n\"code\":0,\n\"msg\":\"\u8bf7\u6c42\u6210\u529f\",\n\"data\": {\n\"name\": \"\u5f6d\u4e8e\u664f\",\n\"age\": 27,\n\"height\": 180\n}\n}\n</code></pre> <ol> <li>\u521b\u5efa\u6570\u636e\u6a21\u578b</li> </ol> <pre><code>data class UserModel (\nvar code:Int,\nvar msg:String,\nvar data:Data,\n) {\ndata class Data(var name: String, var age: Int, var height: Int)\n}\n</code></pre> <ol> <li>\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42</li> </ol> <pre><code>scopeNetLife {\nval data = Get&lt;UserModel&gt;(\"api\").await().data\n}\n</code></pre>"},{"location":"convert-special/#json_1","title":"\u89e3\u6790Json\u4e2d\u7684\u5b57\u6bb5","text":"<p>\u8fd9\u6837\u6bcf\u6b21\u90fd\u8981<code>await().data</code>\u624d\u662f\u4f60\u8981\u7684<code>data</code>\u5bf9\u8c61. \u6709\u4e9b\u4eba\u5c31\u60f3\u7701\u7565\u76f4\u63a5\u4e0d\u5199code\u548cmsg, \u5e0c\u671b\u76f4\u63a5\u8fd4\u56dedata. \u90a3\u4e48\u5728\u8f6c\u6362\u5668\u91cc\u9762\u5c31\u53ea\u89e3\u6790data\u5b57\u6bb5\u5373\u53ef</p> <p>\u7b80\u5316\u6570\u636e\u5bf9\u8c61</p> <pre><code>data class UserModel(var name: String, var age: Int, var height: Int)\n</code></pre> <p>\u8f6c\u6362\u5668\u53ea\u89e3\u6790data\u5b57\u6bb5</p> <pre><code>class GsonConvert : JSONConvert(code = \"code\", message = \"msg\", success = \"200\") {\nprivate val gson = GsonBuilder().serializeNulls().create()\n\noverride fun &lt;S&gt; String.parseBody(succeed: Type): S? {\nval data = JSONObject(this).getString(\"data\")\nreturn gson.fromJson(data, succeed)\n}\n}\n</code></pre> <p>\u4f7f\u7528\u7b80\u5316\u7684\u6570\u636e\u5bf9\u8c61\u4f5c\u4e3a\u6cdb\u578b</p> <pre><code>scopeNetLife {\nval data = Get&lt;UserModel&gt;(\"api\").await()\n}\n</code></pre>"},{"location":"convert-special/#json_2","title":"\u89e3\u6790Json\u6570\u7ec4","text":"<p>\u5728Net\u4e2d\u53ef\u4ee5\u76f4\u63a5\u89e3\u6790List\u7b49\u5d4c\u5957\u6cdb\u578b\u6570\u636e, \u89e3\u6790List\u548c\u666e\u901a\u5bf9\u8c61\u6ca1\u6709\u533a\u522b</p> <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;List&lt;UserModel&gt;&gt;(\"list\") {\nconverter = GsonConverter() // \u5355\u4f8b\u8f6c\u6362\u5668, \u4e00\u822c\u60c5\u51b5\u4e0b\u662f\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u8f6c\u6362\u5668\n}.await()[0].name\n}\n</code></pre>"},{"location":"convert-special/#_1","title":"\u89e3\u6790\u6cdb\u578b\u6570\u636e\u7c7b","text":"<p>\u8fd9\u79cd\u65b9\u5f0f\u5728Retrofit\u4e2d\u7ecf\u5e38\u88ab\u4f7f\u7528\u5230, \u56e0\u4e3a\u6709\u4e9b\u4eba\u8ba4\u4e3acode/msg\u4e5f\u8981\u4f7f\u7528. \u5b9e\u9645\u4e0a\u4e00\u822c\u975e\u6210\u529f\u9519\u8bef\u7801(\u4f8b\u5982200\u6216\u80050)\u7b97\u4e1a\u52a1\u5b9a\u4e49\u9519\u8bef\u5e94\u5f53\u5728\u8f6c\u6362\u5668\u629b\u51fa\u5f02\u5e38, \u7136\u540e\u5728\u9519\u8bef\u5904\u7406\u56de\u8c03\u4e2d\u53d6\u83b7\u53d6\u9519\u8bef\u7801/\u4fe1\u606f     <pre><code>// \u6570\u636e\u5bf9\u8c61\u7684\u57fa\u7c7b\nopen class BaseResult&lt;T&gt; {\nvar code: Int = 0\nvar msg: String = \"\"\nvar data: T? = null\n}\n\nclass Result(var name: String) : BaseResult&lt;Result&gt;()\n</code></pre></p> <p>\u5982\u679c\u4f60\u6210\u529f\u9519\u8bef\u7801\u8981\u6c42\u5b9a\u4e49\u591a\u4e2a\u90fd\u7b97\u7f51\u7edc\u8bf7\u6c42\u6210\u529f, \u4e5f\u662f\u53ef\u4ee5\u7684\u5e76\u4e14\u4e0d\u9700\u8981\u5199\u6cdb\u578b\u8fd9\u4e48\u9ebb\u70e6, Net\u8f6c\u6362\u5668\u53ef\u4ee5\u5b9e\u73b0\u65e0\u8bba\u52a0\u4e0d\u52a0<code>code/msg</code>\u90fd\u80fd\u6b63\u5e38\u89e3\u6790\u8fd4\u56de</p> <pre><code>@kotlinx.serialization.Serializable\nclass Result(var data: String = \"\u6570\u636e\", var msg: String = \"\", var code:Int = 0)\n</code></pre> <pre><code>@kotlinx.serialization.Serializable\nclass Result(var data: String = \"\u6570\u636e\")\n</code></pre> <p>\u67e5\u770b\u6e90\u7801<code>SerializationConverter</code>\u53ef\u4ee5\u770b\u5230\u8f6c\u6362\u5668\u5185\u8fdb\u884c\u4e86\u56de\u9000\u89e3\u6790\u7b56\u7565, \u5f53\u622a\u53d6<code>data</code>\u89e3\u6790\u5931\u8d25\u540e\u4f1a\u5b8c\u6574\u89e3\u6790\u6574\u4e2aJson</p> <pre><code>code in 200..299 -&gt; { // \u8bf7\u6c42\u6210\u529f\nval bodyString = response.body?.string() ?: return null\nval kType = response.request.kType\n?: throw ConvertException(response, \"Request does not contain KType\")\nreturn try {\nval json = JSONObject(bodyString) // \u83b7\u53d6JSON\u4e2d\u540e\u7aef\u5b9a\u4e49\u7684\u9519\u8bef\u7801\u548c\u9519\u8bef\u4fe1\u606f\nval srvCode = json.getString(this.code)\nif (srvCode == success) { // \u5bf9\u6bd4\u540e\u7aef\u81ea\u5b9a\u4e49\u9519\u8bef\u7801\njson.getString(\"data\").parseBody&lt;R&gt;(kType)\n} else { // \u9519\u8bef\u7801\u5339\u914d\u5931\u8d25, \u5f00\u59cb\u5199\u5165\u9519\u8bef\u5f02\u5e38\nval errorMessage = json.optString(message, NetConfig.app.getString(com.drake.net.R.string.no_error_message))\nthrow ResponseException(response, errorMessage, tag = srvCode) // \u5c06\u4e1a\u52a1\u9519\u8bef\u7801\u4f5c\u4e3atag\u4f20\u9012\n}\n} catch (e: JSONException) { // \u56fa\u5b9a\u683c\u5f0fJSON\u5206\u6790\u5931\u8d25\u76f4\u63a5\u89e3\u6790JSON\nbodyString.parseBody&lt;R&gt;(kType)\n}\n}\n</code></pre>"},{"location":"converter/","title":"\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668","text":"<p>Net\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668\u652f\u6301\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u8f6c\u6362, \u751a\u81f3<code>List&lt;List&lt;UserModel&gt;&gt;</code>\u7b49\u5d4c\u5957\u6cdb\u578b\u5bf9\u8c61</p> <p>\u4f8b\u5982\u8bf7\u6c42\u52a8\u4f5cPost<code>\u6307\u5b9a\u6cdb\u578b\u4e3aModel</code>, \u5219\u8f6c\u6362\u5668NetConverter\u4e2d\u7684\u51fd\u6570<code>onConvert\u8fd4\u56de\u503c\u5fc5\u987b\u4e3aModel</code>, \u5982\u679c\u8f6c\u6362\u5931\u8d25\u6216\u8005\u53d1\u751f\u5f02\u5e38\u90fd\u7b97\u8bf7\u6c42\u9519\u8bef</p> <p>\u6ce8\u610f\u5982\u679c\u4f60\u5728\u8f6c\u6362\u5668\u91cc\u9762\u8fd4\u56denull. \u90a3\u4e48\u6307\u5b9a\u7684\u6cdb\u578b\u4e5f\u5e94\u5f53\u662f\u53ef\u7a7a\u7c7b\u578b, \u4f8b\u5982<code>Post&lt;String?&gt;(\"api\")</code></p> <pre><code>scopeNetLife {\nval userList = Get&lt;List&lt;UserModel&gt;&gt;(\"list\") {\nconverter = GsonConverter()\n}.await()\n}\n</code></pre> <p></p> <p>\u5982\u679c\u4f60\u8981\u8fd4\u56de\u6620\u5c04\u597d\u7684\u6570\u636e\u6a21\u578b\u5bf9\u8c61, \u90a3\u4e48\u80af\u5b9a\u8981\u6c42\u521b\u5efa\u8f6c\u6362\u5668\u7684. \u672c\u6846\u67b6\u7531\u4e8e\u4f4e\u8026\u5408\u539f\u5219\u4e0d\u81ea\u5e26\u89e3\u6790\u6846\u67b6</p> <p>\u5e38\u7528\u7684Json\u8f6c\u6362\u5668-\u4ee3\u7801\u793a\u4f8b</p> <p></p>"},{"location":"converter/#_1","title":"\u9ed8\u8ba4\u8fd4\u56de\u6570\u636e\u7c7b\u578b","text":"<p>Net\u652f\u6301\u8bf7\u6c42\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\u53d6\u51b3\u4e8e\u4f60\u7684\u8f6c\u6362\u5668(\u4e5f\u5c31\u662f\u652f\u6301\u8fd4\u56de\u4efb\u4f55\u5bf9\u8c61), \u9ed8\u8ba4\u60c5\u51b5\u4e0d\u521b\u5efa\u8f6c\u6362\u5668\u4e5f\u652f\u6301\u8fd4\u56de\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b</p> \u51fd\u6570 \u63cf\u8ff0 String \u5b57\u7b26\u4e32 ByteArray \u5b57\u8282\u6570\u7ec4 ByteString \u5185\u90e8\u5b9a\u4e49\u7684\u4e00\u79cd\u5b57\u7b26\u4e32\u5bf9\u8c61 Response \u6700\u57fa\u7840\u7684\u54cd\u5e94 File \u6587\u4ef6\u5bf9\u8c61, \u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5e94\u5f53\u79f0\u4e3a\u4e0b\u8f7d\u6587\u4ef6 <p>\u4f7f\u7528\u793a\u4f8b</p> <pre><code>scopeNetLife {\nGet&lt;Response&gt;(\"api\").await().headers(\"\u54cd\u5e94\u5934\u540d\u79f0\") // \u8fd4\u56de\u54cd\u5e94\u5934\n}\n</code></pre> \u9ed8\u8ba4\u4f7f\u7528\u7684\u662f: NetConverter.DEFAULT <pre><code>val DEFAULT = object : NetConverter {\n\noverride fun &lt;R&gt; onConvert(\nsucceed: Type,\nresponse: Response\n): R? {\nreturn when (succeed) {\nString::class.java -&gt; response.body?.string() as R\nByteString::class.java -&gt; response.body?.byteString() as R\nByteArray::class.java -&gt; response.body?.bytes() as R\nResponse::class.java -&gt; response as R\nFile::class.java -&gt; response.file() as R\nelse -&gt; throw ConvertException(\nresponse,\n\"The default converter does not support this type\"\n)\n}\n}\n}\n</code></pre> <p>\u5047\u8bbe\u8fd9\u91cc\u6ca1\u6709\u4f60\u9700\u8981\u7684\u6570\u636e\u7c7b\u578b\u8bf7\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668(\u4f8b\u5982\u8fd4\u56deJson\u6216Protocol)</p>"},{"location":"converter/#_2","title":"\u8bbe\u7f6e\u8f6c\u6362\u5668","text":"<p>\u8f6c\u6362\u5668\u5206\u4e3a\u5168\u5c40\u548c\u5355\u4f8b, \u5355\u4f8b\u53ef\u4ee5\u8986\u76d6\u5168\u5c40\u7684\u8f6c\u6362\u5668. \u5982\u679c\u4e0d\u8bbe\u7f6e\u8f6c\u6362\u5668\u5c31\u4f1a\u91c7\u7528\u9ed8\u8ba4\u7684\u8f6c\u6362\u5668</p> \u5168\u5c40 <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nsetConverter(SerializationConverter())\n}\n</code></pre> \u5355\u4f8b <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"api\"){\nconverter = SerializationConverter()\n}.await()\n}\n</code></pre>"},{"location":"converter/#json","title":"Json\u89e3\u6790\u5e93\u8f6c\u6362\u5668","text":"<p>\u4e00\u822c\u4e1a\u52a1\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627fJSONConverter \u4f7f\u7528\u81ea\u5df1\u7684JSON\u89e3\u6790\u5668\u89e3\u6790\u6570\u636e, \u5b8c\u5168\u81ea\u5b9a\u4e49\u9700\u6c42\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0NetConverter(\u6bd4\u5982\u76f4\u63a5\u8f6c\u6362IO\u6d41)</p> Gson <pre><code>class GsonConvert : JSONConvert(code = \"code\", message = \"msg\", success = \"200\") {\nval gson = GsonBuilder().serializeNulls().create()\n\noverride fun &lt;S&gt; String.parseBody(succeed: Type): S? {\nreturn gson.fromJson(this, succeed)\n}\n}\n</code></pre> kotlin-serialization <pre><code>class SerializationConverter(\nval success: String = \"0\",\nval code: String = \"code\",\nval message: String = \"msg\"\n) : NetConverter {\n\nprivate val jsonDecoder = Json {\nignoreUnknownKeys = true // JSON\u548c\u6570\u636e\u6a21\u578b\u5b57\u6bb5\u53ef\u4ee5\u4e0d\u5339\u914d\ncoerceInputValues = true // \u5982\u679cJSON\u5b57\u6bb5\u662fNull\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c\n}\n\noverride fun &lt;R&gt; onConvert(succeed: Type, response: Response): R? {\ntry {\nreturn NetConverter.onConvert&lt;R&gt;(succeed, response)\n} catch (e: ConvertException) {\nval code = response.code\nwhen {\ncode in 200..299 -&gt; { // \u8bf7\u6c42\u6210\u529f\nval bodyString = response.body?.string() ?: return null\nval kType = response.request.kType() ?: return null\nreturn try {\nval json = JSONObject(bodyString) // \u83b7\u53d6JSON\u4e2d\u540e\u7aef\u5b9a\u4e49\u7684\u9519\u8bef\u7801\u548c\u9519\u8bef\u4fe1\u606f\nif (json.getString(this.code) == success) { // \u5bf9\u6bd4\u540e\u7aef\u81ea\u5b9a\u4e49\u9519\u8bef\u7801\nbodyString.parseBody&lt;R&gt;(kType)\n} else { // \u9519\u8bef\u7801\u5339\u914d\u5931\u8d25, \u5f00\u59cb\u5199\u5165\u9519\u8bef\u5f02\u5e38\nval errorMessage = json.optString(\nmessage,\nNetConfig.app.getString(com.drake.net.R.string.no_error_message)\n)\nthrow ResponseException(response, errorMessage)\n}\n} catch (e: JSONException) { // \u56fa\u5b9a\u683c\u5f0fJSON\u5206\u6790\u5931\u8d25\u76f4\u63a5\u89e3\u6790JSON\nbodyString.parseBody&lt;R&gt;(kType)\n}\n}\ncode in 400..499 -&gt; throw RequestParamsException(response, code.toString()) // \u8bf7\u6c42\u53c2\u6570\u9519\u8bef\ncode &gt;= 500 -&gt; throw ServerResponseException(response, code.toString()) // \u670d\u52a1\u5668\u5f02\u5e38\u9519\u8bef\nelse -&gt; throw ConvertException(response)\n}\n}\n}\n\nfun &lt;R&gt; String.parseBody(succeed: KType): R? {\nreturn jsonDecoder.decodeFromString(Json.serializersModule.serializer(succeed), this) as R\n}\n}\n</code></pre> <p>SerializationConverter\u5c31\u662f\u4eff\u7167JSONConverter\u4ee3\u7801\u5b9e\u73b0</p> FastJson <pre><code>class FastJsonConvert : JSONConvert(code = \"code\", message = \"msg\", success = \"200\") {\n\noverride fun &lt;S&gt; String.parseBody(succeed: Type): S? {\nreturn JSON.parseObject(this, succeed)\n}\n}\n</code></pre> Moshi <pre><code>class MoshiConvert : JSONConvert(code = \"code\", message = \"msg\", success = \"200\") {\nval moshi = Moshi.Builder().build()\n\noverride fun &lt;S&gt; String.parseBody(succeed: Type): S? {\nreturn moshi.adapter&lt;S&gt;(succeed).fromJson(this)\n}\n}\n</code></pre> <ol> <li>\u4f7f\u7528\u8f6c\u6362\u5668\u65f6\u8bf7\u6dfb\u52a0\u5176\u4f9d\u8d56:     GSON | kotlin-serialization | FastJson | Moshi</li> <li>\u63a8\u8350\u4f7f\u7528 <code>kotlinx.Serialization</code>, \u5176\u53ef\u89e3\u6790\u4efb\u4f55\u6cdb\u578b</li> <li>Sample\u6709\u5b8c\u6574\u4ee3\u7801\u793a\u4f8b</li> </ol> <p>\u4ee5\u4e0a\u8f6c\u6362\u5668\u793a\u4f8b\u662f\u5efa\u7acb\u5728\u6570\u636e\u7ed3\u6784\u4e3a\u4ee5\u4e0b\u8868\u683c\u7684\u56fa\u5b9a\u683c\u5f0f\u4e0b, \u5982\u679c\u6709\u7279\u6b8a\u7684\u4e1a\u52a1\u53ef\u80fd\u9700\u8981\u81ea\u884c\u4fee\u6539</p> \u8f6c\u6362\u5668\u53c2\u6570 \u63cf\u8ff0 code \u5373\u540e\u7aef\u5b9a\u4e49\u7684<code>\u6210\u529f\u7801</code>\u5b57\u6bb5\u540d message \u5373\u540e\u7aef\u5b9a\u4e49\u7684<code>\u9519\u8bef\u6d88\u606f</code>\u5b57\u6bb5\u540d success \u5373<code>\u6210\u529f\u7801</code>\u7684\u503c\u7b49\u4e8e\u6307\u5b9a\u65f6\u624d\u7b97\u7f51\u7edc\u8bf7\u6c42\u6210\u529f <p></p> <p>\u6bd4\u5982\u622a\u56fe\u4e2d\u7684\u610f\u4e3a, \u5f53\u8fd4\u56de\u7684Json\u4e2d\u5305\u542bstate\u5b57\u6bb5\u4e14\u503c\u4e3aok\u65f6\u8bf7\u6c42\u624d\u7b97\u662f\u771f\u6b63\u6210\u529f\u624d\u4f1a\u8fd4\u56de\u6570\u636e, \u5426\u5219\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38. \u5176\u4e2dmessage\u4e3a\u9519\u8bef\u4fe1\u606f\u5b57\u6bb5\u540d</p> <p>\u5047\u8bbe\u7b80\u5355\u7684\u6307\u5b9a\u540d\u79f0\u4e0d\u80fd\u6ee1\u8db3\u4f60\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91, \u8bf7\u590d\u5236<code>JSONConvert</code>\u6e90\u7801\u5230\u4f60\u9879\u76ee\u4e2d\u4fee\u6539\u6216\u8005\u76f4\u63a5\u81ea\u5df1\u5b9e\u73b0<code>NetConverter</code></p> <p>\u6ce8\u610f\u89e3\u6790\u5668(Gson\u6216\u8005Moshi)\u7684\u89e3\u6790\u5bf9\u8c61\u8bb0\u5f97\u5b9a\u4e49\u4e3a\u7c7b\u6210\u5458, \u8fd9\u6837\u53ef\u4ee5\u4e0d\u4f1a\u5bfc\u81f4\u6bcf\u6b21\u89e3\u6790\u90fd\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u89e3\u6790\u5bf9\u8c61, \u51cf\u5c11\u5185\u5b58\u6d88\u8017 </p>"},{"location":"converter/#_3","title":"\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668","text":"<p>\u901a\u8fc7\u5b9e\u73b0<code>NetConverter</code>\u63a5\u53e3\u53ef\u4ee5\u7f16\u5199\u81ea\u5df1\u7684\u903b\u8f91\u7f51\u7edc\u8bf7\u6c42\u8fd4\u56de\u7684\u6570\u636e, <code>NetConvert.DEFAULT</code>\u4e3a\u9ed8\u8ba4\u7684\u8f6c\u6362\u5668\u652f\u6301\u8fd4\u56deFile/String/Response\u7b49</p> <p>\u6846\u67b6\u4e2d\u81ea\u5e26\u4e00\u4e2a<code>JSONConverter</code>\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u6216\u8005\u76f4\u63a5\u4f7f\u7528. \u5176\u53ef\u4ee5\u8f6c\u6362JSON\u6570\u636e.</p> JSONConverter \u6e90\u7801 <pre><code>/**\n * \u5e38\u89c1\u7684JSON\u8f6c\u6362\u5668\u5b9e\u73b0, \u5982\u679c\u4e0d\u6ee1\u610f\u7ee7\u627f\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u4e1a\u52a1\u903b\u8f91\n *\n * @param success  \u540e\u7aef\u5b9a\u4e49\u4e3a\u6210\u529f\u72b6\u6001\u7684\u9519\u8bef\u7801\u503c\n * @param code  \u9519\u8bef\u7801\u5728JSON\u4e2d\u7684\u5b57\u6bb5\u540d\n * @param message  \u9519\u8bef\u4fe1\u606f\u5728JSON\u4e2d\u7684\u5b57\u6bb5\u540d\n */\nabstract class JSONConvert(\nval success: String = \"0\",\nval code: String = \"code\",\nval message: String = \"msg\"\n) : NetConverter {\n\noverride fun &lt;R&gt; onConvert(succeed: Type, response: Response): R? {\ntry {\nreturn NetConverter.onConvert&lt;R&gt;(succeed, response)\n} catch (e: ConvertException) {\nval code = response.code\nwhen {\ncode in 200..299 -&gt; { // \u8bf7\u6c42\u6210\u529f\nval bodyString = response.body?.string() ?: return null\nreturn try {\nval json = JSONObject(bodyString) // \u83b7\u53d6JSON\u4e2d\u540e\u7aef\u5b9a\u4e49\u7684\u9519\u8bef\u7801\u548c\u9519\u8bef\u4fe1\u606f\nif (json.getString(this.code) == success) { // \u5bf9\u6bd4\u540e\u7aef\u81ea\u5b9a\u4e49\u9519\u8bef\u7801\nbodyString.parseBody&lt;R&gt;(succeed)\n} else { // \u9519\u8bef\u7801\u5339\u914d\u5931\u8d25, \u5f00\u59cb\u5199\u5165\u9519\u8bef\u5f02\u5e38\nval errorMessage = json.optString(\nmessage,\nNetConfig.app.getString(com.drake.net.R.string.no_error_message)\n)\nthrow ResponseException(response, errorMessage)\n}\n} catch (e: JSONException) { // \u56fa\u5b9a\u683c\u5f0fJSON\u5206\u6790\u5931\u8d25\u76f4\u63a5\u89e3\u6790JSON\nbodyString.parseBody&lt;R&gt;(succeed)\n}\n}\ncode in 400..499 -&gt; throw RequestParamsException(response, code.toString()) // \u8bf7\u6c42\u53c2\u6570\u9519\u8bef\ncode &gt;= 500 -&gt; throw ServerResponseException(response, code.toString()) // \u670d\u52a1\u5668\u5f02\u5e38\u9519\u8bef\nelse -&gt; throw ConvertException(response)\n}\n}\n}\n\n/**\n     * \u53cd\u5e8f\u5217\u5316JSON\n     *\n     * @param succeed JSON\u5bf9\u8c61\u7684\u7c7b\u578b\n     * @receiver \u539f\u59cb\u5b57\u7b26\u4e32\n     */\nabstract fun &lt;R&gt; String.parseBody(succeed: Type): R?\n}\n</code></pre> <p>JSONConvert\u7684\u6838\u5fc3\u903b\u8f91</p> <ol> <li>\u5224\u65ad\u670d\u52a1\u5668\u7684\u9519\u8bef\u7801</li> <li>\u5224\u65ad\u540e\u7aef\u81ea\u5b9a\u4e49\u7684\u9519\u8bef\u7801</li> <li>\u5982\u679c\u5224\u65ad\u53d1\u751f\u9519\u8bef\u5219\u629b\u51fa\u4e00\u4e2a\u5305\u542b\u9519\u8bef\u4fe1\u606f\u7684\u5f02\u5e38</li> <li>\u5982\u679c\u90fd\u5224\u65ad\u6210\u529f\u5219\u5f00\u59cb\u89e3\u6790\u6570\u636e\u5e76return\u6570\u636e\u5bf9\u8c61</li> </ol> <p>\u5728\u8f6c\u6362\u5668\u4e2d\u6839\u636e\u9700\u8981\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u52a0\u4e0a\u5e38\u89c1\u7684\u89e3\u5bc6\u6570\u636e, token\u5931\u6548\u8df3\u8f6c\u767b\u5f55, \u9650\u5236\u591a\u7aef\u767b\u5f55\u7b49\u903b\u8f91. \u65e5\u5fd7\u4fe1\u606f\u8f93\u51fa\u8bf7\u9605\u8bfb: \u65e5\u5fd7\u8bb0\u5f55\u5668</p> <p>\u5982\u679c\u662f\u9519\u8bef\u4fe1\u606f\u5efa\u8bae\u629b\u51fa\u5f02\u5e38, \u5c31\u53ef\u4ee5\u5728\u5168\u5c40\u5f02\u5e38\u5904\u7406\u5668\u4e2d\u7edf\u4e00\u5904\u7406, \u8bf7\u9605\u8bfb:\u5168\u5c40\u9519\u8bef\u5904\u7406</p> <p></p>"},{"location":"cookie/","title":"Cookie\u7ba1\u7406","text":"<p>Net\u4f7f\u7528\u7684\u662fOkHttp\u7684Cookie\u7ba1\u7406\u65b9\u6848(CookieJar), \u5e76\u4e14\u63d0\u4f9b\u6301\u4e45\u5316\u5b58\u50a8\u7684Cookie\u7ba1\u7406\u5b9e\u73b0(PersistentCookieJar)</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// \u6dfb\u52a0\u6301\u4e45\u5316Cookie\ncookieJar(PersistentCookieJar(this@App))\n}\n</code></pre> <p>PersistentCookieJar\u53ef\u4ee5\u624b\u52a8\u589e\u5220Cookie</p> \u51fd\u6570 \u63cf\u8ff0 addAll \u6dfb\u52a0Cookie getAll \u83b7\u53d6\u67d0\u4e2a\u57df\u540d\u7684\u6240\u6709Cookie remove \u5220\u9664\u67d0\u4e2a\u57df\u540d\u4e0b\u6240\u6709\u6216\u8005\u6307\u5b9a\u540d\u79f0\u7684Cookie clear \u5220\u9664\u5ba2\u6237\u7aef\u5168\u90e8Cookie <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u5ba2\u6237\u7aef\u53ef\u4ee5\u83b7\u53d6\u5230\u5df2\u8bbe\u7f6e\u7684cookieJar <pre><code>(NetConfig.okHttpClient.cookieJar as? PersistentCookieJar)?.clear()\n</code></pre></p> <p> PersistentCookieJar\u4f7f\u7528\u6570\u636e\u5e93\u5b9e\u73b0Cookies\u5b58\u50a8, \u4f60\u53ef\u4ee5\u6307\u5b9a<code>dbName</code>\u6765\u521b\u5efa\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8ba9\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u9694\u7eddCookie\u5171\u4eab</p>"},{"location":"coroutine-request/","title":"\u534f\u7a0b\u8bf7\u6c42","text":"<p>Net\u57282.0\u5f00\u59cb\u5f15\u5165\u534f\u7a0b\u6765\u652f\u6301\u5e76\u53d1\u548c\u5f02\u6b65, \u867d\u7136\u5f88\u591a\u7f51\u7edc\u6846\u67b6\u652f\u6301\u534f\u7a0b, \u4f46\u662fNet\u5bf9\u4e8e\u534f\u7a0b\u751f\u547d\u5468\u671f\u7684\u63a7\u5236\u7b97\u5f97\u4e0a\u662f\u72ec\u6709. \u5e76\u4e14Net\u4e0d\u4ec5\u4ec5\u7f51\u7edc\u8bf7\u6c42, \u5176\u4e5f\u652f\u6301\u521b\u5efa\u4efb\u4f55\u5f02\u6b65\u4efb\u52a1.</p> <p>\u8fd9\u91cc\u7684<code>\u540c\u65f6/\u5e76\u53d1/\u5e76\u884c</code>\u7edf\u79f0\u4e3a\u5e76\u53d1(\u5177\u4f53\u662f\u4e0d\u662f\u5e76\u884c\u4e0d\u9700\u8981\u5f00\u53d1\u8005\u6765\u8003\u8651)</p> <p> \u5728\u4e0a\u7ae0\u8282\u5df2\u7ecf\u4f7f\u7528\u8fc7\u4e86\u7f51\u7edc\u7684\u5e76\u53d1\u8bf7\u6c42</p> <p>\u8fd9\u91cc\u518d\u6f14\u793a\u540c\u65f6(\u5e76\u53d1)\u8bf7\u6c42\u767e\u5ea6\u7f51\u7ad9<code>\u4e00\u4e07\u6b21</code>\u5e76\u4e14\u4e00\u6b21\u53d6\u6d88</p> <pre><code>val job = scopeNetLife {\nrepeat(10000) {\n// \u8fd9\u91cc\u5c06\u8fd4\u56de\u7684\u6570\u636e\u663e\u793a\u5728TextView\u4e0a\nlaunch {\ntvFragment.text = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\n}\n}\n}\n</code></pre> <p>\u7b49\u5f85\u4e94\u79d2\u540e\u53d6\u6d88\u8bf7\u6c42 <pre><code>thread {\nThread.sleep(5000) // \u7b49\u5f85\u4e94\u79d2\njob.cancel()\n}\n</code></pre></p> <p>Net\u4e3b\u8981\u63a8\u8350\u4f7f\u7528\u7684\u662f\u534f\u7a0b\u8bf7\u6c42, \u4f46\u662f\u540c\u65f6\u652f\u6301\u5176\u4ed6\u65b9\u5f0f\u53d1\u8d77\u8bf7\u6c42</p> <ul> <li>\u534f\u7a0b\u8bf7\u6c42</li> <li>\u540c\u6b65\u8bf7\u6c42</li> <li>\u56de\u8c03\u8bf7\u6c42</li> </ul>"},{"location":"debounce/","title":"\u81ea\u52a8\u641c\u7d22/\u7b5b\u9009","text":"<p>\u73b0\u5728\u5e94\u7528\u7684\u641c\u7d22\u8f93\u5165\u6846\u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u662f\u8f93\u5165\u5b8c\u641c\u7d22\u5173\u952e\u8bcd\u540e\u81ea\u52a8\u53d1\u8d77\u8bf7\u6c42\u5f00\u59cb\u641c\u7d22</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u6d89\u53ca\u5230\u4ee5\u4e0b\u9700\u6c42:</p> <ol> <li>\u4e0d\u80fd\u6bcf\u6b21\u53d8\u5316\u90fd\u5f00\u59cb\u641c\u7d22\u8bf7\u6c42, \u8fd9\u6837\u4f1a\u5bfc\u81f4\u591a\u4f59\u7684\u7f51\u7edc\u8d44\u6e90\u6d6a\u8d39. \u6240\u4ee5\u5e94\u8be5\u5728\u7528\u6237\u505c\u6b62\u8f93\u5165\u540e\u7684\u6307\u5b9a\u65f6\u95f4\u540e(\u9ed8\u8ba4800\u6beb\u79d2)\u5f00\u59cb\u641c\u7d22</li> <li>\u5f53\u4ea7\u751f\u65b0\u7684\u641c\u7d22\u8bf7\u6c42\u540e\u53d6\u6d88\u65e7\u7684\u8bf7\u6c42\u4ee5\u9632\u6b62\u65e7\u6570\u636e\u8986\u76d6\u65b0\u6570\u636e</li> <li>\u5f53\u8f93\u5165\u5185\u5bb9\u6ca1\u6709\u53d8\u5316(\u4f8b\u5982\u590d\u5236\u7c98\u8d34\u91cd\u590d\u5185\u5bb9\u5230\u641c\u7d22\u6846)\u4e0d\u4f1a\u53d1\u8d77\u641c\u7d22\u8bf7\u6c42</li> </ol> <p></p> <p>\u622a\u56fe\u9884\u89c8</p> <p></p> <p></p> <pre><code>var scope: CoroutineScope? = null\n\net_input.debounce().distinctUntilChanged().launchIn(this) {\nscope?.cancel() // \u53d1\u8d77\u65b0\u7684\u8bf7\u6c42\u524d\u53d6\u6d88\u65e7\u7684\u8bf7\u6c42, \u907f\u514d\u65e7\u6570\u636e\u8986\u76d6\u65b0\u6570\u636e\nscope = scopeNetLife { // \u4fdd\u5b58\u65e7\u7684\u8bf7\u6c42\u5230\u4e00\u4e2a\u53d8\u91cf\u4e2d, scopeNetLife\u5176\u51fd\u6570\u51b3\u5b9a\u7f51\u7edc\u8bf7\u6c42\u751f\u547d\u5468\u671f\ntvFragment.text = \"\u8bf7\u6c42\u4e2d\"\nval data = Get&lt;String&gt;(\"http://api.k780.com/?app=life.time&amp;appkey=10003&amp;sign=b59bc3ef6191eb9f747dd4e83c99f2a4&amp;format=json\").await()\ntvFragment.text = JSONObject(data).getJSONObject(\"result\").getString(\"datetime_2\")\n}\n}\n</code></pre> <p>\u5982\u679c\u60f3\u8981\u8bbe\u7f6e\u81ea\u5df1\u7684\u8282\u6d41\u9600\u8d85\u65f6\u65f6\u95f4\u8bf7\u6307\u5b9a\u53c2\u6570 <pre><code>fun EditText.debounce(timeoutMillis: Long = 800)\n</code></pre></p> <p>\u8fc7\u6ee4\u6389\u91cd\u590d\u7ed3\u679c\u4f7f\u7528\u51fd\u6570<code>distinctUntilChanged</code></p>"},{"location":"debounce/#_1","title":"\u751f\u547d\u5468\u671f","text":"<p>\u5176\u751f\u547d\u5468\u671f\u4f9d\u7136\u9075\u5b88\u7f51\u7edc\u8bf7\u6c42\u4f5c\u7528\u57df\u51fd\u6570scope*</p> <p>\u4f8b\u5982\u793a\u4f8b\u4e2d\u4f7f\u7528\u7684<code>scopeNetLife</code>\u5c31\u4f1a\u5728Activity\u6216Fragment\u5173\u95ed\u65f6\u81ea\u52a8\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42</p>"},{"location":"default-converter/","title":"\u9ed8\u8ba4\u8f6c\u6362\u5668","text":"<p>Net\u652f\u6301\u8bf7\u6c42\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\u53d6\u51b3\u4e8e\u4f60\u7684\u8f6c\u6362\u5668(\u5373\u7406\u8bba\u4e0a\u652f\u6301\u8fd4\u56de\u4efb\u4f55\u6570\u636e\u5bf9\u8c61), \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u652f\u6301\u8fd4\u56de\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b</p> \u51fd\u6570 \u63cf\u8ff0 String \u5b57\u7b26\u4e32 ByteArray \u5b57\u8282\u6570\u7ec4 ByteString \u5185\u90e8\u5b9a\u4e49\u7684\u4e00\u79cd\u5b57\u7b26\u4e32\u5bf9\u8c61 File \u6587\u4ef6\u5bf9\u8c61, \u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5e94\u5f53\u79f0\u4e3a\u4e0b\u8f7d\u6587\u4ef6 Response \u6700\u57fa\u7840\u7684, \u5305\u542b\u5168\u90e8\u54cd\u5e94\u4fe1\u606f\u7684\u5bf9\u8c61(\u54cd\u5e94\u4f53/\u54cd\u5e94\u5934/\u8bf7\u6c42\u4fe1\u606f\u7b49) <p>\u4f7f\u7528\u793a\u4f8b</p> <pre><code>scopeNetLife {\nGet&lt;Response&gt;(\"api\").await().headers(\"\u54cd\u5e94\u5934\u540d\u79f0\") // \u8fd4\u56de\u54cd\u5e94\u5934\n}\n</code></pre> \u9ed8\u8ba4\u4f7f\u7528\u7684\u662f: NetConverter.DEFAULT <pre><code>interface NetConverter {\n\n@Throws(Throwable::class)\nfun &lt;R&gt; onConvert(succeed: Type, response: Response): R?\n\ncompanion object DEFAULT : NetConverter {\n/**\n         * \u8fd4\u56de\u7ed3\u679c\u5e94\u5f53\u7b49\u4e8e\u6cdb\u578b\u5bf9\u8c61, \u53ef\u7a7a\n         * @param succeed \u8bf7\u6c42\u8981\u6c42\u8fd4\u56de\u7684\u6cdb\u578b\u7c7b\u578b\n         * @param response \u8bf7\u6c42\u54cd\u5e94\u5bf9\u8c61\n         */\noverride fun &lt;R&gt; onConvert(succeed: Type, response: Response): R? {\nreturn when {\nsucceed === String::class.java &amp;&amp; response.isSuccessful -&gt; response.body?.string() as R\nsucceed === ByteString::class.java &amp;&amp; response.isSuccessful -&gt; response.body?.byteString() as R\nsucceed is GenericArrayType &amp;&amp; succeed.genericComponentType === Byte::class.java &amp;&amp; response.isSuccessful -&gt; response.body?.bytes() as R\nsucceed === File::class.java &amp;&amp; response.isSuccessful -&gt; response.file() as R\nsucceed === Response::class.java -&gt; response as R\nelse -&gt; throw ConvertException(response, \"An exception occurred while converting the NetConverter.DEFAULT\")\n}\n}\n}\n}\n</code></pre> <p>\u5047\u8bbe\u8fd9\u91cc\u6ca1\u6709\u4f60\u9700\u8981\u7684\u6570\u636e\u7c7b\u578b\u8bf7\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668(\u4f8b\u5982\u8fd4\u56deJson\u6216Protocol)</p>"},{"location":"download-file/","title":"\u4e0b\u8f7d\u6587\u4ef6","text":""},{"location":"download-file/#_1","title":"\u7b80\u5355\u4e0b\u8f7d","text":"<p>\u4e0b\u8f7d\u6587\u4ef6\u548c\u666e\u901a\u7684\u63a5\u53e3\u8bf7\u6c42\u552f\u4e00\u533a\u522b\u5c31\u662f\u6cdb\u578b\u4e0d\u540c</p> <pre><code>scopeNetLife {\nval file = Get&lt;File&gt;(\"download\").await()\n}\n</code></pre> <p>Download\u51fd\u6570\u4e00\u8c03\u7528\u5c31\u4f1a\u5f00\u59cb\u6267\u884c\u4e0b\u8f7d\u6587\u4ef6\u8bf7\u6c42, \u7136\u540e<code>await</code>\u5219\u4f1a\u7b49\u5f85\u4e0b\u8f7d\u6587\u4ef6\u5b8c\u6210\u7136\u540e\u8fd4\u56de\u4e00\u4e2aFile\u5bf9\u8c61</p>"},{"location":"download-file/#_2","title":"\u4e0b\u8f7d\u9009\u9879","text":"<p>\u652f\u6301\u4e30\u5bcc\u7684\u4e0b\u8f7d\u5b9a\u5236\u65b9\u6848, \u5e76\u4e14\u4f1a\u4e0d\u65ad\u5730\u66f4\u65b0\u5b8c\u5584</p> <pre><code>scopeNetLife {\nval file =\nGet&lt;File&gt;(\"https://download.sublimetext.com/Sublime%20Text%20Build%203211.dmg\") {\nsetDownloadFileName(\"net.apk\")\nsetDownloadDir(requireContext().filesDir)\nsetDownloadMd5Verify()\n}.await()\n}\n</code></pre> <p>\u914d\u7f6e\u9009\u9879</p> \u51fd\u6570 \u63cf\u8ff0 setDownloadFileName \u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\u79f0 setDownloadDir \u4e0b\u8f7d\u4fdd\u5b58\u7684\u76ee\u5f55, \u4e5f\u652f\u6301\u5305\u542b\u6587\u4ef6\u540d\u79f0\u7684\u5b8c\u6574\u8def\u5f84, \u5982\u679c\u4f7f\u7528\u5b8c\u6574\u8def\u5f84\u5219\u65e0\u89c6<code>setDownloadFileName</code>\u8bbe\u7f6e setDownloadMd5Verify \u4e0b\u8f7d\u662f\u5426\u5f00\u542fMD5\u6821\u9a8c, \u5982\u679c\u670d\u52a1\u5668\u8fd4\u56de \"Content-MD5\"\u54cd\u5e94\u5934\u548c\u5236\u5b9a\u8def\u5f84\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6MD5\u76f8\u540c\u662f\u5426\u76f4\u63a5\u8fd4\u56deFile, \u4e0d\u4f1a\u91cd\u65b0\u4e0b\u8f7d setDownloadFileNameConflict \u4e0b\u8f7d\u6587\u4ef6\u540d\u5982\u679c\u5728\u6307\u5b9a\u8def\u5f84\u4e0b\u5b58\u5728\u540c\u540d\u4f1a\u81ea\u52a8\u91cd\u65b0\u547d\u540d, \u4f8b\u5982<code>file_name(1).apk</code> setDownloadFileNameDecode \u6587\u4ef6\u540d\u79f0\u662f\u5426\u4f7f\u7528URL\u89e3\u7801, \u4f8b\u5982\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\u5982\u679c\u662f\u4e2d\u6587, \u670d\u52a1\u5668\u4f20\u8f93\u7ed9\u4f60\u7684\u4f1a\u662f\u88abURL\u7f16\u7801\u7684\u5b57\u7b26\u4e32. \u4f60\u4f7f\u7528URL\u89e3\u7801\u540e\u624d\u662f\u53ef\u8bfb\u7684\u4e2d\u6587\u540d\u79f0 setDownloadTempFile \u4e0b\u8f7d\u662f\u5426\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6, \u907f\u514d\u4e0b\u8f7d\u5931\u8d25\u540e\u8986\u76d6\u540c\u540d\u6587\u4ef6\u6216\u8005\u65e0\u6cd5\u5224\u522b\u662f\u5426\u5df2\u4e0b\u8f7d\u5b8c\u6574, \u4ec5\u5728\u4e0b\u8f7d\u5b8c\u6574\u4ee5\u540e\u624d\u4f1a\u663e\u793a\u4e3a\u539f\u6709\u6587\u4ef6\u540d addDownloadListener \u4e0b\u8f7d\u8fdb\u5ea6\u76d1\u542c\u5668, \u5177\u4f53\u4ecb\u7ecd\u5728\u8fdb\u5ea6\u76d1\u542c\u4e2d <p>\u4e0d\u4f7f\u7528<code>await</code>\u51fd\u6570\u5219\u4e0b\u8f7d\u62a5\u9519\u4e5f\u4e0d\u4f1a\u88abNet\u6355\u6349\u5230, \u5c06\u4f1a\u88ab\u5ffd\u7565, \u4f7f\u7528await\u5219\u4f1a\u89e6\u53d1Net\u7684\u9519\u8bef\u5904\u7406, \u7ec8\u6b62\u5f53\u524d\u4f5c\u7528\u57df(scope)\u5185\u5176\u4ed6\u7f51\u7edc\u8bf7\u6c42, \u88abNet\u5168\u5c40\u9519\u8bef\u5904\u7406\u6355\u83b7</p>"},{"location":"download-file/#_3","title":"\u7f13\u5b58\u6587\u4ef6","text":"<p>\u6587\u4ef6\u7f13\u5b58\u63a8\u8350\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f</p> <ul> <li>\u6587\u4ef6\u5224\u65ad: \u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u81ea\u7531, \u4f60\u81ea\u5df1\u53bb\u5224\u65ad\u672c\u5730\u78c1\u76d8\u662f\u5426\u6709\u8be5\u6587\u4ef6, \u6ca1\u6709\u624d\u53d1\u8d77\u8bf7\u6c42, \u6bd4\u5982\u4f60\u6839\u636e\u6587\u4ef6\u540d\u5224\u65ad. \u65e0\u9700\u7f51\u7edc</li> <li>\u7f13\u5b58\u6a21\u5f0f: \u5360\u7528\u8bbe\u5907\u4e24\u4efd\u7a7a\u95f4(\u56e0\u4e3a\u7f13\u5b58\u548c\u4e0b\u8f7d\u540e\u7684\u6587\u4ef6\u90fd\u8981\u5360\u7a7a\u95f4), \u5e76\u4e14\u8bfb\u53d6\u7f13\u5b58\u7684\u65f6\u5019\u4f1a\u672c\u5730\u78c1\u76d8\u590d\u5236\u4f9d\u65e7\u6709\u8017\u65f6. \u5982\u679c\u4e0b\u8f7d\u5730\u5740\u52a8\u6001\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7f13\u5b58Key. \u65e0\u9700\u7f51\u7edc</li> <li>MD5\u6821\u9a8c: \u8fd9\u79cd\u6bd4\u8f83\u5b89\u5168, \u5c31\u662f\u7531\u670d\u52a1\u5668\u8fd4\u56de\u6587\u4ef6\u7684MD5\u7ed9\u4f60, \u8bf7\u67e5\u770b<code>BaseRequest.setDownloadMd5Verify</code>\u65b9\u6cd5. \u8981\u6c42\u670d\u52a1\u5668\u8fd4\u56de\u6307\u5b9a\u54cd\u5e94\u5934, \u8981\u6c42\u8054\u7f51</li> </ul>"},{"location":"error-default/","title":"\u9ed8\u8ba4\u9519\u8bef\u5904\u7406","text":"<p>Net\u5177\u5907\u5b8c\u5584\u7684\u9519\u8bef\u5904\u7406\u673a\u5236, \u80fd\u6355\u83b7\u5927\u90e8\u5206\u7f51\u7edc\u8bf7\u6c42\u6216\u8005\u5f02\u6b65\u4efb\u52a1\u5bfc\u81f4\u7684\u5d29\u6e83, \u51cf\u5c11App\u5d29\u6e83\u548c\u6536\u96c6\u8be6\u7ec6\u7684\u9519\u8bef\u4fe1\u606f</p> <p> \u4ee5\u4e0b\u573a\u666f\u7684\u629b\u51fa\u7684\u5f02\u5e38\u4f1a\u88abNet\u6355\u83b7\u5230(\u4e0d\u4f1a\u5bfc\u81f4\u5d29\u6e83)</p> <ol> <li>\u4f5c\u7528\u57df\u5185\u90e8 (scope**\u7b49\u51fd\u6570\u5927\u62ec\u53f7<code>{}</code>\u5185\u90e8)</li> <li>\u62e6\u622a\u5668\u4e2d (Interceptor/RequestInterceptor)</li> <li>\u8f6c\u6362\u5668\u4e2d (NetConverter)</li> </ol> <p></p> <p>\u5982\u679c\u6355\u83b7\u5230\u9519\u8bef\u9ed8\u8ba4\u4f1a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c</p> <ul> <li><code>Logcat</code>\u4e2d\u4f1a\u8f93\u51fa\u8be6\u7ec6\u7684\u5f02\u5e38\u5806\u6808\u4fe1\u606f, \u5982\u679c\u60f3\u8981\u8f93\u51fa\u66f4\u8be6\u7ec6\u5185\u5bb9\u8bf7\u9605\u8bfb\u81ea\u5b9a\u4e49\u5f02\u5e38</li> <li><code>Toast</code>\u5410\u53f8\u9519\u8bef\u5f02\u5e38\u4fe1\u606f, \u5982\u679c\u60f3\u8981\u81ea\u5b9a\u4e49\u6216\u8005\u56fd\u9645\u5316\u9519\u8bef\u6587\u672c\u8bf7\u9605\u8bfb\u81ea\u5b9a\u4e49\u9519\u8bef\u63d0\u793a</li> </ul> <p> \u8981\u6539\u53d8\u4ee5\u4e0a\u7684\u9ed8\u8ba4\u9519\u8bef\u5904\u7406\u8bf7\u9605\u8bfb\u9605\u8bfb\u5168\u5c40\u9519\u8bef\u5904\u7406, \u9ed8\u8ba4\u5168\u5c40\u9519\u8bef\u5904\u7406\u5668\u5b9e\u73b0\u6e90\u7801: NetErrorHandler </p> <p>\u5efa\u8bae\u5728\u5168\u5c40\u9519\u8bef\u5904\u7406\u5668\u4e2d\u5c06\u6355\u83b7\u5230\u7684Exception(\u9664\u65e0\u7f51\u7edc\u5f02\u5e38\u610f\u5916)\u4e0a\u62a5\u5230\u5d29\u6e83\u7edf\u8ba1\u5e73\u53f0</p>"},{"location":"error-exception/","title":"\u81ea\u5b9a\u4e49\u5f02\u5e38","text":"<p>\u4ee5\u4e0b\u4e3aNet\u5185\u90e8\u5e38\u89c1\u53d1\u751f\u7684\u5f02\u5e38\u5bf9\u8c61. \u4e0d\u4ee3\u8868\u5168\u90e8\u5f02\u5e38, \u4f8b\u5982\u4e0d\u5305\u542b\u5f00\u53d1\u8005\u81ea\u5df1\u5b9a\u4e49\u7684\u5f02\u5e38</p> \u5f02\u5e38 \u63cf\u8ff0 NetException \u672a\u77e5\u7684\u7f51\u7edc\u5f02\u5e38, \u4e00\u822c\u60c5\u51b5\u5e94\u5f53\u7ee7\u627f\u4ed6\u6765\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\u5f02\u5e38 HttpFailureException Http\u8bf7\u6c42\u9519\u8bef, Http\u8bf7\u6c42\u5931\u8d25(onFailure) HttpResponseException Http\u8bf7\u6c42\u6210\u529f\u540e\u53d1\u751f\u7684\u9519\u8bef, Http\u8bf7\u6c42\u6210\u529f\u4f46\u53d1\u751f\u5f02\u5e38(onResponse) URLParseException \u5730\u5740\u9519\u8bef NetUnknownHostException \u57df\u540d\u9519\u8bef NetSocketTimeoutException \u8fde\u63a5\u8d85\u65f6 NetConnectException \u8fde\u63a5\u7f51\u7edc\u5931\u8d25, \u8bbe\u5907\u672a\u5f00\u542f\u7f51\u7edc NetworkingException \u5f53\u524d\u7f51\u7edc\u4e0d\u53ef\u7528, \u8bbe\u5907\u7f51\u7edc\u5f02\u5e38 DownloadFileException \u4e0b\u8f7d\u6587\u4ef6\u5f02\u5e38 ConvertException \u89e3\u6790\u9519\u8bef, <code>NetConvert</code>\u4e2d\u53d1\u751f\u7684\u672a\u6355\u83b7\u5f02\u5e38\u90fd\u7b97\u89e3\u6790\u9519\u8bef RequestParamsException \u8bf7\u6c42\u53c2\u6570\u9519\u8bef <code>400 - 499</code> \u8303\u56f4\u5185\u9519\u8bef\u7801 ServerResponseException \u670d\u52a1\u5668\u9519\u8bef <code>500 - 599</code> \u8303\u56f4\u5185\u9519\u8bef\u7801 ResponseException \u9519\u8bef\u7801\u5f02\u5e38, \u4e00\u822c\u5e94\u7528\u4e8e\u540e\u7aef\u8fd4\u56de\u7684\u9519\u8bef\u7801\u548c\u5176\u5b9a\u4e49\u7684\u6210\u529f\u7801\u4e0d\u5339\u914d NullPointerException \u7a7a\u6307\u9488, \u4e00\u822c\u662f\u5728\u4f5c\u7528\u57df\u5185\u64cd\u4f5c\u4e00\u4e2a\u7a7a\u7684\u5bf9\u8c61 <p><code>NetConnectException/NetworkingException</code> \u8fd9\u4e24\u4e2a\u5f02\u5e38\u4e00\u822c\u662f\u8bbe\u5907\u7f51\u7edc\u5f02\u5e38\u53ef\u4ee5\u4e0d\u7528\u6536\u96c6\u4e0a\u62a5, \u5176\u4ed6\u7f51\u7edc\u5f02\u5e38\u5efa\u8bae\u6536\u96c6\u5904\u7406</p>"},{"location":"error-exception/#_1","title":"\u81ea\u5b9a\u4e49\u5f02\u5e38","text":"<p>\u6211\u4eec\u53ef\u4ee5\u5728\u8f6c\u6362\u5668(NetConverter)\u6216\u8005\u62e6\u622a\u5668(Interceptor)\u4e2d\u629b\u51fa\u4efb\u4f55\u5f02\u5e38\u5bf9\u8c61, \u6bd4\u5982token\u5931\u6548\u6211\u4eec\u629b\u51fa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684<code>TokenException</code>\u5f02\u5e38\u5bf9\u8c61.  \u8be5\u5f02\u5e38\u5bf9\u8c61\u5728\u5355\u4f8b\u6216\u5168\u5c40\u9519\u8bef\u5904\u7406\u90fd\u53ef\u4ee5\u88ab\u6536\u5230. \u53ef\u4ee5\u7528\u4e8e\u5224\u65ad\u662f\u5426\u4e3atoken\u5931\u6548(\u5931\u6548\u5219\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762)</p> <p>\u8f6c\u6362\u5668\u4e2d\u53d1\u751f\u7684\u6240\u6709\u5f02\u5e38\u9664\u975e\u662fNetException\u7684\u5b50\u7c7b\u5426\u5219\u90fd\u5c06\u88abConvertException\u5305\u88f9(\u5373\u6355\u83b7\u7684\u662fConvertException, cause\u624d\u4e3a\u5b9e\u9645\u629b\u51fa\u5f02\u5e38).</p>"},{"location":"error-exception/#_2","title":"\u4f7f\u7528\u5f02\u5e38\u5c5e\u6027","text":"<p>Net\u81ea\u5e26\u7684\u4e00\u4e9b\u5f02\u5e38\u90fd\u4f1a\u6709\u4e00\u4e2a\u7c7b\u578b\u4e3aAny\u7684\u5c5e\u6027<code>tag</code>. \u53ef\u4ee5\u7528\u6765\u4f20\u9012\u4efb\u4f55\u5bf9\u8c61\u6765\u7528\u4e8e\u5224\u65ad\u9519\u8bef\u7c7b\u578b. \u6bd4\u5982<code>ResponseException</code>\u6211\u5e38\u7528\u4e8e\u4f5c\u4e3a\u8bf7\u6c42\u670d\u52a1\u5668\u6210\u529f\u4f46\u662f\u670d\u52a1\u5668\u4e1a\u52a1\u9519\u8bef. \u7136\u540etag\u4e3a\u4e1a\u52a1\u9519\u8bef\u7801</p> <p>\u793a\u4f8b\u4ee3\u7801</p> <p>\u5728\u8f6c\u6362\u5668\u4e2d\u83b7\u53d6401</p> <pre><code>class SerializationConverter(\nval success: String = \"0\",\nval code: String = \"code\",\nval message: String = \"msg\"\n) : NetConverter {\n\noverride fun &lt;R&gt; onConvert(succeed: Type, response: Response): R? {\ntry {\nreturn NetConverter.onConvert&lt;R&gt;(succeed, response)\n} catch (e: ConvertException) {\nval code = response.code\nwhen {\ncode in 200..299 -&gt; { // \u8bf7\u6c42\u6210\u529f\n// ... \u5047\u8bbeToken\u5931\u6548. \u540e\u7aef\u8fd4\u56de\u4e1a\u52a1\u9519\u8bef\u7801 srvCode = 401\nthrow ResponseException(response, errorMessage, tag = srvCode) // \u5c06\u4e1a\u52a1\u9519\u8bef\u7801\u4f5c\u4e3atag\u4f20\u9012\n}\ncode in 400..499 -&gt; throw RequestParamsException(response, code.toString()) // \u8bf7\u6c42\u53c2\u6570\u9519\u8bef\ncode &gt;= 500 -&gt; throw ServerResponseException(response, code.toString()) // \u670d\u52a1\u5668\u5f02\u5e38\u9519\u8bef\nelse -&gt; throw ConvertException(response)\n}\n}\n}\n}\n</code></pre> <p>\u5168\u5c40\u9519\u8bef\u5904\u7406\u5668</p> <pre><code>// \u521b\u5efa\u9519\u8bef\u5904\u7406\u5668\nMyErrorHandler : NetErrorHandler {\noverride fun onError(e: Throwable) {\n// .... \u5176\u4ed6\u9519\u8bef\nif (e is ResponseException &amp;&amp; e.tag == 401) { // \u5224\u65ad\u5f02\u5e38\u4e3atoken\u5931\u6548\n// \u6253\u5f00\u767b\u5f55\u754c\u9762\u6216\u8005\u5f39\u767b\u5f55\u5931\u6548\u5bf9\u8bdd\u6846\n}\n}\n}\n\n// \u521d\u59cb\u5316Net\u7684\u65f6\u5019\u8bbe\u7f6e\u9519\u8bef\u5904\u7406\u5668\nNetConfig.initialize(\"host\", this) {\nsetErrorHandler(MyErrorHandler()\n}\n</code></pre>"},{"location":"error-global/","title":"\u5168\u5c40\u9519\u8bef\u6355\u83b7","text":"<p>Net\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0<code>NetErrorHandler</code>\u63a5\u53e3\u6765\u76d1\u542c\u5168\u5c40\u9519\u8bef\u5904\u7406, \u5f53\u4f60\u901a\u8fc7<code>setErrorHandler</code>\u540eNet\u5c31\u4e0d\u4f1a\u518d\u6267\u884c\u9ed8\u8ba4\u7684\u9519\u8bef\u5904\u7406\u4e86</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n\nsetErrorHandler(object : NetErrorHandler() {\noverride fun onError(e: Throwable) {\nsuper.onError(e)\n}\n\noverride fun onStateError(e: Throwable, view: View) {\nsuper.onStateError(e, view)\n}\n})\n}\n</code></pre> \u573a\u666f \u5904\u7406\u51fd\u6570 \u5904\u7406\u65b9\u5f0f \u666e\u901a\u7f51\u7edc\u8bf7\u6c42/\u81ea\u52a8\u52a0\u8f7d\u6846 <code>onError</code> \u9ed8\u8ba4\u5410\u53f8\u9519\u8bef\u4fe1\u606f \u4f7f\u7528\u81ea\u52a8\u5904\u7406\u7f3a\u7701\u9875\u7684\u4f5c\u7528\u57df <code>onStateError</code> \u4ec5\u90e8\u5206\u9519\u8bef\u4fe1\u606f\u4f1a\u5410\u53f8, \u56e0\u4e3a\u7f3a\u7701\u9875\u4e0d\u9700\u8981\u6240\u6709\u7684\u9519\u8bef\u4fe1\u606f\u90fd\u5410\u53f8(toast)\u63d0\u793a, \u56e0\u4e3a\u9519\u8bef\u9875\u53ef\u80fd\u5df2\u7ecf\u5c55\u793a\u9519\u8bef\u4fe1\u606f, \u6240\u4ee5\u8fd9\u91cc\u4e24\u8005\u5904\u7406\u7684\u51fd\u6570\u533a\u5206. <p><code>scope/scopeLife</code>\u4e0d\u4f1a\u89e6\u53d1\u4efb\u4f55\u5168\u5c40\u9519\u8befNetErrorHandler, \u8bf7\u4f7f\u7528\u5355\u4f8b\u9519\u8bef\u5904\u7406\u65b9\u5f0f<code>catch</code>, \u56e0\u4e3a\u5176\u7528\u4e8e\u5904\u7406\u5f02\u6b65\u4efb\u52a1,\u4e0d\u5e94\u5f53\u7528\u4e8e\u7f51\u7edc\u8bf7\u6c42</p>"},{"location":"error-single/","title":"\u5355\u4f8b\u9519\u8bef\u6355\u83b7","text":"<p>\u5355\u4f8b\u6355\u83b7\u5373\u53ea\u6355\u83b7\u67d0\u4e2a\u4f5c\u7528\u57df\u6216\u8005\u63a5\u53e3, \u4e0d\u4f1a\u5f71\u54cd\u5230\u5168\u5c40</p> <ul> <li>\u6355\u83b7\u8bf7\u6c42</li> <li>\u6355\u83b7\u4f5c\u7528\u57df</li> </ul> <p></p>"},{"location":"error-single/#_1","title":"\u6355\u83b7\u8bf7\u6c42","text":"<p>\u4e00\u4e2a\u4f5c\u7528\u57df\u5185\u5e38\u5e38\u6709\u591a\u4e2a\u8bf7\u6c42\u53d1\u751f. \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u53d1\u751f\u9519\u8bef\u5c31\u4f1a\u53d6\u6d88\u5f53\u524d\u4f5c\u7528\u57df\u5185\u90e8\u6240\u6709\u534f\u7a0b, \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u6355\u83b7\u9519\u8bef\u8bf7\u6c42\u6765\u8fdb\u884c\u5176\u4ed6\u5904\u7406</p> <p>\u4f8b\u5982 <pre><code>scopeNetLife {\nGet&lt;String&gt;(\"api\").await() // \u5931\u8d25\nGet&lt;String&gt;(\"api2\").await() // \u4e0a\u9762\u5931\u8d25, \u6b64\u5904\u4e5f\u4e0d\u4f1a\u6267\u884c\n}\n</code></pre></p> <p>\u6355\u83b7\u7b2c\u4e00\u4e2a\u534f\u7a0b\u907f\u514d\u7ec8\u6b62\u540e\u7eed\u6267\u884c <pre><code>scopeNetLife {\ntry {\nGet&lt;String&gt;(\"api\").await() // \u5931\u8d25\n} catch(e:Exception) {\n}\nGet&lt;String&gt;(\"api2\").await() // \u4e0a\u9762\u5931\u8d25, \u6b64\u5904\u7ee7\u7eed\u6267\u884c\n}\n</code></pre> \u5f53\u7136\u5982\u679c\u4f60\u521b\u5efa\u4e0d\u540c\u7684\u4f5c\u7528\u57df\u5206\u522b\u8bf7\u6c42\u90a3\u662f\u4e92\u4e0d\u5f71\u54cd\u7684 <pre><code>scopeNetLife {\nGet&lt;String&gt;(\"api\").await() // \u5931\u8d25\n}\nscopeNetLife {\nGet&lt;String&gt;(\"api2\").await() // \u4e0a\u9762\u5931\u8d25, \u6b64\u5904\u5b8c\u5168\u4e0d\u53d7\u5f71\u54cd\n}\n</code></pre></p> <p></p>"},{"location":"error-single/#_2","title":"\u6355\u83b7\u4f5c\u7528\u57df","text":"<pre><code>scope {\nval data = Get&lt;String&gt;(\"http://www.thisiserror.com/\").await()\n}.catch {\n// \u534f\u7a0b\u5185\u90e8\u53d1\u751f\u9519\u8bef\u56de\u8c03, it\u4e3a\u5f02\u5e38\n}.finally {\n// \u534f\u7a0b\u5185\u534f\u7a0b\u5168\u90e8\u6267\u884c\u5b8c\u6210, it\u4e3a\u5f02\u5e38(\u5982\u679c\u662f\u6b63\u5e38\u7ed3\u675f\u5219it\u4e3anull)\n}\n</code></pre> <p>\u4ee5\u4e0b\u51fd\u6570\u5e55\u540e\u5b57\u6bb5<code>it</code>\u4e3a\u5f02\u5e38\u5bf9\u8c61, \u5982\u679c\u6b63\u5e38\u5b8c\u6210it\u5219\u4e3anull. \u5982\u679c\u5c5e\u4e8e\u8bf7\u6c42\u88ab\u624b\u52a8\u53d6\u6d88\u5219it\u4e3a<code>CancellationException</code></p> \u51fd\u6570 \u63cf\u8ff0 catch \u4f5c\u7528\u57df\u88ab<code>catch</code>\u5219\u4e0d\u4f1a\u88ab\u4f20\u9012\u5230\u5168\u5c40\u5f02\u5e38\u5904\u7406\u56de\u8c03\u4e2d: \u5168\u5c40\u5904\u7406\u5f02\u5e38, \u9664\u975e\u4f7f\u7528<code>handleError</code>\u518d\u6b21\u4f20\u9012\u7ed9\u5168\u5c40 finally \u540c\u6837\u53ef\u4ee5\u83b7\u53d6\u5230\u5f02\u5e38\u5bf9\u8c61, \u4e14\u4e0d\u5f71\u54cd\u5168\u5c40\u5f02\u5e38\u56de\u8c03\u5904\u7406"},{"location":"error-tip/","title":"\u81ea\u5b9a\u4e49\u9519\u8bef\u63d0\u793a","text":"<p>\u7f51\u7edc\u8bf7\u6c42\u53d1\u751f\u9519\u8bef\u4e00\u5b9a\u8981\u63d0\u793a\u7ed9\u7528\u6237, \u63d0\u793a\u8bed\u4e00\u822c\u60c5\u51b5\u4e0b\u662f\u53ef\u8bfb\u7684\u8bed\u4e49\u53e5</p> <p>\u5982\u679c\u4f60\u662f\u60f3\u4fee\u6539\u9ed8\u8ba4\u5410\u53f8\u7684\u9519\u8bef\u6587\u672c\u4fe1\u606f\u6216\u8005\u505a\u56fd\u9645\u5316\u8bed\u8a00\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u65b9\u6cd5</p>"},{"location":"error-tip/#_1","title":"\u521b\u5efa\u591a\u8bed\u8a00","text":"<p>\u9ed8\u8ba4\u9519\u8bef\u5904\u7406\u7684\u6587\u672c\u88ab\u5b9a\u4e49\u5728<code>strings.xml</code>\u4e2d, \u6211\u4eec\u53ef\u4ee5\u5728\u9879\u76ee\u4e2d\u521b\u5efa\u591a\u8bed\u8a00values\u6765\u521b\u5efa\u540c\u540dstring\u5b9e\u73b0\u56fd\u9645\u5316. \u6bd4\u5982\u82f1\u8bed\u662f<code>values-en</code>\u4e0b\u521b\u5efa\u6587\u4ef6<code>strings.xml</code></p> <pre><code>&lt;!--\u7f51\u7edc\u8bf7\u6c42\u5f02\u5e38--&gt;\n&lt;string name=\"net_connect_error\"&gt;\u8fde\u63a5\u7f51\u7edc\u5931\u8d25&lt;/string&gt;\n&lt;string name=\"net_networking_error\"&gt;\u5f53\u524d\u7f51\u7edc\u4e0d\u53ef\u7528&lt;/string&gt;\n&lt;string name=\"net_url_error\"&gt;\u8bf7\u6c42\u8d44\u6e90\u5730\u5740\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"net_host_error\"&gt;\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u670d\u52a1\u5668\u4e3b\u673a&lt;/string&gt;\n&lt;string name=\"net_connect_timeout_error\"&gt;\u8fde\u63a5\u670d\u52a1\u5668\u8d85\u65f6\uff0c%s&lt;/string&gt;\n&lt;string name=\"net_download_error\"&gt;\u4e0b\u8f7d\u8fc7\u7a0b\u53d1\u751f\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"net_no_cache_error\"&gt;\u8bfb\u53d6\u7f13\u5b58\u5931\u8d25&lt;/string&gt;\n&lt;string name=\"net_parse_error\"&gt;\u89e3\u6790\u6570\u636e\u65f6\u53d1\u751f\u5f02\u5e38&lt;/string&gt;\n&lt;string name=\"request_failure\"&gt;\u8bf7\u6c42\u5931\u8d25&lt;/string&gt;\n&lt;string name=\"net_request_error\"&gt;\u8bf7\u6c42\u53c2\u6570\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"net_server_error\"&gt;\u670d\u52a1\u54cd\u5e94\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"net_null_error\"&gt;\u53d1\u751f\u7a7a\u5f02\u5e38&lt;/string&gt;\n&lt;string name=\"net_error\"&gt;\u672a\u77e5\u7f51\u7edc\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"net_other_error\"&gt;\u672a\u77e5\u9519\u8bef&lt;/string&gt;\n&lt;string name=\"no_error_message\"&gt;\u65e0\u9519\u8bef\u4fe1\u606f&lt;/string&gt;\n</code></pre>"},{"location":"error-tip/#neterrorhandler","title":"\u521b\u5efaNetErrorHandler","text":"<p>\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u81ea\u5b9a\u4e49\u5168\u5c40\u9519\u8bef\u5904\u7406, \u4e0d\u8fc7\u4f60\u53ef\u4ee5\u590d\u5236\u9ed8\u8ba4\u7684\u5b9e\u73b0\u4ec5\u4fee\u6539\u4e0b\u6587\u672c\u4fe1\u606f\u5373\u53ef</p> <p></p>"},{"location":"exception-track/","title":"\u5f02\u5e38\u8ffd\u8e2a","text":"<p>Net\u4e2d\u7f51\u7edc\u8bf7\u6c42\u5bfc\u81f4\u7684\u5f02\u5e38\u90fd\u4f1a\u5728LogCat\u4e2d\u6253\u5370, \u540c\u65f6\u88ab\u5168\u5c40\u7684NetErrorHandler\u7684onError\u62e6\u622a\u5230(\u9664\u975ecatch\u4f4f)</p> <p>\u6f14\u793a\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8bf7\u6c42\u8def\u5f84 <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"https://githuberror.com/liangjingkanji/Net/\").await()\n}\n</code></pre></p> <p>\u67e5\u770bLogCat\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u5806\u6808\u4fe1\u606f, \u8fd9\u5c5e\u4e8eURL\u672a\u77e5\u5f02\u5e38</p> <p></p> <p>\u622a\u56fe\u53ef\u4ee5\u770b\u5230\u6709\u5177\u4f53\u7684URL\u548c\u8bf7\u6c42\u4ee3\u7801\u4f4d\u7f6e</p>"},{"location":"exception-track/#_1","title":"\u5173\u95ed\u65e5\u5fd7","text":"<p>\u5728\u521d\u59cb\u5316\u65f6\u5019\u53ef\u4ee5\u5173\u95ed\u65e5\u5fd7\u6253\u5370</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nsetDebug(false) // \u5173\u95ed\u65e5\u5fd7, \u6211\u4eec\u4e00\u822c\u4f7f\u7528 BuildConfig.DEBUG\n}\n</code></pre> <p>\u6216\u8005\u8bbe\u7f6e\u5b57\u6bb5<code>NetConfig.debug</code>\u7684\u503c</p>"},{"location":"fastest/","title":"\u6700\u5feb\u8bf7\u6c42\u7ed3\u679c","text":"<p>Net\u652f\u6301\u591a\u4e2a\u63a5\u53e3\u8bf7\u6c42\u5e76\u53d1, \u4ec5\u8fd4\u56de\u6700\u5feb\u7684\u8bf7\u6c42\u7ed3\u679c, \u5269\u4f59\u8bf7\u6c42\u5c06\u88ab\u81ea\u52a8\u53d6\u6d88, \u540c\u6837\u53ef\u4ee5\u7528\u4e8e\u7b5b\u9009\u6389\u65e0\u6cd5\u54cd\u5e94\u7684\u57df\u540d </p> <p>\u63a5\u53e3\u8bf7\u6c42\u9519\u8bef\u88ab\u5ffd\u7565(LogCat\u4f9d\u7136\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u4fe1\u606f), \u4f46\u5982\u679c\u6240\u6709\u8bf7\u6c42\u5168\u90e8\u5f02\u5e38\u5219\u629b\u51fa\u6700\u540e\u4e00\u4e2a\u8bf7\u6c42\u7684\u5f02\u5e38\u4f5c\u4e3a\u9519\u8bef\u5904\u7406</p> <p>\u793a\u4f8b <pre><code>scopeNetLife {\n\n// \u540c\u65f6\u53d1\u8d77\u56db\u4e2a\u7f51\u7edc\u8bf7\u6c42\nval deferred = Get&lt;String&gt;(\"api0\") // \u9519\u8bef\u63a5\u53e3\nval deferred1 = Get&lt;String&gt;(\"api1\") // \u9519\u8bef\u63a5\u53e3\nval deferred2 = Get&lt;String&gt;(\"api\")\nval deferred3 = Post&lt;String&gt;(\"api\")\n\n// \u53ea\u8fd4\u56de\u6700\u5feb\u7684\u8bf7\u6c42\u7ed3\u679c\ntvFragment.text = fastest(deferred, deferred1, deferred2, deferred3)\n}\n</code></pre></p>"},{"location":"fastest/#_1","title":"\u53d6\u6d88\u5269\u4f59","text":"<p>\u4e0a\u9762\u7684\u793a\u4f8b\u4ee3\u7801\u5b9e\u9645\u4e0a\u4e0d\u4f1a\u5728\u83b7\u53d6\u5230\u6700\u5feb\u7684\u7ed3\u679c\u540e\u81ea\u52a8\u53d6\u6d88\u8bf7\u6c42, \u6211\u4eec\u9700\u8981<code>setGroup()</code>\u624d\u53ef\u4ee5</p> <pre><code>scopeNetLife {\n// \u540c\u65f6\u53d1\u8d77\u56db\u4e2a\u7f51\u7edc\u8bf7\u6c42\nval deferred2 = Get&lt;String&gt;(\"api\") { setGroup(\"\u6700\u5feb\") }\nval deferred3 = Post&lt;String&gt;(\"api\") { setGroup(\"\u6700\u5feb\") }\nval deferred = Get&lt;String&gt;(\"api0\") { setGroup(\"\u6700\u5feb\") } // \u9519\u8bef\u63a5\u53e3\nval deferred1 = Get&lt;String&gt;(\"api1\") { setGroup(\"\u6700\u5feb\") } // \u9519\u8bef\u63a5\u53e3\n\n// \u53ea\u8fd4\u56de\u6700\u5feb\u7684\u8bf7\u6c42\u7ed3\u679c\ntvFragment.text = fastest(listOf(deferred, deferred1, deferred2, deferred3), \"\u6700\u5feb\")\n}\n</code></pre> <p>\u7f51\u7edc\u8bf7\u6c42\u7684\u53d6\u6d88\u672c\u8d28\u4e0a\u4f9d\u9760<code>group</code>\u6765\u8fa8\u522b,\u5982\u679c\u4f7f\u7528<code>setGroup</code>\u51fd\u6570\u8bbe\u7f6e\u5206\u7ec4\u540d\u79f0\u5c31\u53ef\u4ee5\u5728\u8fd4\u56de\u6700\u5feb\u7ed3\u679c\u540e\u53d6\u6d88\u6389\u5176\u4ed6\u7f51\u7edc\u8bf7\u6c42, \u53cd\u4e4b\u4e0d\u4f1a\u53d6\u6d88\u5176\u4ed6\u7f51\u7edc\u8bf7\u6c42 </p> <p>group\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b\u4efb\u4f55\u503c, \u53ea\u6709\u8bf7\u6c42\u7684<code>setGroup</code>\u53c2\u6570\u548c<code>fastest</code>\u51fd\u6570\u7684group\u53c2\u6570\u7b49\u4e8e\u5373\u53ef</p> <p></p>"},{"location":"fastest/#_2","title":"\u7c7b\u578b\u4e0d\u4e00\u81f4","text":"<p>\u5047\u8bbe\u5e76\u53d1\u7684\u63a5\u53e3\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u540c  \u6216\u8005\u60f3\u8981\u76d1\u542c\u6700\u5feb\u8bf7\u6c42\u8fd4\u56de\u7684\u7ed3\u679c\u56de\u8c03\u8bf7\u4f7f\u7528<code>transform</code>\u51fd\u6570</p> <pre><code>scopeNetLife {\n\nval fastest = Post&lt;String&gt;(\"api\").transform {\nLog.d(\"\u65e5\u5fd7\", \"Post\") // \u5982\u679c\u8be5\u63a5\u53e3\u6700\u5feb\u5219\u4f1a\u56de\u8c03\u8fd9\u91cc\nit // \u8fd9\u91cc\u53ef\u4ee5\u8fd4\u56de\u5176\u4ed6\u6570\u636e\u7ed3\u679c\n}\n\nval fastest2 = Get&lt;String&gt;(\"api\").transform {\nLog.d(\"\u65e5\u5fd7\", \"Get\") // \u5982\u679c\u8be5\u63a5\u53e3\u6700\u5feb\u5219\u4f1a\u56de\u8c03\u8fd9\u91cc\nit\n}\n\ntvFragment.text = fastest(fastest, fastest2)\n}\n</code></pre> <p>\u6709\u7684\u573a\u666f\u4e0b\u5e76\u53d1\u7684\u63a5\u53e3\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u540c, \u4f46\u662ffastest\u53ea\u80fd\u8fd4\u56de\u4e00\u4e2a\u7c7b\u578b, \u6211\u4eec\u53ef\u4ee5\u4f7f<code>transform</code>\u7684\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\u90fd\u62e5\u6709\u4e00\u4e2a\u5171\u540c\u7684\u63a5\u53e3, \u7136\u540e\u53bb\u7c7b\u578b\u5224\u65ad</p> <p></p> <p>\u53ea\u6709\u6700\u5feb\u8fd4\u56de\u7ed3\u679c\u7684\u7f51\u7edc\u8bf7\u6c42(\u6216\u5f02\u6b65\u4efb\u52a1)\u7684<code>transform</code>\u56de\u8c03\u624d\u4f1a\u88ab\u6267\u884c\u5230</p>"},{"location":"fastest/#fastest","title":"\u6355\u83b7Fastest","text":"<pre><code>scopeNetLife {\nval task = Get&lt;String&gt;(\"api2\")\nval task1 = Get&lt;String&gt;(\"api2\")\nval task2 = Get&lt;String&gt;(\"api2\")\n\nval data = try {\nfastest(task, task1, task2) // \u5f53 task/task1/task2 \u5168\u90e8\u5f02\u5e38\u4e4b\u540e\u518d\u5e76\u53d1\u6267\u884c backupTask/backupTask1\n} catch (e: Exception) {\nval backupTask = Get&lt;String&gt;(\"api2\")\nval backupTask1 = Get&lt;String&gt;(\"api\")\nfastest(backupTask, backupTask1)\n}\n}\n</code></pre> <p>\u4e0d\u8981\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u53d6\u4ee3CDN\u52a0\u901f</p>"},{"location":"https/","title":"Https\u8bc1\u4e66","text":"<p>Https\u8bbf\u95ee\u4e3b\u8981\u5c31\u662f\u8bc1\u4e66\u914d\u7f6e\u95ee\u9898, Net\u53ef\u4ee5\u4f7f\u7528OkHttp\u4e00\u5207\u51fd\u6570\u7ec4\u4ef6, \u4e14\u7b80\u5316\u8bc1\u4e66\u914d\u7f6e\u6d41\u7a0b</p> <p>OkHttp\u5982\u4f55\u914d\u7f6e\u8bc1\u4e66, Net\u5c31\u53ef\u4ee5\u5982\u4f55\u914d\u7f6e\u8bc1\u4e66</p>"},{"location":"https/#ca","title":"\u4f7f\u7528CA\u8bc1\u4e66","text":"<p>Https\u5982\u679c\u662f\u4f7f\u7528\u7684CA\u9881\u53d1\u7684\u8bc1\u4e66, \u4e0d\u9700\u8981\u4efb\u4f55\u914d\u7f6eNet\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee</p> <pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\").await()\n}\n</code></pre>"},{"location":"https/#_1","title":"\u4fe1\u4efb\u6240\u6709\u8bc1\u4e66","text":"<p>\u4fe1\u4efb\u6240\u6709\u8bc1\u4e66\u53ef\u4ee5\u89e3\u51b3\u65e0\u6cd5\u8bbf\u95ee\u79c1\u6709\u8bc1\u4e66\u7684Https\u5730\u5740\u95ee\u9898, \u4f46\u662f\u8fd9\u4e48\u505a\u5c31\u5931\u53bb\u4e86\u4f7f\u7528\u8bc1\u4e66\u7684\u542b\u4e49, \u4e0d\u5efa\u8bae\u6b64\u505a\u6cd5</p> \u5168\u5c40\u914d\u7f6e <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this){\ntrustSSLCertificate() // \u4fe1\u4efb\u6240\u6709\u8bc1\u4e66\n}\n</code></pre> \u5355\u4f8b\u914d\u7f6e <pre><code>scopeNetLife {\nGet&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\"){\nsetClient {\ntrustSSLCertificate()\n}\n}.await()\n}\n</code></pre>"},{"location":"https/#_2","title":"\u5bfc\u5165\u8bc1\u4e66","text":"<p>\u79c1\u6709\u8bc1\u4e66\u53ef\u4ee5\u653e\u5230\u4efb\u4f55\u4f4d\u7f6e, \u53ea\u8981\u80fd\u8bfb\u53d6\u5230<code>InputStream</code>\u6d41\u5bf9\u8c61\u5373\u53ef</p> \u5168\u5c40\u914d\u7f6e <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nval privateCertificate = resources.assets.open(\"https.certificate\")\nsetSSLCertificate(privateCertificate)\n}\n</code></pre> \u5355\u4f8b\u914d\u7f6e <pre><code>scopeNetLife {\nGet&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\") {\nsetClient {\nval privateCertificate = resources.assets.open(\"https.certificate\") // \u8fd9\u91cc\u7684\u8bc1\u4e66\u662f\u653e\u5230\u5e94\u7528\u7684\u8d44\u4ea7\u76ee\u5f55\u4e0b\nsetSSLCertificate(privateCertificate)\n}\n}.await()\n}\n</code></pre>"},{"location":"interceptor/","title":"\u62e6\u622a\u5668","text":"<p>\u603b\u5171\u652f\u6301\u4e24\u79cd\u62e6\u622a\u5668</p> <ol> <li><code>Interceptor</code>, \u652f\u6301\u5e02\u9762\u4e0a\u7684\u6240\u6709OkHttp\u62e6\u622a\u5668\u7ec4\u4ef6\u5e93, \u66f4\u65b9\u4fbf\u4fee\u6539\u8bf7\u6c42/\u54cd\u5e94\u4fe1\u606f, \u53ef\u4ee5\u8f6c\u53d1\u8bf7\u6c42</li> <li><code>RequestInterceptor</code>, \u90e8\u5206\u573a\u666f\u66f4\u7b80\u5355\u6613\u7528\u7684\u8f7b\u91cf\u62e6\u622a\u5668, \u66f4\u65b9\u4fbf\u6dfb\u52a0\u5168\u5c40\u8bf7\u6c42\u5934/\u53c2\u6570, \u65e0\u6cd5\u8f6c\u53d1\u8bf7\u6c42 </li> </ol> <p>\u5b9e\u9645\u9879\u76ee\u4e2d\u53ef\u80fd\u5b58\u5728\u9700\u6c42\u52a0\u5bc6\u8bf7\u6c42/\u89e3\u5bc6\u54cd\u5e94, \u975e\u5e38\u4e0d\u5efa\u8bae\u5c01\u88c5Post/Get\u7b49\u8bf7\u6c42\u52a8\u4f5c(\u4f4e\u6269\u5c55\u6027/\u589e\u52a0\u5b66\u4e60\u6210\u672c), \u4efb\u4f55\u9879\u76ee\u9700\u6c42\u90fd\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u548c\u8f6c\u6362\u5668\u5b9e\u73b0  \u5e38\u89c1\u62e6\u622a\u5668\u793a\u4f8b</p>"},{"location":"interceptor/#_1","title":"\u62e6\u622a\u5668","text":"<p>\u6dfb\u52a0\u62e6\u622a\u5668</p> <pre><code>class App : Application() {\noverride fun onCreate() {\nsuper.onCreate()\n\nNetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\naddInterceptor(RefreshTokenInterceptor())\n}\n}\n}\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u7b80\u5355\u6f14\u793a\u5ba2\u6237\u7aef\u81ea\u52a8\u5237\u65b0token\u62e6\u622a\u5668</p> <pre><code>/**\n * \u6f14\u793a\u5982\u4f55\u81ea\u52a8\u5237\u65b0token\u4ee4\u724c\n */\nclass RefreshTokenInterceptor : Interceptor {\noverride fun intercept(chain: Interceptor.Chain): Response {\nval request = chain.request()\nval response = chain.proceed(request) // \u5982\u679ctoken\u5931\u6548\n\nreturn synchronized(RefreshTokenInterceptor::class.java) {\nif (response.code == 401 &amp;&amp; UserConfig.isLogin &amp;&amp; !request.url.pathSegments.contains(\"token\")) {\nval json = Net.get(\"token\").execute&lt;String&gt;() // \u540c\u6b65\u5237\u65b0token\nUserConfig.token = JSONObject(json).optString(\"token\")\nchain.proceed(request)\n} else {\nresponse\n}\n}\n}\n}\n</code></pre>"},{"location":"interceptor/#_2","title":"\u8bf7\u6c42\u62e6\u622a\u5668","text":"<p>RequestInterceptor\u5c5e\u4e8e\u8f7b\u91cf\u7ea7\u7684\u8bf7\u6c42\u62e6\u622a\u5668, \u5728\u6bcf\u6b21\u8bf7\u6c42\u7684\u65f6\u5019\u8be5\u62e6\u622a\u5668\u90fd\u4f1a\u88ab\u89e6\u53d1(\u65e0\u6cd5\u4fee\u6539\u54cd\u5e94\u4fe1\u606f), \u65b9\u4fbf\u6dfb\u52a0\u5168\u5c40\u8bf7\u6c42\u5934/\u53c2\u6570</p> <p>\u793a\u4f8b</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nsetRequestInterceptor(object : RequestInterceptor {\noverride fun interceptor(request: BaseRequest) {\nrequest.param(\"client\", \"Net\")\nrequest.setHeader(\"token\", \"123456\")\n}\n})\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230<code>setRequestInterceptor</code>\u662fset\u5f00\u5934. \u4ec5\u652f\u6301\u4e00\u4e2a\u8bf7\u6c42\u62e6\u622a\u5668, \u4e0d\u50cf<code>addInterceptor</code>\u652f\u6301\u591a\u4e2a\u8bf7\u6c42\u62e6\u622a\u5668</p>"},{"location":"interval/","title":"\u8f6e\u8be2\u5668/\u5012\u8ba1\u65f6","text":"<p>\u8f6e\u8be2\u5668(\u8ba1\u65f6\u5668)\u5c5e\u4e8e\u9879\u76ee\u4e2d\u5e38\u89c1\u9700\u6c42, \u800c\u672c\u6846\u67b6\u62e5\u6709\u975e\u5e38\u5f3a\u5927\u7684\u8f6e\u8be2\u5668\u5de5\u5177. \u652f\u6301\u4ee5\u4e0b\u7279\u6027</p> <ul> <li>\u6b63\u8ba1\u65f6</li> <li>\u5012\u8ba1\u65f6</li> <li>\u6307\u5b9a\u6b21\u6570</li> <li>\u652f\u6301\u5f00\u59cb/\u505c\u6b62/\u6682\u505c/\u7ee7\u7eed/\u91cd\u7f6e/\u5207\u6362\u5f00\u5173</li> <li>\u4ec5\u9875\u9762\u663e\u793a\u65f6\u8ba1\u65f6</li> <li>\u9875\u9762\u9500\u6bc1\u81ea\u52a8\u53d6\u6d88</li> </ul> <p></p> \u6307\u5b9a\u8f6e\u5faa\u6b21\u6570/\u95f4\u9694 <pre><code>interval = Interval(100, 1, TimeUnit.SECONDS).life(this) // \u81ea\u5b9a\u4e49\u8ba1\u6570\u5668\u4e2a\u6570\u7684\u8f6e\u8be2\u5668\n</code></pre> \u4ec5\u8f6e\u5faa\u95f4\u9694 <pre><code> interval = Interval(1, TimeUnit.SECONDS) // \u6bcf\u79d2\u56de\u8c03\u4e00\u6b21, \u4e0d\u4f1a\u81ea\u52a8\u7ed3\u675f\n</code></pre> \u5012\u8ba1\u65f6 <pre><code>// \u5012\u8ba1\u65f6\u8f6e\u8be2\u5668, \u5f53[start]]\u6bd4[end]\u503c\u5927, \u4e14end\u4e0d\u7b49\u4e8e-1\u65f6, \u5373\u4e3a\u5012\u8ba1\u65f6\ninterval = Interval(1, 1, TimeUnit.SECONDS, 5).life(this)\n</code></pre> <p>\u76d1\u542c\u8f6e\u8be2\u5668 <pre><code>interval.subscribe {\ntvFragment.text = it.toString()\n}.finish {\ntvFragment.text = \"\u8ba1\u65f6\u5b8c\u6210\" // \u6700\u540e\u4e00\u4f4d\u6570\u65f6\u540c\u65f6\u56de\u8c03 subscribe/finish\n}.start()\n</code></pre></p> Interval\u51fd\u6570 \u63cf\u8ff0 start \u5f00\u59cb\u8f6e\u8be2\u5668 stop \u505c\u6b62 cancel \u53d6\u6d88, \u533a\u522b\u4e8estop, \u6b64\u51fd\u6570\u6267\u884c\u540e\u5e76\u4e0d\u4f1a\u56de\u8c03finish pause \u6682\u505c resume \u7ee7\u7eed reset \u91cd\u7f6e switch \u5207\u6362\u5f00\u5173 subscribe \u6bcf\u6b21\u8ba1\u65f6\u90fd\u4f1a\u6267\u884c\u8be5\u56de\u8c03 finish \u5f53\u8ba1\u65f6\u5668\u5b8c\u6210\u65f6\u6267\u884c\u8be5\u56de\u8c03, \u6267\u884cstop\u540e\u4e5f\u4f1a\u56de\u8c03 life \u6307\u5b9a\u751f\u547d\u5468\u671f\u81ea\u52a8\u53d6\u6d88\u8f6e\u8be2\u5668 onlyResumed \u5f53\u754c\u9762\u4e0d\u53ef\u89c1\u65f6\u6682\u505c, \u5f53\u754c\u9762\u53ef\u89c1\u65f6\u7ee7\u7eed <p>\u5b8c\u6574\u6e90\u7801</p>"},{"location":"issues/","title":"Issues","text":""},{"location":"issues/#_1","title":"\u5e38\u89c1\u95ee\u9898","text":"<ul> <li>networkSecurityConfig\u5bfc\u81f4\u65e0\u6cd5\u6253\u5305</li> <li>\u6ca1\u6709\u6211\u9700\u8981\u7684\u8bf7\u6c42\u53c2\u6570\u7c7b\u578b</li> <li>\u6ca1\u6709\u6211\u9700\u8981\u7684\u529f\u80fd</li> <li>\u4f7f\u7528inline reified\u5c01\u88c5\u8bf7\u6c42\u51fd\u6570\u5bfc\u81f4\u5d29\u6e83</li> <li>\u9519\u8bef\u63d0\u793a toast \u5185\u5b58\u6cc4\u6f0f</li> <li>\u5982\u4f55\u4f7f\u7528Cookie</li> </ul>"},{"location":"kotlin-serialization/","title":"kotlin-serialization","text":"<ol> <li> <p>\u4eceNet3\u5f00\u59cb\u652f\u6301\u4f7f\u7528kotlin-serialization(\u4ee5\u4e0b\u7b80\u79f0ks)</p> </li> <li> <p>\u66f4\u591a\u4f7f\u7528\u6559\u7a0b\u8bf7\u9605\u8bfb: Kotlin\u6700\u5f3a\u89e3\u6790\u5e93 - kotlin-serialization</p> </li> </ol> <p></p>"},{"location":"kotlin-serialization/#kotlin-serialization","title":"kotlin-serialization \u7279\u70b9","text":"<ul> <li>kotlin\u5b98\u65b9\u5e93</li> <li>\u52a8\u6001\u6570\u636e\u7c7b\u578b\u89e3\u6790</li> <li>\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u5668</li> <li>\u652f\u6301ProtoBuf/JSON\u7b49\u6570\u636e\u7ed3\u6784\u5e8f\u5217\u5316</li> <li>\u975e\u7a7a\u8986\u76d6(\u5373\u8fd4\u56de\u7684Json\u5b57\u6bb5\u4e3anull\u5219\u4f7f\u7528\u6570\u636e\u7c7b\u9ed8\u8ba4\u503c)</li> <li>\u542f\u7528\u5bbd\u677e\u6a21\u5f0f, Json\u548c\u6570\u636e\u7c7b\u5b57\u6bb5\u65e0\u9700\u4e00\u81f4</li> <li>\u89e3\u6790\u4efb\u4f55\u7c7b\u578b(Map/List/Pair...)</li> </ul> <p>ks\u7684\u6570\u636e\u6a21\u578b\u7c7b\u90fd\u8981\u6c42\u4f7f\u7528\u6ce8\u89e3<code>@Serializable</code>(\u9664\u975e\u81ea\u5b9a\u4e49\u89e3\u6790\u8fc7\u7a0b), \u7236\u7c7b\u548c\u5b50\u7c7b\u90fd\u9700\u8981\u4f7f\u7528  \u4e00\u822c\u5f00\u53d1\u4e2d\u90fd\u662f\u4f7f\u7528\u63d2\u4ef6\u751f\u6210\u6570\u636e\u6a21\u578b, \u6240\u4ee5\u8fd9\u5e76\u4e0d\u4f1a\u589e\u52a0\u5de5\u4f5c\u91cf. \u5373\u4f7f\u624b\u5199\u4e5f\u53ea\u662f\u4e00\u4e2a\u6ce8\u89e3, \u4f46\u662f\u53ef\u4ee5\u5e26\u6765\u9ed8\u8ba4\u503c\u652f\u6301\u548c\u66f4\u5b89\u5168\u7684\u6570\u636e\u89e3\u6790</p>"},{"location":"kotlin-serialization/#_1","title":"\u4f9d\u8d56","text":"<p>\u9879\u76ee build.gradle</p> <pre><code>classpath \"org.jetbrains.kotlin:kotlin-serialization:$kotlin_version\"\n// \u548cKotlin\u63d2\u4ef6\u540c\u4e00\u4e2a\u7248\u672c\u53f7\u5373\u53ef\n</code></pre> <p>module build.gradle</p> <pre><code>apply plugin: \"kotlin-kapt\"\napply plugin: 'kotlinx-serialization'\nimplementation \"org.jetbrains.kotlinx:kotlinx-serialization-json:1.3.0\"\n</code></pre>"},{"location":"kotlin-serialization/#_2","title":"\u914d\u7f6e\u8f6c\u6362\u5668","text":"<p>\u8fd9\u91cc\u4f7f\u7528Demo\u4e2d\u7684SerializationConvert\u4f5c\u6f14\u793a. \u5982\u679c\u4f60\u4e1a\u52a1\u6709\u7279\u6b8a\u9700\u8981\u53ef\u4ee5\u590d\u5236Demo\u4e2d\u7684\u8f6c\u6362\u5668\u4ee3\u7801\u7a0d\u52a0\u4fee\u6539</p> \u5168\u5c40\u914d\u7f6e <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\nsetConverter(SerializationConvert())\n// ... \u5176\u4ed6\u914d\u7f6e\n}\n</code></pre> \u5355\u4f8b\u914d\u7f6e <pre><code>val userList = Get&lt;List&lt;UserModel&gt;&gt;(\"list\") {\nconverter = SerializationConvert() // \u5355\u4f8b\u8f6c\u6362\u5668, \u6b64\u65f6\u4f1a\u5ffd\u7565\u5168\u5c40\u8f6c\u6362\u5668\n}.await()\n</code></pre>"},{"location":"kotlin-serialization/#_3","title":"\u4f7f\u7528","text":"<pre><code>scopeNetLife {\n// \u8fd9\u91cc\u540e\u7aef\u76f4\u63a5\u8fd4\u56de\u7684Json\u6570\u7ec4\nval userList = Get&lt;List&lt;UserModel&gt;&gt;(\"list\") {\nconverter = SerializationConvert()\n}.await()\n\ntvFragment.text = userList[0].name\n}\n</code></pre> <pre><code>@Serializable\ndata class UserModel(var name: String, var age: Int, var height: Int)\n</code></pre> <p>\u5177\u4f53\u89e3\u6790\u8fd4\u56de\u7684JSON\u4e2d\u7684\u67d0\u4e2a\u5b57\u6bb5\u8bf7\u5728\u8f6c\u6362\u5668\u91cc\u9762\u81ea\u5b9a, \u5176\u6ce8\u610f\u5982\u679c\u5b58\u5728\u7236\u7c7b, \u7236\u7c7b\u548c\u5b50\u7c7b\u90fd\u9700\u8981\u4f7f\u7528<code>@Serializable</code>\u6ce8\u89e3\u4fee\u9970  \u5982\u679c\u60f3\u8be6\u7ec6\u4e86\u89e3KS, \u8bf7\u9605\u8bfb\u6587\u7ae0: Kotlin\u6700\u5f3a\u89e3\u6790\u5e93 - kotlin-serialization</p>"},{"location":"kotlin-serialization/#_4","title":"\u5e38\u7528\u914d\u7f6e","text":"<p>\u4ee5\u4e0b\u4e3a\u53cd\u5e8f\u5217\u5316Json\u5e38\u7528\u914d\u7f6e</p> <pre><code>val jsonDecoder = Json {\nignoreUnknownKeys = true // \u6570\u636e\u7c7b\u53ef\u4ee5\u4e0d\u7528\u58f0\u660eJson\u7684\u6240\u6709\u5b57\u6bb5\ncoerceInputValues = true // \u5982\u679cJson\u5b57\u6bb5\u662fNull\u5219\u4f7f\u7528\u6570\u636e\u7c7b\u5b57\u6bb5\u9ed8\u8ba4\u503c\n}\n</code></pre> <p>\u6570\u636e\u7c7b\u4f7f\u7528\u9ed8\u8ba4\u503c <pre><code>@Serializable\ndata class Data(var name:String = \"\", var age:Int = 0)\n</code></pre></p> <p>\u5efa\u8bae\u4e3a\u6570\u636e\u7c7b\u6240\u6709\u5b57\u6bb5\u8bbe\u7f6e\u9ed8\u8ba4\u503c, \u907f\u514d\u540e\u7aef\u6570\u636e\u7f3a\u5931\u5bfc\u81f4\u89e3\u6790\u5f02\u5e38, \u4e5f\u51cf\u5c11\u9891\u7e41\u5224\u7a7a\u64cd\u4f5c</p>"},{"location":"kotlin-serialization/#_5","title":"\u542f\u7528\u9ed8\u8ba4\u503c","text":"<p>\u5f53<code>coerceInputValues = true</code>\u65f6, json\u5b57\u6bb5\u4e3anull\u6570\u636e\u7c7b\u5b57\u6bb5\u4e3a\u975e\u7a7a\u7c7b\u578b\u60c5\u51b5\u4e0b\u91c7\u7528\u5b57\u6bb5\u9ed8\u8ba4\u503c, \u6ca1\u6709\u9ed8\u8ba4\u503c\u8bf7<code>explicitNulls = false</code>\u5219\u8d4b\u503c\u4e3anull</p> <p>\u540c\u65f6\u5f53\u51fa\u73b0\u672a\u77e5\u7684\u679a\u4e3e\u7c7b\u578b\u4e5f\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u503c</p>"},{"location":"kotlin-serialization/#_6","title":"\u5b57\u6bb5\u7f3a\u5931","text":"<p>\u901a\u8fc7<code>explicitNulls</code>\u6765\u914d\u7f6e\u5b57\u6bb5\u7f3a\u65f6\u5904\u7406\u65b9\u5f0f</p> <ul> <li>\u53cd\u5e8f\u5217\u5316\u65f6, \u5982\u679c\u6570\u636e\u7c7b\u7f3a\u5931\u5b57\u6bb5, \u4f7f\u7528<code>ignoreUnknownKeys = true</code>\u5c31\u4f1a\u81ea\u52a8\u4f7f\u7528\u9ed8\u8ba4\u503c, \u6ca1\u6709\u9ed8\u8ba4\u503c\u8bf7<code>explicitNulls = false</code>\u8d4b\u503c\u4e3anull</li> <li>\u5e8f\u5217\u5316\u65f6, \u6570\u636e\u7c7b\u5982\u679c\u5b57\u6bb5\u4e3anull\u4e5f\u4f1a\u88ab\u8d4b\u503c\u5230json\u4e2d, <code>explicitNulls = false</code>\u53ef\u4ee5\u5ffd\u7565\u6389</li> </ul>"},{"location":"kotlin-serialization/#_7","title":"\u81ea\u52a8\u751f\u6210","text":"<p>\u624b\u52a8\u5199\u9ed8\u8ba4\u503c\u592a\u9ebb\u70e6, \u63a8\u8350\u4f7f\u7528\u63d2\u4ef6\u751f\u6210\u9ed8\u8ba4\u503c</p> <p></p> <p>\u63d2\u4ef6\u5177\u4f53\u914d\u7f6e\u4f7f\u7528\u8bf7\u67e5\u770b: \u6570\u636e\u6a21\u578b\u751f\u6210\u63d2\u4ef6</p>"},{"location":"log-notice/","title":"\u901a\u77e5\u680f\u65e5\u5fd7","text":"<p>\u524d\u9762\u4ecb\u7ecd\u8fc7\u5982\u4f55\u4f7f\u7528AndroidStudio\u6765\u6293\u53d6\u7f51\u7edc\u65e5\u5fd7. \u4f46\u662f\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5728App\u4f7f\u7528\u8fc7\u7a0b\u6216\u8005\u8ba9\u6d4b\u8bd5\u4eba\u5458\u67e5\u770b\u65e5\u5fd7</p> <p>\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e2a\u7b2c\u4e09\u65b9\u65e5\u5fd7\u62e6\u622a\u5668chucker, \u4ed6\u4f1a\u5728Net\u53d1\u8d77\u8bf7\u6c42\u540e\u81ea\u52a8\u5728\u8bbe\u5907\u901a\u77e5\u680f\u663e\u793a\u7f51\u7edc\u8bf7\u6c42\u8bb0\u5f55, \u70b9\u51fb\u901a\u77e5\u53ef\u4ee5\u8df3\u8f6c\u8be6\u60c5</p> <p></p> <p>\u6dfb\u52a0\u4f9d\u8d56</p> <pre><code>implementation \"com.github.chuckerteam.chucker:library:3.5.2\"\n</code></pre> <p>\u6dfb\u52a0\u62e6\u622a\u5668</p> <pre><code>class App : Application() {\n\noverride fun onCreate() {\nsuper.onCreate()\n\nNetConfig.initialize(\"https://github.com/liangjingkanji/\", this) {\n// ...\nif (BuildConfig.DEBUG) {\naddInterceptor(\nChuckerInterceptor.Builder(this@App)\n.collector(ChuckerCollector(this@App))\n.maxContentLength(250000L)\n.redactHeaders(emptySet())\n.alwaysReadResponseBody(false)\n.build()\n)\n}\n}\n}\n</code></pre> <p>\u66f4\u591a\u81ea\u5b9a\u4e49\u529f\u80fd\u8bf7\u67e5\u770bchucker\u4e3b\u9875</p>"},{"location":"log-recorder/","title":"\u65e5\u5fd7\u63d2\u4ef6","text":"<p>\u7531\u4e8eLogCat\u65e5\u5fd7\u53ef\u8bfb\u6027\u5dee, \u6240\u4ee5Net\u652f\u6301\u4ee5\u4e0b\u4e24\u79cd\u65b9\u6848</p> <ol> <li> <p>\u4f7f\u7528AndroidStudio\u7684Profiler\u76d1\u542c\u7f51\u7edc</p> <ul> <li>\u53ef\u4ee5\u67e5\u770b\u9879\u76ee\u6240\u6709OkHttp\u6846\u67b6\u53d1\u8d77\u7684\u7f51\u7edc\u8bf7\u6c42</li> <li>\u7f51\u7edc\u8bf7\u6c42\u662f\u52a8\u6001\u66f2\u7ebf\u56fe, \u67e5\u4e0d\u592a\u65b9\u4fbf</li> <li>\u542f\u52a8\u5e94\u7528\u65f6\u7acb\u523b\u89e6\u53d1\u7684\u8bf7\u6c42\u65e0\u6cd5\u6355\u6349</li> </ul> <p></p> </li> <li> <p>\u5b89\u88c5Okhttp Profiler\u63d2\u4ef6  (\u63a8\u8350)</p> <ul> <li>\u5217\u8868\u663e\u793a\u8bf7\u6c42</li> <li>\u8981\u6c42\u6dfb\u52a0Net\u7684<code>LogRecordInterceptor</code>\u62e6\u622a\u5668</li> <li>\u5b9e\u9645\u4e0a\u662f\u63d2\u4ef6\u6355\u83b7logCat\u751f\u6210\u7684\u65e5\u5fd7, \u7ebf\u4e0a\u73af\u5883\u9700\u8981\u5173\u95ed</li> </ul> </li> </ol>"},{"location":"log-recorder/#_1","title":"\u6dfb\u52a0\u65e5\u5fd7\u62e6\u622a\u5668","text":"<pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\naddInterceptor(LogRecordInterceptor(BuildConfig.DEBUG))\n}\n</code></pre> \u6784\u9020\u53c2\u6570 \u63cf\u8ff0 enabled \u662f\u5426\u542f\u7528\u65e5\u5fd7 requestByteCount \u8bf7\u6c42\u65e5\u5fd7\u4fe1\u606f\u6700\u5927\u5b57\u8282\u6570, \u9ed8\u8ba41MB responseByteCount \u54cd\u5e94\u65e5\u5fd7\u4fe1\u606f\u6700\u5927\u5b57\u8282\u6570, \u9ed8\u8ba44MB <p>\u8fd9\u6837\u4f1a\u53ef\u4ee5\u5728LogCat\u770b\u5230\u65e5\u5fd7\u8f93\u51fa, \u4f46\u662f\u6211\u4eec\u8981\u4f7f\u7528\u63d2\u4ef6\u9884\u89c8\u5c31\u9700\u8981\u7b2c 2 \u6b65</p>"},{"location":"log-recorder/#_2","title":"\u5b89\u88c5\u63d2\u4ef6","text":""},{"location":"log-recorder/#1","title":"1. \u5b89\u88c5\u63d2\u4ef6","text":"<p>\u5728\u63d2\u4ef6\u5e02\u573a\u641c\u7d22: \"<code>Okhttp Profiler</code>\"</p> <p></p>"},{"location":"log-recorder/#2","title":"2. \u6253\u5f00\u7a97\u53e3","text":"<p>\u5b89\u88c5\u4ee5\u540e\u5728AndroidStudio\u53f3\u4e0b\u89d2\u6253\u5f00\u7a97\u53e3</p> <p></p> <p>\u8bf7\u5728\u6bcf\u6b21\u4f7f\u7528\u524d\u90fd\u5148\u6253\u5f00\u63d2\u4ef6\u7a97\u53e3, \u5982\u679c\u6709\u5ef6\u8fdf\u6216\u8005\u4e0d\u663e\u793a\u5c31\u53cd\u590d\u6253\u5f00\u4e0b\u7a97\u53e3</p> <p>\u4f7f\u7528\u6548\u679c</p> <p></p> \u6807\u9898 \u63cf\u8ff0 Device \u9009\u62e9\u8c03\u8bd5\u8bbe\u5907 Process \u9009\u62e9\u5c55\u793a\u8bb0\u5f55\u7684\u8fdb\u7a0b  \u6293\u53d6 \u4e00\u822c\u60c5\u51b5\u4e0d\u9700\u8981\u4f7f\u7528, \u5047\u8bbe\u6ca1\u6709\u53ca\u65f6\u66f4\u65b0\u8bf7\u70b9\u51fb\u56fe\u6807  \u6e05\u7a7a \u6e05\u7a7a\u8bb0\u5f55"},{"location":"log-recorder/#_3","title":"\u81ea\u5b9a\u4e49\u65e5\u5fd7(\u89e3\u5bc6)","text":"<p>\u901a\u8fc7\u7ee7\u627f<code>LogRecordInterceptor</code>\u53ef\u4ee5\u8986\u5199\u51fd\u6570\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u65e5\u5fd7\u8f93\u51fa\u903b\u8f91</p> <ol> <li>\u5982\u679c\u4f60\u7684\u8bf7\u6c42\u4f53\u662f\u88ab\u52a0\u5bc6\u7684\u5185\u5bb9, \u4f60\u53ef\u4ee5\u901a\u8fc7\u8986\u5199<code>requestString</code>\u51fd\u6570\u8fd4\u56de\u89e3\u5bc6\u540e\u7684\u8bf7\u6c42\u4fe1\u606f</li> <li>\u5982\u679c\u4f60\u7684\u54cd\u5e94\u4f53\u662f\u88ab\u52a0\u5bc6\u7684\u5185\u5bb9, \u4f60\u53ef\u4ee5\u901a\u8fc7\u8986\u5199<code>responseString</code>\u51fd\u6570\u8fd4\u56de\u89e3\u5bc6\u540e\u7684\u54cd\u5e94\u4fe1\u606f</li> </ol> <p>\u7136\u540e\u521d\u59cb\u5316\u65f6\u6dfb\u52a0\u81ea\u5df1\u5b9e\u73b0\u62e6\u622a\u5668\u5373\u53ef</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\naddInterceptor(MyLogRecordInterceptor(BuildConfig.DEBUG))\n}\n</code></pre>"},{"location":"log-recorder/#logcat","title":"LogCat\u8fc7\u6ee4","text":"<p>\u5b9e\u9645\u4e0aNet\u7684\u7f51\u7edc\u65e5\u5fd7\u8fd8\u662f\u4f1a\u88ab\u6253\u5370\u5230LogCat, \u7136\u540e\u901a\u8fc7\u63d2\u4ef6\u6355\u6349\u663e\u793a.</p> <p></p> <p>\u5982\u679c\u4e0d\u60f3LogCat\u7684\u5197\u4f59\u65e5\u5fd7\u5f71\u54cd\u67e5\u770b\u5176\u5b83\u65e5\u5fd7, \u53ef\u4ee5\u901a\u8fc7AndroidStudio\u7684\u529f\u80fd\u6298\u53e0\u9690\u85cf, \u6dfb\u52a0\u4e00\u4e2a<code>OKPREL_</code>\u8fc7\u6ee4\u5b57\u6bb5\u5373\u53ef </p>"},{"location":"log-recorder/#_4","title":"\u5176\u4ed6\u7f51\u7edc\u6846\u67b6","text":"<p>\u53ef\u80fd\u4f60\u9879\u76ee\u4e2d\u8fd8\u6b8b\u7559\u5176\u4ed6\u7f51\u7edc\u6846\u67b6, \u4e5f\u53ef\u4ee5\u4f7f\u7528Net\u7684\u65e5\u5fd7\u8bb0\u5f55\u5668<code>LogRecorder</code>\u6765\u4e3a\u5176\u4ed6\u6846\u67b6\u6253\u5370\u65e5\u5fd7\u4fe1\u606f. \u5982\u679c\u662f\u57fa\u4e8eOkHttp\u7684\u6846\u67b6\u90a3\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528LogRecordInterceptor</p> \u51fd\u6570 \u63cf\u8ff0 generateId \u4ea7\u751f\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26, \u7528\u4e8e\u5224\u65ad\u4e3a\u540c\u4e00\u7f51\u7edc\u8bf7\u6c42 recordRequest \u8bb0\u5f55\u8bf7\u6c42\u4fe1\u606f recordResponse \u8bb0\u5f55\u54cd\u5e94\u4fe1\u606f recordException \u8bb0\u5f55\u8bf7\u6c42\u5f02\u5e38\u4fe1\u606f"},{"location":"model-generate/","title":"\u6570\u636e\u6a21\u578b\u751f\u6210\u63d2\u4ef6","text":"<p>\u5728\u8bf7\u6c42\u7f51\u7edc\u6570\u636e\u8fc7\u7a0b\u4e2d\u4f1a\u9700\u8981\u7f16\u5199\u5927\u91cf\u7684\u6570\u636e\u6a21\u578b\u5bf9\u8c61, \u6620\u5c04\u540e\u7aef\u8fd4\u56de\u7684\u6570\u636e\u521b\u5efa\u6570\u636e\u5bf9\u8c61. \u56e0\u4e3a\u6211\u4eec\u4e1a\u52a1\u903b\u8f91\u4e2d\u4e00\u822c\u662f\u76f4\u63a5\u6570\u636e\u5bf9\u8c61\u66f4\u4e3a\u65b9\u4fbf</p> <p>\u521b\u5efa\u6570\u636e\u6a21\u578b\u6211\u4e0d\u63a8\u8350\u624b\u5199, \u9519\u8bef\u7387\u9ad8\u4e14\u4e0d\u65b9\u4fbf. \u6211\u63a8\u8350\u4f7f\u7528<code>JSON To Kotlin Class</code> \u63d2\u4ef6\u81ea\u52a8\u751f\u6210</p>"},{"location":"model-generate/#_1","title":"\u5b89\u88c5\u63d2\u4ef6","text":"<p>\u5728Plugins\u91cc\u9762\u641c\u7d22kotlin\u5173\u952e\u8bcd\u4e0b\u8f7d\u5b89\u88c5 </p>"},{"location":"model-generate/#_2","title":"\u4f7f\u7528\u63d2\u4ef6","text":"<p>\u9009\u4e2d\u5206\u5305\u540e, \u4f7f\u7528\u5feb\u6377\u952e\u6216\u8005\u9f20\u6807\u53f3\u952e\u6253\u5f00\u586b\u5199Json\u754c\u9762</p> <p></p> <p>\u6dfb\u52a0Json\u7136\u540e\u70b9\u51fb<code>Generate</code>\u751f\u6210</p> <p></p> <p>\u7136\u540e\u5c31\u4f1a\u5728\u4f60\u9009\u4e2d\u7684\u5206\u5305\u4e0b\u751f\u6210\u4e00\u4e2a\u6570\u636e\u6a21\u578b\u7c7b\u4e86</p> <p>\u4e0d\u8981\u8f93\u5165json\u6570\u7ec4\u53bb\u751f\u6210, \u8f93\u5165\u6570\u7ec4\u91cc\u9762\u7684\u5bf9\u8c61\u5373\u53ef(\u5426\u5219\u751f\u6210\u7684\u7c7b\u4f1a\u81ea\u52a8\u7ee7\u627fArrayList). \u7136\u540e\u8bf7\u6c42\u7684\u65f6\u5019\u4f7f\u7528List\u6cdb\u578b\u5373\u53ef, \u4f8b\u5982<code>Get&lt;List&lt;Data&gt;&gt;</code></p>"},{"location":"model-generate/#_3","title":"\u9ad8\u7ea7\u8bbe\u7f6e","text":"<p>\u70b9\u51fb<code>Advanced</code>\u6253\u5f00\u8bbe\u7f6e\u754c\u9762</p>"},{"location":"model-generate/#_4","title":"\u53ef\u7a7a\u9009\u9879","text":"<p>\u622a\u56fe\u5373\u4e3a\u6211\u7684\u63a8\u8350\u914d\u7f6e</p> <p></p> <ol> <li>Keyword \u521b\u5efa\u7684\u6570\u636e\u6a21\u578b\u7684\u5b57\u6bb5\u662f Val\u8fd8\u662fVar</li> <li>Type \u5b57\u6bb5\u662f\u5426\u662f\u53ef\u7a7a\u7c7b\u578b, \u6700\u540e\u9009\u9879\u8868\u793a\u6839\u636eJson\u7684\u503c\u5224\u65ad\u662f\u5426\u53ef\u7a7a</li> <li>\u9ed8\u8ba4\u503c\u7684\u7b56\u7565, \u65e0\u6cd5\u9009\u62e9\u4e0d\u4ecb\u7ecd</li> </ol>"},{"location":"model-generate/#_5","title":"\u4f7f\u7528\u7684\u6846\u67b6","text":"<p>\u751f\u6210\u6570\u636e\u6a21\u578b\u65f6\u4f1a\u517c\u5bb9\u4f60\u4f7f\u7528\u7684\u6846\u67b6, \u4f8b\u5982Moshi\u548cKs\u53ef\u80fd\u9700\u8981\u6ce8\u89e3, \u7136\u540e\u4f1a\u81ea\u52a8\u751f\u6210SerialName\u8fd9\u4e9b\u540d\u79f0\u6ce8\u89e3 </p>"},{"location":"model-generate/#_6","title":"\u5176\u4ed6","text":"<p>\u622a\u56fe\u5373\u4e3a\u6211\u7684\u63a8\u8350\u914d\u7f6e</p> <p></p> <ol> <li>\u662f\u5426\u4f7f\u7528\u6ce8\u91ca, \u65e2\u4f1a\u5c06Json\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6ce8\u91ca\u4fdd\u7559\u5728\u6570\u636e\u6a21\u578b\u7c7b\u4e2d</li> <li>\u6839\u636e\u5b57\u6bcd\u6392\u5e8f\u6570\u636e\u6a21\u578b\u7684\u5b57\u6bb5</li> <li>\u4f7f\u7528\u5185\u90e8\u7c7b. \u4f8b\u5982Json\u4e2d\u7684Json\u5bf9\u8c61\u4f1a\u4f5c\u4e3a\u5185\u90e8\u7c7b\u88ab\u521b\u5efa\u5728\u6570\u636e\u6a21\u578b\u7c7b\u4e2d (\u63a8\u8350\u5f00\u542f, \u4fdd\u6301\u9ad8\u5185\u805a\u4f4e\u8026\u5408)</li> <li>\u5982\u679cJson\u5bf9\u8c61\u7684\u5b57\u6bb5\u90fd\u662f\u539f\u59cb\u7c7b\u578b\u5219\u4f7f\u7528Map\u6765\u8868\u793a</li> <li>\u53ea\u5728\u9700\u8981\u65f6\u521b\u5efa\u6ce8\u89e3</li> <li>\u81ea\u52a8\u9a8c\u8bc1Json\u6b63\u786e\u6027(\u5728\u586b\u5199\u65f6)</li> <li>Json\u683c\u5f0f\u5316\u65f6\u4f7f\u7528\u7684\u7a7a\u683c\u6570\u91cf</li> <li>\u6307\u5b9a\u4e00\u4e2a\u7c7b\u4f5c\u4e3a\u7236\u7c7b\u6a21\u677f(\u65e2\u521b\u5efa\u7684\u6570\u636e\u6a21\u578b\u90fd\u4f1a\u7ee7\u627f\u8be5\u7c7b)</li> </ol>"},{"location":"model-generate/#_7","title":"\u6269\u5c55","text":"<p>\u622a\u56fe\u5373\u4e3a\u6211\u7684\u63a8\u8350\u914d\u7f6e</p> <p></p> <ol> <li>\u6dfb\u52a0@Keep\u6ce8\u89e3, \u4e3a\u9632\u6b62\u88ab\u4ee3\u7801\u6df7\u6dc6</li> <li>\u6ce8\u89e3\u548c\u5b57\u6bb5\u5904\u4e8e\u540c\u4e00\u884c, \u4fbf\u4e8e\u7f8e\u89c2</li> <li>\u4f7f\u7528Parcelable\u5e8f\u5217\u5316</li> <li>\u4e3a\u5b57\u6bb5\u6dfb\u52a0\u524d\u7f00/\u540e\u7f00</li> <li>\u4e3a\u6570\u636e\u6a21\u578b\u7c7b\u6dfb\u52a0\u524d\u7f00/\u540e\u7f00</li> </ol>"},{"location":"okhttp-client/","title":"OkHttpClient","text":"<p>\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u4f1a\u5b58\u5728\u4e00\u4e2a\u5ba2\u6237\u7aef\u5bf9\u8c61, \u65e2OkHttpClient</p> <p>Net\u5728\u5168\u5c40\u7ef4\u62a4\u4e86\u4e00\u4e2aOkHttpClient\u5bf9\u8c61, \u5728NetConfig.okHttpClient\u7684\u5b57\u6bb5</p> <pre><code>object NetConfig {\nvar okHttpClient: OkHttpClient\n}\n</code></pre> <p>\u5f53\u7136\u4e5f\u652f\u6301\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5ba2\u6237\u7aef\u6765\u53d1\u8d77\u8bf7\u6c42(\u914d\u7f6e\u533a\u522b\u4e8e\u5168\u5c40\u5ba2\u6237\u7aef)</p>"},{"location":"okhttp-client/#okhttpclient","title":"\u5168\u5c40OkHttpClient","text":"<pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// \u6b64\u5904this\u5373\u4e3aOkHttpClient.Builder\n}\n</code></pre>"},{"location":"okhttp-client/#okhttpclient_1","title":"\u5355\u4f8bOkHttpClient","text":"<p>\u6bcf\u4e2a\u8bf7\u6c42\u53ef\u80fd\u5b58\u5728\u72ec\u7acb\u7684OkHttpClient\u914d\u7f6e, \u6211\u4eec\u53ef\u4ee5\u5355\u4f8b\u914d\u7f6e\u5ba2\u6237\u7aef\u9009\u9879</p> <ol> <li>\u5728\u5168\u5c40\u7684OkHttpClient\u914d\u7f6e\u57fa\u7840\u4e0b\u4fee\u6539</li> </ol> <pre><code>scopeNetLife {\ntv_response.text = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\") {\nsetClient {\n// \u6b64\u5904this\u5373\u4e3aOkHttpClient.Builder\ntrustCertificate()\n}\n}.await()\n}\n</code></pre> <ol> <li>\u5b8c\u5168\u91cd\u65b0\u521b\u5efa\u4e00\u4e2aOkHttpClient, \u4e00\u822c\u60c5\u51b5\u4e0d\u63a8\u8350\u91cd\u65b0\u521b\u5efa\u4e00\u4e2aOkHttpClient, \u56e0\u4e3a\u4e00\u4e2a\u65b0\u7684OkHttpClient\u4f1a\u91cd\u65b0\u521b\u5efa\u7ebf\u7a0b\u6c60/\u8fde\u63a5\u6c60\u7b49\u9020\u6210\u5185\u5b58\u6d88\u8017\u7b49</li> </ol> <pre><code>scopeNetLife {\ntv_response.text = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\") {\nokHttpClient = OkHttpClient.Builder().build()\n}.await()\n}\n</code></pre>"},{"location":"progress/","title":"\u8fdb\u5ea6\u76d1\u542c","text":"<p>Net\u652f\u6301\u4e0a\u4f20/\u4e0b\u8f7d\u7684\u8fdb\u5ea6\u76d1\u542c, \u4e14\u5177\u5907\u5b8c\u5584\u7684\u8fdb\u5ea6\u4fe1\u606f</p>"},{"location":"progress/#_1","title":"\u4e0a\u4f20\u8fdb\u5ea6\u76d1\u542c","text":"<pre><code>scopeNetLife {\nPost&lt;String&gt;(\"https://download.sublimetext.com/Sublime%20Text%20Build%203211.dmg\") {\nparam(\"file\", assetsFile())\naddUploadListener(object : ProgressListener() {\noverride fun onProgress(p: Progress) {\nseek.post {\nseek.progress = p.progress()\ntvProgress.text =\n\"\u4e0a\u4f20\u8fdb\u5ea6: ${p.progress()}% \u4e0a\u4f20\u901f\u5ea6: ${p.speedSize()}     \" +\n\"\\n\\n\u6587\u4ef6\u5927\u5c0f: ${p.totalSize()}  \u5df2\u4e0a\u4f20: ${p.currentSize()}  \u5269\u4f59\u5927\u5c0f: ${p.remainSize()}\" +\n\"\\n\\n\u5df2\u4f7f\u7528\u65f6\u95f4: ${p.useTime()}  \u5269\u4f59\u65f6\u95f4: ${p.remainTime()}\"\n}\n}\n})\n}.await()\n}\n</code></pre>"},{"location":"progress/#_2","title":"\u4e0b\u8f7d\u8fdb\u5ea6\u76d1\u542c","text":"<pre><code>scopeNetLife {\nval file =\nGet&lt;File&gt;(\"https://download.sublimetext.com/Sublime%20Text%20Build%203211.dmg\") {\nsetDownloadFileName(\"net.apk\")\nsetDownloadDir(requireContext().filesDir)\n\naddDownloadListener(object : ProgressListener() {\noverride fun onProgress(p: Progress) {\nseek?.post {\nval progress = p.progress()\nseek.progress = progress\ntvProgress.text =\n\"\u4e0b\u8f7d\u8fdb\u5ea6: $progress% \u4e0b\u8f7d\u901f\u5ea6: ${p.speedSize()}     \" +\n\"\\n\\n\u6587\u4ef6\u5927\u5c0f: ${p.totalSize()}  \u5df2\u4e0b\u8f7d: ${p.currentSize()}  \u5269\u4f59\u5927\u5c0f: ${p.remainSize()}\" +\n\"\\n\\n\u5df2\u4f7f\u7528\u65f6\u95f4: ${p.useTime()}  \u5269\u4f59\u65f6\u95f4: ${p.remainTime()}\"\n}\n}\n})\n}.await()\n}\n</code></pre> <p>\u65e0\u8bba\u662f\u4e0a\u4f20\u8fd8\u662f\u4e0b\u8f7d\u7684\u8fdb\u5ea6\u76d1\u542c\u4e0d\u4ec5\u4ec5\u662f\u6cdb\u578b\u4e3aFile\u5bf9\u8c61\u624d\u6709\u6548, \u4efb\u4f55\u8bf7\u6c42/\u54cd\u5e94\u90fd\u4f1a\u88ab\u76d1\u542c\u5230\u8fdb\u5ea6</p>"},{"location":"progress/#_3","title":"\u76d1\u542c\u5668","text":"<p>\u901a\u8fc7\u7ee7\u627f<code>ProgressListener</code>\u62bd\u8c61\u7c7b\u5b9e\u73b0\u76d1\u542c\u8fdb\u5ea6\u4fe1\u606f. \u8fdb\u5ea6\u4fe1\u606f\u4e3a<code>Progress</code>\u5bf9\u8c61</p>"},{"location":"progress/#_4","title":"\u8fdb\u5ea6\u95f4\u9694\u65f6\u95f4","text":"<p>ProgressListener\u7684\u6784\u9020\u53c2\u6570<code>interval</code>\u63a7\u5236\u89e6\u53d1\u8fdb\u5ea6\u76d1\u542c\u5668\u7684\u95f4\u9694\u65f6\u95f4, \u9ed8\u8ba4\u662f500\u6beb\u79d2. \u6bd5\u7adf\u8fdb\u5ea6\u76d1\u542c\u4e0d\u9700\u8981\u592a\u9891\u7e41\u7684\u8c03\u7528\u5f71\u54cd\u6027\u80fd.</p>"},{"location":"progress/#_5","title":"\u8fdb\u5ea6\u4fe1\u606f","text":"\u51fd\u6570 \u63cf\u8ff0 currentBytes \u5df2\u5b8c\u6210\u5b57\u8282\u6570 totalBytes \u5168\u90e8\u5927\u5c0f\u5b57\u8282\u6570 intervalBytes \u8fdb\u5ea6\u95f4\u9694\u65f6\u95f4\u5185\u5b8c\u6210\u7684\u5b57\u8282\u6570 intervalTime \u8ddd\u79bb\u4e0a\u6b21\u8fdb\u5ea6\u53d8\u5316\u95f4\u9694\u65f6\u95f4 startElapsedRealtime \u5f00\u59cb\u4e0b\u8f7d\u65f6\u95f4(\u8be5\u65f6\u95f4\u503c\u5f00\u673a\u5230\u73b0\u5728\u7684\u6beb\u79d2\u6570) speedBytes \u6bcf\u79d2\u4e0b\u8f7d\u5b57\u8282\u6570 progress \u8fdb\u5ea6, 1-100 finish \u6b64\u6b21\u4e0b\u8f7d/\u4e0a\u4f20\u662f\u5426\u5b8c\u6210 useTimeSeconds \u5df2\u7ecf\u4f7f\u7528\u65f6\u95f4, \u5355\u4f4d\u79d2 remainTimeSeconds \u4f30\u7b97\u7684\u5269\u4f59\u65f6\u95f4, \u5355\u4f4d\u79d2 <p>\u540c\u65f6\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5b57\u7b26\u4e32\u683c\u5f0f\u51fd\u6570, \u90fd\u662f\u8fd4\u56de\u5df2\u7ecf\u6dfb\u52a0\u597d\u5355\u4f4d</p> \u51fd\u6570 \u63cf\u8ff0 currentSize \u5df2\u5b8c\u6210\u5927\u5c0f, \u4f8b\u5982: <code>120kB</code> \u6216\u8005 <code>1.5MB</code> totalSize \u5168\u90e8\u5927\u5c0f, \u540c\u4e0a remainSize \u5269\u4f59\u5927\u5c0f, \u540c\u4e0a speedSize \u6bcf\u79d2\u4e0b\u8f7d\u5927\u5c0f, \u540c\u4e0a useTime \u5df2\u4f7f\u7528\u65f6\u95f4, \u683c\u5f0f\u4e3a: <code>01:23:04</code> remainTime \u4f30\u7b97\u7684\u5269\u4f59\u65f6\u95f4, \u683c\u5f0f\u4e3a: <code>01:23:04</code>"},{"location":"read-cache/","title":"Read cache","text":"<p>Net_v2\u57fa\u4e8eKalle\u5f00\u53d1, \u652f\u6301Kalle\u76849\u79cd\u7f13\u5b58\u6a21\u5f0f</p> <p>\u7f13\u5b58\u6a21\u5f0f\u8981\u6c42\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5f00\u542f</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\ncacheEnabled() // \u5f00\u542f\u7f13\u5b58\n}\n</code></pre> \u8bf7\u6c42\u7f13\u5b58\u6216\u7f51\u7edc <pre><code>scopeNetLife {\n// \u5148\u8bfb\u53d6\u7f13\u5b58, \u5982\u679c\u7f13\u5b58\u4e0d\u5b58\u5728\u518d\u8bf7\u6c42\u7f51\u7edc\ntvFragment.text = Get&lt;String&gt;(\"api\", cache = CacheMode.READ_CACHE_NO_THEN_NETWORK).await()\nLog.d(\"\u65e5\u5fd7\", \"\u8bfb\u53d6\u7f13\u5b58\")\n}\n</code></pre> \u8bfb\u53d6\u7f13\u5b58\u7136\u540e\u8bf7\u6c42\u7f51\u7edc <pre><code>scopeNetLife {\n// \u7136\u540e\u6267\u884c\u8fd9\u91cc(\u7f51\u7edc\u8bf7\u6c42)\ntvFragment.text = Post&lt;String&gt;(\"api\", cache = CacheMode.NETWORK_YES_THEN_WRITE_CACHE).await()\nLog.d(\"\u65e5\u5fd7\", \"\u7f51\u7edc\u8bf7\u6c42\")\n}.preview {\n// \u5148\u6267\u884c\u8fd9\u91cc(\u4ec5\u8bfb\u7f13\u5b58), \u4efb\u4f55\u5f02\u5e38\u90fd\u89c6\u4e3a\u8bfb\u53d6\u7f13\u5b58\u5931\u8d25\ntvFragment.text = Get&lt;String&gt;(\"api\", cache = CacheMode.READ_CACHE).await()\nLog.d(\"\u65e5\u5fd7\", \"\u8bfb\u53d6\u7f13\u5b58\")\n}\n</code></pre> <p>\u9884\u8bfb\u6a21\u5f0f\u672c\u8d28\u4e0a\u5c31\u662f\u521b\u5efa\u4e00\u4e2a<code>preview</code>\u9644\u52a0\u4f5c\u7528\u57df, \u91cc\u9762\u7684\u6240\u6709\u5f02\u5e38\u5d29\u6e83\u90fd\u4f1a\u88ab\u9759\u9ed8\u6355\u6349(\u7b97\u4f5c\u7f13\u5b58\u5931\u8d25), \u4f1a\u4f18\u5148\u4e8e<code>scope*</code>\u6267\u884c, \u7136\u540e\u518d\u6267\u884cscope\u672c\u8eab, \u800c\u4e14\u4e00\u65e6\u7f13\u5b58\u8bfb\u53d6\u6210\u529f(<code>preview</code>\u5185\u90e8\u65e0\u5f02\u5e38)\u5373\u4f7f\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25\u4e5f\u53ef\u4ee5\u4e0d\u63d0\u9192\u7528\u6237\u4efb\u4f55\u9519\u8bef\u4fe1\u606f(\u53ef\u914d\u7f6e)</p> <p></p> <p><code>preview</code>\u5e76\u6ca1\u6709\u8bf4\u53ea\u80fd\u7528\u5728\u7f51\u7edc\u7f13\u5b58\u4e0a, \u4e5f\u53ef\u4ee5\u7528\u4e8e\u5176\u4ed6\u7684\u5904\u7406\u573a\u666f</p> <p></p>"},{"location":"read-cache/#_1","title":"\u7f13\u5b58\u6a21\u5f0f","text":"<p>\u7f13\u5b58\u6a21\u5f0f\u5c5e\u4e8e<code>CacheMod</code>\u679a\u4e3e, \u5efa\u8bae\u5f00\u53d1\u8005\u6d4f\u89c8\u7f13\u5b58\u6a21\u5f0f\u7684\u6e90\u7801\u548c\u6ce8\u91ca\uff0c\u6709\u52a9\u4e8e\u7406\u89e3\u548c\u66f4\u597d\u7684\u4f7f\u7528\u7f13\u5b58\u6a21\u5f0f\u3002</p> \u5e38\u91cf \u63cf\u8ff0 <code>HTTP</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u5982\u679c\u672c\u5730\u5df2\u7ecf\u6709\u7f13\u5b58\uff0c\u5982\u679c\u7f13\u5b58\u672a\u8fc7\u671f\u5219\u8fd4\u56de\u7f13\u5b58\u6570\u636e\uff0c\u5982\u679c\u8fc7\u671f\u5219\u5e26\u4e0a\u7f13\u5b58\u5934\u53bb\u670d\u52a1\u5668\u505a\u6821\u9a8c\u3002\u5982\u679c\u670d\u52a1\u5668\u54cd\u5e94304\u5219\u8fd4\u56de\u7f13\u5b58\u6570\u636e\uff0c\u5426\u5219\u8bfb\u53d6\u670d\u52a1\u5668\u6570\u636e\uff0c\u6839\u636e\u670d\u52a1\u5668\u54cd\u5e94\u5934\u6765\u51b3\u5b9a\u662f\u5426\u5199\u5165\u7f13\u5b58\u6570\u636e <code>HTTP_YES_THEN_WRITE_CACHE</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u5982\u679c\u672c\u5730\u5df2\u7ecf\u6709\u7f13\u5b58\u5219\u5e26\u7f13\u5b58\u5934\uff0c\u670d\u52a1\u5668\u54cd\u5e94304\u624d\u8fd4\u56de\u7f13\u5b58\u6570\u636e\uff0c\u5426\u5219\u8bfb\u53d6\u670d\u52a1\u5668\u6570\u636e\uff0c\u5e76\u5199\u5165\u7f13\u5b58\u6570\u636e <code>NETWORK</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u4e0d\u7ba1\u672c\u5730\u662f\u5426\u6709\u7f13\u5b58\uff0c\u90fd\u4e0d\u4f1a\u5e26\u4e0a\u7f13\u5b58\u5934\uff0c\u4e0d\u8bba\u670d\u52a1\u5668\u54cd\u5e94\u5934\u5982\u4f55\uff0c\u7edd\u4e0d\u5199\u5165\u7f13\u5b58\u6570\u636e <code>NETWORK_YES_THEN_HTTP</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u4e0d\u7ba1\u672c\u5730\u662f\u5426\u6709\u7f13\u5b58\uff0c\u90fd\u4e0d\u4f1a\u5e26\u4e0a\u7f13\u5b58\u5934\uff0c\u6839\u636e\u670d\u52a1\u5668\u54cd\u5e94\u5934\u6765\u51b3\u5b9a\u662f\u5426\u5199\u5165\u7f13\u5b58\u6570\u636e <code>NETWORK_YES_THEN_WRITE_CACHE</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u4e0d\u7ba1\u672c\u5730\u662f\u5426\u6709\u7f13\u5b58\uff0c\u90fd\u4e0d\u4f1a\u5e26\u4e0a\u7f13\u5b58\u5934\uff0c\u8bf7\u6c42\u6210\u529f\u540e\u5199\u5165\u7f13\u5b58\u6570\u636e <code>NETWORK_NO_THEN_READ_CACHE</code> \u53d1\u8d77\u8bf7\u6c42\u524d\u4e0d\u7ba1\u672c\u5730\u662f\u5426\u6709\u7f13\u5b58\uff0c\u90fd\u4e0d\u4f1a\u5e26\u4e0a\u7f13\u5b58\u5934\uff0c\u8bf7\u6c42\u5931\u8d25\u540e\u5c1d\u8bd5\u8bfb\u53d6\u7f13\u5b58, \u6839\u636e\u670d\u52a1\u5668\u54cd\u5e94\u5934\u6765\u51b3\u5b9a\u662f\u5426\u5199\u5165\u7f13\u5b58\u6570\u636e <code>READ_CACHE</code> \u4ec5\u8bfb\u53d6\u7f13\u5b58 <code>READ_CACHE_NO_THEN_NETWORK</code> \u8bfb\u53d6\u7f13\u5b58\uff0c\u5982\u679c\u7f13\u5b58\u4e0d\u5b58\u5728\u5c31\u8bf7\u6c42\u7f51\u7edc\uff0c\u4e0d\u5199\u5165\u7f13\u5b58\u6570\u636e <code>READ_CACHE_NO_THEN_HTTP</code> \u5148\u8bfb\u53d6\u7f13\u5b58\uff0c\u5982\u679c\u7f13\u5b58\u4e0d\u5b58\u5728\u5c31\u8bf7\u6c42\u7f51\u7edc\uff0c\u6839\u636e\u670d\u52a1\u5668\u54cd\u5e94\u5934\u6765\u51b3\u5b9a\u662f\u5426\u5199\u5165\u7f13\u5b58\u6570\u636e <code>READ_CACHE_NO_THEN_NETWORK_THEN_WRITE_CACHE</code> \u5148\u672c\u5730\u6709\u7f13\u5b58\u5219\u8bfb\u53d6\u7f13\u5b58\uff0c\u5982\u679c\u6ca1\u6709\u7f13\u5b58\u5219\u8bfb\u53d6\u7f51\u7edc\u5e76\u4e14\u5199\u5165\u7f13\u5b58, \u8be5\u6a21\u5f0f\u8bf7\u6c42\u6210\u529f\u540e\u4f1a\u6c38\u4e45\u4f7f\u7528\u7f13\u5b58, \u4f46\u4f60\u53ef\u4ee5\u6307\u5b9a\u52a8\u6001\u7684cacheKey\u6765\u8ba9\u7f13\u5b58\u5931\u6548 \u4f8b\u5982\u4e00\u5929\u540e\u5931\u6548, \u53ef\u4ee5\u505a\u5230\u5ba2\u6237\u7aef\u5b8c\u5168\u63a7\u5236\u7f13\u5b58 <p></p>"},{"location":"request/","title":"\u8bf7\u6c42\u53c2\u6570","text":"<p>Net\u4e2d\u5173\u4e8e\u8bf7\u6c42\u7684\u7c7b\u53ea\u6709\u4e24\u4e2a\u7c7b\u548c\u4ed6\u4eec\u5171\u540c\u7684\u62bd\u8c61\u7236\u7c7b</p> <pre><code>BaseRequest\n|- UrlRequest\n|- BodyRequest\n</code></pre> <p>\u6839\u636e\u8bf7\u6c42\u65b9\u6cd5\u4e0d\u540c\u4f7f\u7528\u7684Request\u4e5f\u4e0d\u540c</p> <pre><code>GET, HEAD, OPTIONS, TRACE, // Url request\nPOST, DELETE, PUT, PATCH // Body request\n</code></pre> <p>\u4ee3\u7801\u793a\u4f8b</p> <pre><code>scopeNetLife {\nGet&lt;String&gt;(\"api\") {\n// this \u5373\u4e3a UrlRequest\n}.await()\n\nPost&lt;String&gt;(\"api\") {\n// this \u5373\u4e3a BodyRequest\n}.await()\n}\n</code></pre>"},{"location":"request/#_1","title":"\u8bf7\u6c42\u53c2\u6570","text":"<pre><code>scopeNetLife { // \u521b\u5efa\u4f5c\u7528\u57df\n// \u8fd9\u4e2a\u5927\u62ec\u53f7\u5185\u5c31\u5c5e\u4e8e\u4f5c\u7528\u57df\u5185\u90e8\nval data = Get&lt;String&gt;(\"https://github.com/liangjingkanji/Net/\"){\nparam(\"u_name\", \"drake\")\nparam(\"pwd\", \"123456\")\n}.await() // \u53d1\u8d77GET\u8bf7\u6c42\u5e76\u8fd4\u56de`String`\u7c7b\u578b\u6570\u636e\n}\n</code></pre> \u8bf7\u6c42\u51fd\u6570 \u63cf\u8ff0 <code>param</code> \u652f\u6301\u57fa\u7840\u7c7b\u578b/\u6587\u4ef6/RequestBody/Part <code>json</code> \u8bf7\u6c42\u53c2\u6570\u4e3aJSONObject/JsonArray/String <code>setQuery/addQuery</code> \u8bbe\u7f6e/\u6dfb\u52a0Url\u53c2\u6570, \u5982\u679c\u5f53\u524d\u8bf7\u6c42\u4e3aUrl\u8bf7\u6c42\u5219\u8be5\u51fd\u6570\u7b49\u6548\u4e8e<code>param</code>\u51fd\u6570 <code>setHeader/addHeader</code> \u8bbe\u7f6e/\u6dfb\u52a0\u8bf7\u6c42\u5934 <p>\u5982\u679c\u6ca1\u6709\u6dfb\u52a0\u6587\u4ef6/\u6d41\u90a3\u4e48\u5c31\u662f\u901a\u8fc7BodyRequest\u5185\u90e8\u7684<code>FormBody</code>\u53d1\u8d77\u8bf7\u6c42. \u53cd\u4e4b\u5c31\u662f\u901a\u8fc7<code>MultipartBody</code>\u53d1\u8d77\u8bf7\u6c42.</p> <p>\u5f53\u7136\u4f60\u53ef\u4ee5\u5b8c\u5168\u81ea\u5b9a\u4e49Body\u6765\u8bf7\u6c42, \u8b6c\u5982\u4ee5\u4e0b\u7684Json\u8bf7\u6c42</p>"},{"location":"request/#json","title":"Json\u8bf7\u6c42","text":"<p>\u8fd9\u91cc\u63d0\u4f9b\u4e09\u79cd\u521b\u5efaJson\u8bf7\u6c42\u7684\u793a\u4f8b\u4ee3\u7801. \u914c\u60c5\u9009\u7528</p> JSON\u952e\u503c\u5bf9(\u63a8\u8350) <pre><code>val name = \"\u91d1\u57ce\u6b66\"\nval age = 29\nval measurements = listOf(100, 100, 100)\n\nscopeNetLife {\ntvFragment.text = Post&lt;String&gt;(\"api\") {\n// \u53ea\u652f\u6301\u57fa\u7840\u7c7b\u578b\u7684\u503c, \u5982\u679c\u503c\u4e3a\u5bf9\u8c61\u6216\u8005\u5305\u542b\u5bf9\u8c61\u7684\u96c6\u5408/\u6570\u7ec4\u4f1a\u5bfc\u81f4\u5176\u503c\u4e3anull\njson(\"name\" to name, \"age\" to age, \"measurements\" to measurements)\n}.await()\n}\n</code></pre> JSONObject <pre><code>val name = \"\u91d1\u57ce\u6b66\"\nval age = 29\nval measurements = listOf(100, 100, 100) // \u53ea\u652f\u6301\u57fa\u7840\u7c7b\u578b\u7684\u503c, \u5982\u679c\u503c\u4e3a\u5bf9\u8c61\u6216\u8005\u5305\u542b\u5bf9\u8c61\u7684\u96c6\u5408/\u6570\u7ec4\u4f1a\u5bfc\u81f4\u5176\u503c\u4e3anull\n\nscopeNetLife {\ntvFragment.text = Post&lt;String&gt;(\"api\") {\njson(JSONObject().run {\nput(\"name\", name)\nput(\"age\", age)\nput(\"measurements\", JSONArray(measurements))\n})\n}.await()\n}\n</code></pre> \u81ea\u5b9a\u4e49\u7684body <pre><code>val name = \"\u91d1\u57ce\u6b66\"\nval age = 29\nval measurements = listOf(100, 100, 100)\n\nscopeNetLife {\ntvFragment.text = Post&lt;String&gt;(\"api\") {\nbody = MyJsonBody(name, age, measurements)\n}.await()\n}\n</code></pre> <p>\u5bf9\u4e8e\u67d0\u4e9b\u53ef\u80fdJSON\u8bf7\u6c42\u53c2\u6570\u5b58\u5728\u56fa\u5b9a\u503c:</p> <ol> <li>\u53ef\u4ee5\u8003\u8651\u7ee7\u627fRequestBody\u6765\u6269\u5c55\u51fa\u81ea\u5df1\u7684\u65b0\u7684Body\u5bf9\u8c61, \u7136\u540e\u8d4b\u503c\u7ed9<code>body</code>\u5b57\u6bb5</li> <li>\u6dfb\u52a0\u8bf7\u6c42\u62e6\u622a\u5668RequestInterceptor</li> </ol>"},{"location":"request/#_2","title":"\u81ea\u5b9a\u4e49\u8bf7\u6c42\u51fd\u6570","text":"<p>\u524d\u9762\u63d0\u5230<code>json(Pair&lt;String, Any?&gt;)</code>\u51fd\u6570\u4e0d\u652f\u6301\u5bf9\u8c61\u503c, \u56e0\u4e3a\u6846\u67b6\u5185\u90e8\u4f7f\u7528\u7684<code>org.json.JSONObject</code>\u5176\u4e0d\u652f\u6301\u6620\u5c04\u5bf9\u8c61\u5b57\u6bb5</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u521b\u5efa\u6269\u5c55\u51fd\u6570\u6765\u652f\u6301\u4f60\u60f3\u8981\u7684Json\u89e3\u6790\u6846\u67b6, \u6bd4\u5982\u4ee5\u4e0b\u5e38\u7528\u7684Json\u89e3\u6790\u6846\u67b6\u793a\u4f8b</p> Gson <pre><code>fun BodyRequest.gson(vararg body: Pair&lt;String, Any?&gt;) {\nthis.body = Gson().toJson(body.toMap()).toRequestBody(MediaConst.JSON)\n}\n</code></pre> FastJson <pre><code>fun BodyRequest.fastJson(vararg body: Pair&lt;String, Any?&gt;) {\nthis.body = JSON.toJSON(body.toMap()).toRequestBody(MediaConst.JSON)\n}\n</code></pre> <p>\u4f7f\u7528</p> <pre><code>scopeNetLife {\ntvFragment.text = Post&lt;String&gt;(\"api\") {\ngson(\"name\" to name, \"model\" to Model()) // \u53c2\u6570\u652f\u6301Gson\u53ef\u89e3\u6790\u7684\u5bf9\u8c61\n// fastJson(\"name\" to name, \"model\" to Model()) // \u4f7f\u7528FastJson\n}.await()\n}\n</code></pre> <ul> <li>\u4e3e\u4e00\u53cd\u4e09\u53ef\u4ee5\u521b\u5efa\u5176\u4ed6\u529f\u80fd\u81ea\u5b9a\u4e49\u7684\u8bf7\u6c42\u51fd\u6570</li> <li>\u6269\u5c55\u51fd\u6570\u8981\u6c42\u4e3a\u9876\u5c42\u51fd\u6570, \u5373\u76f4\u63a5\u5728\u6587\u4ef6\u4e2d (kotlin\u57fa\u7840\u8bed\u6cd5)</li> </ul>"},{"location":"request/#_3","title":"\u5168\u5c40\u8bf7\u6c42\u53c2\u6570","text":"<p>\u5bf9\u4e8e\u52a8\u6001\u751f\u6210\u7684\u5168\u5c40\u8bf7\u6c42\u5934\u6216\u53c2\u6570\u90fd\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0<code>RequestInterceptor</code>\u6765\u8bbe\u7f6e\u5168\u5c40\u7684\u8bf7\u6c42\u62e6\u622a\u5668\u6765\u6dfb\u52a0, \u5982\u679cRequestInterceptor\u4e0d\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\u53ef\u4ee5\u4f7f\u7528\u62e6\u622a\u5668(Interceptor)\u6765\u5b9e\u73b0</p> <pre><code>NetConfig.initialize(\"https://github.com/liangjingkanji/Net/\", this) {\n// \u6dfb\u52a0\u8bf7\u6c42\u62e6\u622a\u5668, \u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u89e6\u53d1\u7684, \u53ef\u914d\u7f6e\u5168\u5c40/\u52a8\u6001\u53c2\u6570\nsetRequestInterceptor(MyRequestInterceptor())\n}\n</code></pre>"},{"location":"request/#_4","title":"\u8bf7\u6c42\u51fd\u6570","text":"<p>\u5173\u4e8e\u5168\u90e8\u7684\u8bf7\u6c42\u914d\u7f6e\u9009\u9879\u63a8\u8350\u9605\u8bfb\u51fd\u6570\u6587\u6863\u6216\u8005\u9605\u8bfb\u6e90\u7801. Net\u63d0\u4f9b\u6e05\u6670\u7684\u51fd\u6570\u7ed3\u6784\u6d4f\u89c8\u65b9\u4fbf\u76f4\u63a5\u9605\u8bfb\u6e90\u7801</p> <p></p>"},{"location":"scope/","title":"\u4f5c\u7528\u57df","text":"<p>\u534f\u7a0b\u8bf7\u6c42\u8981\u6c42\u5728\u534f\u7a0b\u7684\u4f5c\u7528\u57df\u4e2d\u8c03\u7528, \u8fd9\u91cc\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa\u4e0d\u540c\u7684\u4f5c\u7528\u57df\u83b7\u53d6\u4e0d\u540c\u7684\u529f\u80fd</p> <p>\u672c\u8d28\u4e0aNet\u7684\u8bf7\u6c42\u52a8\u4f5c\u51fd\u6570\u8fd4\u56de\u7684\u662f\u4e00\u4e2aDeferred\u5bf9\u8c61. \u53ef\u4ee5\u5728\u4efb\u4f55\u534f\u7a0b\u4f5c\u7528\u57df\u5185\u6267\u884c. \u4f46\u662f\u8003\u8651\u5230\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\u548c\u9519\u8bef\u5904\u7406\u7b49\u63a8\u8350\u4f7f\u7528Net\u5185\u90e8\u5b9a\u4e49\u7684\u4f5c\u7528\u57df.</p> <p>\u53d1\u751f\u5728Net\u4f5c\u7528\u57df\u5185\u7684\u4efb\u4f55\u5f02\u5e38\u90fd\u4f1a\u88ab\u6355\u83b7, \u6709\u6548\u51cf\u5c11\u5e94\u7528\u5d29\u6e83\u7387. \u5982\u679c\u914d\u5408kotlin-serialization\u8fd8\u53ef\u4ee5\u89e3\u51b3\u56e0\u670d\u52a1\u5668\u8fd4\u56denull\u5b57\u6bb5\u5bfc\u81f4\u7684\u5d29\u6e83</p>"},{"location":"scope/#_1","title":"\u5f02\u6b65\u4efb\u52a1\u7684\u4f5c\u7528\u57df","text":"<p>\u521b\u5efa\u53ef\u4ee5\u6355\u6349\u5f02\u5e38\u7684\u534f\u7a0b\u4f5c\u7528\u57df, \u4f46\u662f\u4e0d\u4f1a\u89e6\u53d1<code>NetErrorHandler</code>(\u5168\u5c40\u9519\u8bef\u5904\u7406\u8005). \u8be5\u4f5c\u7528\u57df\u4e8e\u4e00\u822c\u7528\u4e8e\u666e\u901a\u7684\u5f02\u6b65\u4efb\u52a1</p> \u51fd\u6570 \u63cf\u8ff0 <code>scope</code> \u521b\u5efa\u6700\u57fa\u7840\u7684\u4f5c\u7528\u57df, \u6240\u6709\u4f5c\u7528\u57df\u90fd\u5305\u542b\u5f02\u5e38\u6355\u6349 <code>scopeLife</code> \u521b\u5efa\u8ddf\u968f\u751f\u547d\u5468\u671f\u53d6\u6d88\u7684\u4f5c\u7528\u57df <code>ViewModel.scopeLife</code> \u521b\u5efa\u8ddf\u968fViewModel\u751f\u547d\u5468\u671f\u7684\u4f5c\u7528\u57df, \u5982\u4f55\u5728ViewModel\u521b\u5efa\u4f5c\u7528\u57df"},{"location":"scope/#_2","title":"\u7f51\u7edc\u8bf7\u6c42\u7684\u4f5c\u7528\u57df","text":"<p>\u7f51\u7edc\u8bf7\u6c42\u7684\u4f5c\u7528\u57df\u53ef\u4ee5\u6839\u636e\u751f\u547d\u5468\u671f\u81ea\u52a8\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42, \u53d1\u751f\u9519\u8bef\u4e5f\u4f1a\u81ea\u52a8\u5f39\u51fa\u5410\u53f8(\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6216\u8005\u53d6\u6d88), \u5e76\u4e14\u5177\u5907\u4e00\u4e9b\u573a\u666f\u7684\u7279\u6b8a\u529f\u80fd(\u4f8b\u5982\u52a0\u8f7d\u5bf9\u8bdd\u6846, \u7f3a\u7701\u9875, \u4e0b\u62c9\u5237\u65b0\u7b49)</p> <p>\u7f51\u7edc\u8bf7\u6c42\u7684\u4f5c\u7528\u57df\u6bd4\u4e0a\u9762\u63d0\u5230\u7684\u5f02\u6b65\u4efb\u52a1\u7684\u4f5c\u7528\u57df\u591a\u7684\u533a\u522b\u5c31\u662f</p> <ol> <li>\u53d1\u751f\u9519\u8bef\u4f1a\u89e6\u53d1\u5168\u5c40\u9519\u8bef\u5904\u7406<code>NetErrorHandler</code></li> <li>\u5177\u5907\u4e00\u4e9b\u7279\u6b8a\u573a\u666f\u529f\u80fd, \u6bd4\u5982\u81ea\u52a8\u4e0b\u62c9\u5237\u65b0, \u81ea\u52a8\u663e\u793a\u52a0\u8f7d\u5e93\u7b49</li> </ol> \u51fd\u6570 \u63cf\u8ff0 <code>scopeNet</code> \u521b\u5efa\u81ea\u52a8\u5904\u7406\u7f51\u7edc\u9519\u8bef\u7684\u4f5c\u7528\u57df <code>scopeNetLife</code> \u521b\u5efa\u81ea\u52a8\u5904\u7406\u7f51\u7edc\u9519\u8bef\u7684\u4f5c\u7528\u57df, \u4e14\u5305\u542b\u8ddf\u968fActivity\u6216\u8005Fragment\u751f\u547d\u5468\u671f <code>scopeDialog</code> \u521b\u5efa\u81ea\u52a8\u52a0\u8f7d\u5bf9\u8bdd\u6846\u7684\u4f5c\u7528\u57df, \u751f\u547d\u5468\u671f\u8ddf\u968f\u5bf9\u8bdd\u6846 <code>ViewModel.scopeNetLife</code> \u521b\u5efa\u8ddf\u968fViewModel\u751f\u547d\u5468\u671f\u7684\u4f5c\u7528\u57df, \u5982\u4f55\u5728ViewModel\u521b\u5efa\u4f5c\u7528\u57df <code>PageRefreshLayout.scope</code> \u521b\u5efa\u8ddf\u968fPageRefreshLayout\u751f\u547d\u5468\u671f\u7684\u4f5c\u7528\u57df <code>StateLayout.scope</code> \u521b\u5efa\u8ddf\u968fStateLayout\u751f\u547d\u5468\u671f\u7684\u4f5c\u7528\u57df <p></p> <p>PageRefreshLayout/StateLayout \u5c5e\u4e8eBRV\u6846\u67b6\u4e2d\u7684\u5e03\u5c40, \u7528\u4e8e\u652f\u6301\u81ea\u52a8\u5316\u7f3a\u7701\u9875/\u4e0b\u62c9\u5237\u65b0 </p> <p>\u5982\u679c\u60f3\u4e86\u89e3\u8be6\u7ec6\u7684\u534f\u7a0b\u4f7f\u7528\u65b9\u5f0f, \u53ef\u4ee5\u67e5\u770b\u4e00\u7bc7\u6587\u7ae0: \u6700\u5168\u9762\u7684Kotlin\u534f\u7a0b: Coroutine/Channel/Flow \u4ee5\u53ca\u5b9e\u9645\u5e94\u7528</p> <p>\u6709\u65f6\u5019\u53ef\u80fd\u9762\u4e34\u5d4c\u5957\u7684<code>scope*</code>\u51fd\u6570\u6216\u8005\u4f5c\u7528\u57df\u5185\u6709\u5b50\u4f5c\u7528\u57df\u60c5\u51b5, \u8fd9\u4e2a\u65f6\u5019\u7684\u751f\u547d\u5468\u671f\u662f\u5982\u4f55</p>"},{"location":"scope/#scope","title":"\u5d4c\u5957Scope","text":"<pre><code>scopeNet {\nval task = Post&lt;String&gt;(\"api0\").await()\n\nscopeNet {\nval task = Post&lt;String&gt;(\"api0\").await() // \u6b64\u65f6\u53d1\u751f\u8bf7\u6c42\u9519\u8bef\n}.catch {\n// A\n}\n}.catch {\n// B\n}\n</code></pre> <ul> <li>\u4ee5\u4e0b\u5d4c\u5957\u4f5c\u7528\u57df\u9519\u8bef\u5c06\u4f1a\u4ec5\u53d1\u751f\u5728<code>A</code>\u5904, \u5e76\u88ab\u6355\u83b7, \u540c\u65f6\u4e0d\u5f71\u54cd\u5916\u90e8<code>scopeNet</code>\u7684\u8bf7\u6c42\u548c\u5f02\u5e38\u6355\u83b7</li> <li>\u4e24\u4e2a<code>scopeNet</code>\u7684\u5f02\u5e38\u629b\u51fa\u548c\u6355\u83b7\u4e92\u4e0d\u5f71\u54cd</li> <li><code>scopeNet/scopeDialog/scope</code>\u7b49\u51fd\u6570\u540c\u7406</li> </ul>"},{"location":"scope/#_3","title":"\u5b50\u4f5c\u7528\u57df","text":"<pre><code>scopeNet {\nval await = Post&lt;String&gt;(\"api\").await()\n\nlaunch {\nval task = Post&lt;String&gt;(\"api0\").await()  // \u6b64\u65f6\u53d1\u751f\u8bf7\u6c42\u9519\u8bef\n}.invokeOnCompletion {\n// A\n}\n}.catch {\n// B\n}\n</code></pre> <ul> <li>\u8fd9\u79cd\u60c5\u51b5 \u5148\u6267\u884c<code>A</code>\u7136\u540e\u6267\u884c<code>B</code>, \u5e76\u4e14\u90fd\u80fd\u6355\u83b7\u5f02\u5e38.</li> <li>\u540c\u65f6<code>scopeNet</code>\u53d1\u751f\u9519\u8bef\u4e5f\u4f1a\u5bfc\u81f4<code>launch</code>\u5185\u7684\u8bf7\u6c42\u88ab\u53d6\u6d88, <code>launch</code>\u53d1\u751f\u9519\u8bef\u4e5f\u4f1a\u5bfc\u81f4<code>scopeNet</code>\u53d1\u751f\u9519\u8bef</li> </ul>"},{"location":"switch-thread/","title":"\u5207\u6362\u7ebf\u7a0b","text":"<p>\u6240\u6709<code>scope*</code>\u524d\u7f00\u51fd\u6570\u7684\u521b\u5efa\u7684\u4f5c\u7528\u57df\u90fd\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a\u4e3b\u7ebf\u7a0b, \u5373\u53ef\u4ee5\u5728\u4f5c\u7528\u57df\u5185\u76f4\u63a5\u64cd\u4f5cUI</p> <p>\u65e2\u7136\u662f\u9ed8\u8ba4\u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539scope\u5185\u7684\u4f5c\u7528\u57df\u7ebf\u7a0b\u4e5f\u53ef\u4ee5\u5728\u91cc\u9762\u8fdb\u884c\u591a\u6b21\u5207\u6362</p> <p>\u5728\u534f\u7a0b\u4e2d\u5207\u6362\u7ebf\u7a0b\u53ea\u9700\u8981\u5207\u6362\u8c03\u5ea6\u5668\u5373\u53ef</p>"},{"location":"switch-thread/#_1","title":"\u5207\u6362\u4f5c\u7528\u57df\u8c03\u5ea6\u5668","text":"<pre><code>scopeNetLife(dispatcher = Dispatchers.IO) {\nbinding.tvFragment.text = Get&lt;String&gt;(\"api\").await()\n}\n</code></pre>"},{"location":"switch-thread/#_2","title":"\u5728\u4f5c\u7528\u57df\u5185\u90e8\u5207\u6362","text":"<p>\u53ef\u80fd\u67d0\u4e9b\u60c5\u51b5\u53ea\u662f\u4f5c\u7528\u57df\u5185\u90e8\u5206\u963b\u585e\u4efb\u52a1\u9700\u8981\u5728\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c. \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u4f5c\u7528\u57df\u5185\u90e8\u8fdb\u884c\u591a\u6b21\u7684\u7ebf\u7a0b\u5207\u6362</p> \u4e3b\u7ebf\u7a0b\u4f5c\u7528\u57df\u5185\u5207\u6362\u5b50\u7ebf\u7a0b <pre><code>scopeNetLife {\nbinding.tvFragment.text = withIO {\n// \u5047\u8bbe\u6b64\u5904\u662f\u4e00\u4e2aIO\u8bfb\u5199\u963b\u585e\u4efb\u52a1\nreturn \"\u8bfb\u51fa\u7ed3\u679c\"\n}\n}\n</code></pre> \u5b50\u7ebf\u7a0b\u4f5c\u7528\u57df\u5185\u5207\u6362\u4e3b\u7ebf\u7a0b <pre><code>scopeNetLife(dispatcher = Dispatchers.IO) {\nbinding.tvFragment.text = withMain {\n// \u5047\u8bbe\u6b64\u5904\u662f\u4e00\u4e2aIO\u8bfb\u5199\u963b\u585e\u4efb\u52a1\nreturn \"\u8bfb\u51fa\u7ed3\u679c\"\n}\n}\n</code></pre> \u51fd\u6570 \u63cf\u8ff0 withMain \u5207\u6362\u5230\u4e3b\u7ebf\u7a0b withIO \u5207\u6362\u5230IO\u7ebf\u7a0b withDefault \u5207\u6362\u5230\u9ed8\u8ba4\u7ebf\u7a0b(\u5c5e\u4e8e\u5b50\u7ebf\u7a0b) withUnconfined \u5207\u6362\u5230\u65e0\u9650\u5236\u8c03\u5ea6\u5668, \u5176\u53d6\u51b3\u4e8e\u4e0a\u4e00\u4e2a\u6267\u884c\u7684\u7ebf\u7a0b\u5207\u6362 launch \u65e0\u8fd4\u56de\u503c\u7684\u534f\u7a0b\u6302\u8d77\u51fd\u6570, \u53ef\u6307\u5b9a\u7ebf\u7a0b async \u6709\u8fd4\u56de\u503c\u7684\u534f\u7a0b\u6302\u8d77\u51fd\u6570, \u4f46\u5f97\u901a\u8fc7<code>await()</code>\u8fd4\u56de\u503c. \u53ef\u6307\u5b9a\u7ebf\u7a0b runMain \u5207\u6362\u5230\u4e3b\u7ebf\u7a0b, \u8be5\u51fd\u6570\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u8c03\u7528\u4e0d\u9650\u4e8e\u534f\u7a0b\u4f5c\u7528\u57df <ul> <li><code>with*</code>\u51fd\u6570\u5c5e\u4e8e\u8c03\u7528\u5c31\u7acb\u5373\u6267\u884c, \u5728\u4f5c\u7528\u57df\u5185\u4f1a\u963b\u585e(\u4e0d\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b)</li> <li><code>launch/async</code> \u5c5e\u4e8e\u6267\u884c\u5e76\u53d1\u4efb\u52a1, \u4e24\u8005\u533a\u5206\u5c31\u662f\u6709\u65e0\u8fd4\u56de\u503c</li> </ul>"},{"location":"sync-request/","title":"\u540c\u6b65\u8bf7\u6c42","text":"<p>Net\u652f\u6301\u5728\u5f53\u524d\u7ebf\u7a0b\u6267\u884c, \u4f1a\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u7684\u540c\u6b65\u8bf7\u6c42 -- <code>execute</code></p> <p>\u8fd9\u91cc\u4ecb\u7ecd\u7684\u662f\u4e0d\u4f7f\u7528\u534f\u7a0b\u7684\u540c\u6b65\u8bf7\u6c42. \u7531\u4e8eAndroid\u4e3b\u7ebf\u7a0b\u4e0d\u5141\u8bb8\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42, \u8fd9\u91cc\u6211\u4eec\u5f97\u968f\u4fbf\u521b\u5efa\u4e00\u4e2a\u5b50\u7ebf\u7a0b\u624d\u53ef\u4ee5\u5f00\u53d1\u8d77\u540c\u6b65\u8bf7\u6c42</p> \u540c\u6b65\u8bf7\u6c42 <pre><code>thread {\nval result = Net.post(\"api\").execute&lt;String&gt;() // \u7f51\u7edc\u8bf7\u6c42\u4e0d\u5141\u8bb8\u5728\u4e3b\u7ebf\u7a0b\ntvFragment?.post {\ntvFragment?.text = result  // view\u8981\u6c42\u5728\u4e3b\u7ebf\u7a0b\u66f4\u65b0\n}\n}\n</code></pre> toResult <pre><code>thread {\nval result = Net.post(\"api\").toResult&lt;String&gt;().getOrDefault(\"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef, \u6211\u8fd9\u662f\u9ed8\u8ba4\u503c\")\ntvFragment?.post {\ntvFragment?.text = result  // view\u8981\u6c42\u5728\u4e3b\u7ebf\u7a0b\u66f4\u65b0\n}\n}\n</code></pre> <ol> <li><code>execute</code>\u5728\u8bf7\u6c42\u53d1\u751f\u9519\u8bef\u65f6\u4f1a\u629b\u51fa\u5f02\u5e38</li> <li><code>toResult</code>\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38, \u901a\u8fc7<code>exception*</code>\u51fd\u6570\u6765\u83b7\u53d6\u5f02\u5e38\u4fe1\u606f, \u4e14\u652f\u6301\u9ed8\u8ba4\u503c\u7b49\u7279\u6027</li> </ol> <p>\u540c\u6b65\u8bf7\u6c42\u5e94\u7528\u573a\u666f\u4e00\u822c\u662f\u5728\u62e6\u622a\u5668\u4e2d\u4f7f\u7528, \u62e6\u622a\u5668\u9ed8\u8ba4\u662f\u5b50\u7ebf\u7a0b</p> <p>\u4f5c\u7528\u57df\u5177\u4f53\u4ecb\u7ecd\u53ef\u4ee5\u770b\u521b\u5efa\u4f5c\u7528\u57df</p> \u8bf7\u6c42\u51fd\u6570 \u63cf\u8ff0 Net.get \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.post \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.head \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.options \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.trace \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.delete \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.put \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5 Net.patch \u6807\u51c6Http\u8bf7\u6c42\u65b9\u6cd5"},{"location":"tag/","title":"\u6807\u7b7e/\u989d\u5916\u6570\u636e","text":"<p>Net\u652f\u6301\u4e24\u79cd\u7c7b\u578b\u6570\u636e\u8d2f\u7a7f\u6574\u4e2a\u8bf7\u6c42\u6d41\u7a0b(\u8bf7\u6c42 -&gt; \u62e6\u622a\u5668 -&gt; \u8f6c\u6362\u5668)</p> <ul> <li>tag: <code>HashMap&lt;Class&lt;*&gt;, Any?&gt;</code> \u6807\u7b7e</li> <li>extra: <code>HashMap&lt;String, Any?&gt;</code> \u989d\u5916\u6570\u636e</li> </ul> <p>\u4ed6\u4eec\u7684\u533a\u522b\u662fkey\u662fClass\u8fd8\u662fString\u7c7b\u578b, \u5177\u4f53\u4f7f\u7528\u54ea\u4e00\u79cd\u8bf7\u6839\u636e\u81ea\u5df1\u65b9\u4fbf\u6765</p>"},{"location":"tag/#_1","title":"\u6807\u7b7e\u4f7f\u7528","text":""},{"location":"tag/#1","title":"1) \u5199\u5165\u6807\u7b7e","text":"<pre><code>scopeNetLife {\ntvFragment.text = Get&lt;String&gt;(\"api\", \"\u6807\u7b7eA\"){ // \u4f7f\u7528Any::class.java\u4f5c\u4e3a\u952e\u540d\n// tag(\"\u6807\u7b7eA\") \u7b49\u6548\u4e0a\u4e00\u884c\u7684\u53c2\u6570 \"\u6807\u7b7eA\"\nsetExtra(\"tagName\", \"\u6807\u7b7eB\") // \u5199\u5165\u989d\u5916\u6570\u636e\n}.await()\n}\n</code></pre> <p><code>tagOf(Person())</code> \u7b49\u6548 <code>tag(Person::class.java, Person())</code>, \u53ea\u662f\u4f7f\u7528\u6cdb\u578b\u63a8\u65ad\u533a\u522b  \u4f46<code>tag(Person())</code> \u7b49\u6548 <code>tag(Any::class.java, Person())</code>, \u53ef\u4ee5\u67e5\u770b\u65b9\u6cd5\u5b9e\u73b0</p>"},{"location":"tag/#2","title":"2) \u62e6\u622a\u5668\u4e2d\u8bfb\u53d6\u6807\u7b7e","text":"<pre><code>class MyInterceptor : Interceptor {\noverride fun intercept(chain: Chain): Response {\nval request = chain.request()\nrequest.tag()?.let {\n// \u8bfb\u53d6\u6807\u7b7e\n}\nrequest.extra(\"tagName\")?.let {\n// \u8bfb\u53d6\u989d\u5916\u6570\u636e\n}\nreturn chain.proceed(request)\n}\n}\n</code></pre>"},{"location":"tag/#3","title":"3) \u8f6c\u6362\u5668\u4e2d\u8bfb\u53d6\u6807\u7b7e","text":"<pre><code>class MyConvert : NetConvert {\n\noverride fun &lt;R&gt; onConvert(succeed: Type, response: Response ): R? {\nresponse.request.tag()?.let{\n// \u8bfb\u53d6\u6807\u7b7e\n}\n}\n}\n</code></pre> <p>\u6211\u4eec\u901a\u8fc7Request\u7684\u51fd\u6570\u53ef\u4ee5\u8bfb\u53d6/\u5199\u5165\u6807\u7b7e/\u989d\u5916\u6570\u636e</p> \u65b9\u6cd5 \u63cf\u8ff0 setExtra \u5199\u5165\u989d\u5916\u6570\u636e extra \u8bfb\u53d6\u989d\u5916\u6570\u636e extras \u5168\u90e8\u989d\u5916\u6570\u636e tag \u8bfb\u53d6/\u5199\u5165\u6807\u7b7e tagOf \u8bfb\u53d6/\u5199\u5165\u6807\u7b7e, \u548c\u4e0a\u9762\u51fd\u6570\u4e0d\u540c\u7684\u65f6\u672c\u51fd\u6570\u4f7f\u7528\u7684\u6cdb\u578b\u800c\u975e<code>Class&lt;*&gt;</code> tags \u5168\u90e8\u6807\u7b7e"},{"location":"tag/#_2","title":"\u591a\u4e2a\u6807\u7b7e","text":"<pre><code>scopeNetLife {\nGet&lt;String&gt;(\"api\"){\nsetExtra(\"person\", Person()) // \u4f7f\u7528Request.extra(\"person\")\u8bfb\u53d6\ntag(User()) // \u7b49\u540c\u4e8etag(Any::class.java, User()), \u4f7f\u7528Request.tag()\u8bfb\u53d6\ntag(User::class.java, User()) // \u4f7f\u7528Request.tag(User::class.java)\u8bfb\u53d6\n}.await()\n}\n</code></pre> <p>\u5f97\u5230\u6807\u7b7e</p> <pre><code>class MyInterceptor : Interceptor {\noverride fun intercept(chain: Chain): Response {\nval request = chain.request()\nrequest.extra(\"person\")?.let {\n// it\u65e2\u4e3aPerson\u5bf9\u8c61\n}\nrequest.tagOf&lt;User&gt;() // \u7ed3\u679c\u4e3aUser()\nrequest.tag() // \u7ed3\u679c\u4e3aUser()\nreturn chain.proceed(request)\n}\n}\n</code></pre>"},{"location":"timing/","title":"\u9650\u65f6/\u5b9a\u65f6\u8bf7\u6c42","text":"<p>\u4ee5\u4e0b\u4ec5\u63d0\u4f9b\u4e00\u4e9b\u5982\u4f55\u5b9e\u73b0\u5b9a\u65f6/\u9650\u65f6\u8bf7\u6c42\u529f\u80fd\u7684\u601d\u8def, \u5e76\u4e0d\u9650\u5b9a\u53ea\u6709\u4ee5\u4e0b\u63cf\u8ff0\u7684\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0</p>"},{"location":"timing/#_1","title":"\u9650\u65f6\u8bf7\u6c42","text":"<pre><code>scopeDialog {\n// \u5f53\u63a5\u53e3\u8bf7\u6c42\u5728100\u6beb\u79d2\u5185\u6ca1\u6709\u5b8c\u6210\u4f1a\u629b\u51fa\u5f02\u5e38TimeoutCancellationException\nwithTimeout(100) {\nGet&lt;String&gt;(Api.BANNER).await()\n}\n}.catch {\nLog.e(\"\u65e5\u5fd7\", \"catch\", it) // catch\u65e0\u6cd5\u63a5\u6536\u5230CancellationException\u5f02\u5e38\n}.finally {\nLog.e(\"\u65e5\u5fd7\", \"finally\", it) // TimeoutCancellationException\u5c5e\u4e8eCancellationException\u5b50\u7c7b\u6545\u53ea\u4f1a\u88abfinally\u63a5\u6536\u5230\nif (it is TimeoutCancellationException) {\ntoast(\"\u7531\u4e8e\u672a\u5728\u6307\u5b9a\u65f6\u95f4\u5b8c\u6210\u8bf7\u6c42\u5219\u53d6\u6d88\u8bf7\u6c42\")\n}\n}\n</code></pre>"},{"location":"timing/#_2","title":"\u5b9a\u65f6\u8bf7\u6c42","text":"<p>\u6307\u5b9a\u8bf7\u6c4210\u6b21</p> <pre><code>scopeNetLife {\n// \u6bcf\u4e24\u79d2\u8bf7\u6c42\u4e00\u6b21, \u603b\u5171\u6267\u884c10\u6b21\nrepeat(20) {\ndelay(1000)\nval data =\nGet&lt;String&gt;(\"http://api.k780.com/?app=life.time&amp;appkey=10003&amp;sign=b59bc3ef6191eb9f747dd4e83c99f2a4&amp;format=json\").await()\nbinding.tvContent.text =\nJSONObject(data).getJSONObject(\"result\").getString(\"datetime_2\")\n// \u901a\u8fc7return@repeat\u53ef\u4ee5\u7ec8\u6b62\u5faa\u73af\n}\n}\n</code></pre> <p>\u65e0\u9650\u5faa\u73af\u8bf7\u6c42, \u53ef\u4ee5\u6839\u636e\u67d0\u4e2a\u6761\u4ef6<code>break</code>\u9000\u51fa</p> <pre><code>scopeNetLife {\n// \u6bcf\u4e24\u79d2\u8bf7\u6c42\u4e00\u6b21, \u603b\u5171\u6267\u884c10\u6b21\nwhile (true) {\ndelay(1.toDuration(DurationUnit.SECONDS))\nval data =\nGet&lt;String&gt;(\"http://api.k780.com/?app=life.time&amp;appkey=10003&amp;sign=b59bc3ef6191eb9f747dd4e83c99f2a4&amp;format=json\").await()\nbinding.tvContent.text =\nJSONObject(data).getJSONObject(\"result\").getString(\"datetime_2\")\n// \u901a\u8fc7break\u53ef\u4ee5\u7ec8\u6b62\u5faa\u73af\n}\n}\n</code></pre> <p>\u5efa\u8bae\u4e0b\u8f7d\u6e90\u7801\u67e5\u770b</p>"},{"location":"unique/","title":"\u91cd\u590d\u8bf7\u6c42","text":"<p>\u67d0\u4e2a\u91cd\u590d\u53d1\u8d77\u7684\u8bf7\u6c42, \u5728\u53d1\u8d77\u7684\u65f6\u5019\u81ea\u52a8\u53d6\u6d88\u65e7\u7684\u7f51\u7edc\u8bf7\u6c42. </p> <p>\u8fd9\u79cd\u5e94\u7528\u573a\u666f\u5e38\u89c1\u4e8e\u7b5b\u9009\u83dc\u5355, \u6bcf\u6b21\u70b9\u51fb\u83dc\u5355\u90fd\u4f1a\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42\u8fd4\u56de\u7b5b\u9009\u540e\u7684\u5217\u8868, \u4f46\u662f\u8bf7\u6c42\u672a\u5b8c\u6210\u65f6, \u7528\u6237\u53c8\u70b9\u51fb\u4e86\u65b0\u7684\u7b5b\u9009\u6761\u4ef6, \u8fd9\u4e2a\u65f6\u5019\u5e94\u8be5\u53d6\u6d88\u4e0a\u6b21\u8bf7\u6c42, \u91cd\u65b0\u53d1\u8d77\u65b0\u7684\u8bf7\u6c42 </p> <p>\u8fd9\u4e2a\u9700\u6c42\u5728Net\u4e2d\u975e\u5e38\u597d\u5b9e\u73b0, \u4fdd\u5b58\u4e00\u4e2a\u53d8\u91cf\u5373\u53ef</p> <pre><code>var scope: AndroidScope? = null\n\nbtn_request.setOnClickListener {\ntv_result.text = \"\u8bf7\u6c42\u4e2d\"\nscope?.cancel() // \u5982\u679c\u5b58\u5728\u5219\u53d6\u6d88\n\nscope = scopeNetLife {\nval result = Post&lt;String&gt;(\"api\").await()\nLog.d(\"\u65e5\u5fd7\", \"\u8bf7\u6c42\u5230\u7ed3\u679c\") // \u4f60\u4e00\u76f4\u91cd\u590d\u70b9\u51fb\"\u53d1\u8d77\u8bf7\u6c42\"\u6309\u94ae\u4f1a\u53d1\u73b0\u6c38\u8fdc\u65e0\u6cd5\u62ff\u5230\u8bf7\u6c42\u7ed3\u679c, \u56e0\u4e3a\u6bcf\u6b21\u53d1\u8d77\u65b0\u7684\u8bf7\u6c42\u4f1a\u53d6\u6d88\u672a\u5b8c\u6210\u7684\ntv_result.text = result\n}\n}\n</code></pre> <p>\u5f53<code>scope</code>\u4e0d\u4e3a\u7a7a\u65f6\u5373\u8868\u793a\u5b58\u5728\u4e0a\u4e2a\u8bf7\u6c42, \u6211\u4eec\u65e0\u8bba\u4e0a\u4e2a\u8bf7\u6c42\u662f\u5426\u5b8c\u6210\u90fd\u8c03\u7528<code>cancel</code>\u51fd\u6570\u4fdd\u8bc1\u53d6\u6d88\u5373\u53ef</p> <p>\u8be6\u7ec6\u7684\u5173\u4e8e\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42\u7684\u64cd\u4f5c\u67e5\u770b: \u53d6\u6d88\u8bf7\u6c42</p>"},{"location":"updates/","title":"\u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"updates/#356","title":"3.5.6","text":"<ul> <li>feat: \u65b0\u589e BaseRequest.execute \u975e\u5185\u8054\u51fd\u6570\u91cd\u8f7d</li> <li>feat: Net.kt\u652f\u6301Java\u9759\u6001\u8c03\u7528</li> <li>refactor: LogRecordInterceptor @JvmOverloads</li> <li>fix: Interval.onlyResumed \u7ed3\u675f\u8f6e\u8be2</li> <li>pref: \u5220\u9664\u8f6c\u6362\u5668\u83b7\u53d6\u7684\u53cd\u5c04\u8c03\u7528</li> </ul>"},{"location":"updates/#355","title":"3.5.5","text":"<ul> <li>fix: #157 \u65e5\u5fd7\u62e6\u622a\u5668\u5931\u6548</li> </ul>"},{"location":"updates/#354","title":"3.5.4","text":"<ul> <li>refactor: peekString rename to peekBytes, remove logString</li> <li>fix: \u53ef\u80fd\u5b58\u5728\u7684\u5185\u5b58\u6cc4\u6f0f</li> </ul>"},{"location":"updates/#353","title":"3.5.3","text":"<ul> <li>feat: \u9ed8\u8ba4\u4f7f\u7528NetDialogFactory\u7684setCancelable\u914d\u7f6e</li> <li>fix: #150 scopeDialog\u9884\u89c8\u6a21\u5f0f</li> </ul>"},{"location":"updates/#352","title":"3.5.2","text":"<ul> <li>fix: #135 Content-MD5\u672a\u4f7f\u7528Base64\u89e3\u7801</li> <li>feat: \u65b0\u589e BaseRequest.headers</li> </ul>"},{"location":"updates/#351","title":"3.5.1","text":"<ul> <li>feat: \u65b0\u589eparam\u65b9\u6cd5\u53c2\u6570Uri</li> <li>feat: \u65b0\u589eaddQuery\u65b9\u6cd5</li> <li>pref: \u4e0d\u6df7\u6dc6exception\u5305</li> <li>fix: #129 \u8bf7\u6c42URL\u4e0d\u540c\u5bfc\u81f4setCacheKey\u65e0\u6548</li> </ul>"},{"location":"updates/#350","title":"3.5.0","text":"<ul> <li>refactor: \u5220\u9664\u6743\u9650REQUEST_INSTALL_PACKAGES(\u8c37\u6b4c\u5546\u5e97\u6743\u9650\u8981\u6c42)</li> <li>refactor: \u5220\u9664File.install</li> <li>pref: \u6539\u4e3a\u4f7f\u7528AppStartup\u9ed8\u8ba4\u521d\u59cb\u5316</li> </ul>"},{"location":"updates/#3414","title":"3.4.14","text":"<ul> <li>fix: Fragment\u672a\u521d\u59cb\u5316View\u6267\u884cscopeNetLife\u5bfc\u81f4\u7a7a\u6307\u9488</li> </ul>"},{"location":"updates/#3413","title":"3.4.13","text":"<ul> <li>fix: #110 \u7f13\u5b58\u6a21\u5f0f\u4e0bRequest\u4fe1\u606f\u4e22\u5931</li> </ul>"},{"location":"updates/#3412","title":"3.4.12","text":"<ul> <li>fix: FlowUtils.kt #102</li> </ul>"},{"location":"updates/#3411","title":"3.4.11","text":"<ul> <li>fix: \u7f3a\u5931trace\u8bf7\u6c42\u65b9\u5f0f #99</li> </ul>"},{"location":"updates/#3410","title":"3.4.10","text":"<ul> <li>fix: #91 \u4fee\u590dViewPager2\u7684\u89c6\u56fe\u751f\u547d\u5468\u671f\u5bfc\u81f4\u7f51\u7edc\u8bf7\u6c42\u88ab\u53d6\u6d88</li> <li>fix: LogCat\u9519\u8bef\u53d1\u751f\u4f4d\u7f6e\u9ad8\u4eae</li> <li>feat: brv 1.3.76</li> <li>pref: DialogCoroutineScope</li> </ul>"},{"location":"updates/#348","title":"3.4.8","text":"<ul> <li>fix: \u4e0d\u63d0\u4ea4null\u8bf7\u6c42\u53c2\u6570</li> </ul>"},{"location":"updates/#347","title":"3.4.7","text":"<ul> <li>\u5347\u7ea7\u4f9d\u8d56</li> <li>\u652f\u6301\u534f\u7a0b1.6.0</li> <li>optimize Interval</li> <li>EditText.debounce\u4e8b\u4ef6\u7c7b\u578b\u6539\u4e3aEditable</li> </ul>"},{"location":"updates/#346","title":"3.4.6","text":"<ul> <li>\u65b0\u589e\u5f3a\u5236\u7f13\u5b58\u6709\u6548\u671f</li> </ul>"},{"location":"updates/#345","title":"3.4.5","text":"<ul> <li>Fixed #88</li> <li>Interval.life(Fragment)\u6539\u4e3aonDestroyView\u65f6\u9500\u6bc1</li> </ul>"},{"location":"updates/#344","title":"3.4.4","text":"<ul> <li>\u65b0\u589eCookie\u7ba1\u7406</li> </ul>"},{"location":"updates/#343","title":"3.4.3","text":"<ul> <li>\u4fee\u590dgzip\u5bfc\u81f4\u7684\u5f3a\u5236\u7f13\u5b58\u8bfb\u53d6\u5931\u8d25</li> <li>\u4fee\u590dNoCacheException\u65e0\u6cd5\u6355\u83b7</li> <li>\u54cd\u5e94\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u6765\u81ea\u4e8e\u7f13\u5b58</li> <li>\u4f18\u5316\u7f13\u5b58\u76f8\u5173\u4ee3\u7801</li> </ul>"},{"location":"updates/#342","title":"3.4.2","text":"<ul> <li>\u4fee\u590dHttp\u7f13\u5b58\u534f\u8bae\u65e0\u6548</li> <li>\u65e5\u5fd7\u62e6\u622a\u5668\u9519\u8bef\u4fe1\u606f\u7b80\u7565</li> </ul>"},{"location":"updates/#341","title":"3.4.1","text":"<ul> <li>\u7981\u7528\u5931\u8d25\u7f13\u5b58</li> </ul>"},{"location":"updates/#340","title":"3.4.0","text":"<ul> <li>\u65b0\u589e\u5f3a\u5236\u7f13\u5b58\u6a21\u5f0f</li> <li>\u65b0\u589e\u9884\u89c8\u6a21\u5f0f(\u53ef\u5b9e\u73b0\u7f13\u5b58+\u7f51\u7edc)</li> </ul>"},{"location":"updates/#331","title":"3.3.1","text":"<ul> <li>\u5e9f\u5f03\u90e8\u5206\u65e5\u5fd7\u76f8\u5173\u51fd\u6570</li> <li>\u65b0\u589eNet.debug\u65e5\u5fd7\u8f93\u51fa\u51fd\u6570</li> <li>\u4fee\u590dQuery\u7f16\u7801\u95ee\u9898</li> </ul>"},{"location":"updates/#330","title":"3.3.0","text":"<ul> <li>\u5220\u9664Callback/onResult(\u7834\u574f\u6027\u8fc1\u79fb)</li> <li>\u5220\u9664requestById/requestByGroup(\u7834\u574f\u6027\u8fc1\u79fb)</li> <li>Add View.scopeNetLife</li> <li>\u7f51\u7edc\u8bf7\u6c42\u5f02\u5e38\u4f4d\u7f6e\u8ffd\u8e2a</li> </ul>"},{"location":"updates/#322","title":"3.2.2","text":"<ul> <li>Fixed #77</li> <li>\u4fee\u590dgzip\u542f\u7528\u60c5\u51b5\u4e0b\u8f7d\u8fdb\u5ea6\u59cb\u7ec8\u4e3a0</li> <li><code>Progress.finish()</code>\u65b9\u6cd5\u6539\u4e3a\u5c5e\u6027</li> </ul>"},{"location":"updates/#321","title":"3.2.1","text":"<ul> <li>Fixed #76</li> <li><code>RequestBody?.peekString()</code>\u51fd\u6570\u63a5\u53d7\u8005\u6539\u4e3a\u975e\u53ef\u7a7a\u7c7b\u578b</li> </ul>"},{"location":"updates/#320","title":"3.2.0","text":"<ul> <li>\u66f4\u6539tag\u76f8\u5173\u51fd\u6570</li> <li>\u66f4\u6539<code>NetConfig.app</code>\u7c7b\u578b\u6539\u4e3aContext</li> <li>\u5220\u9664\u654f\u611f\u6743\u9650(\u5916\u90e8\u5b58\u50a8\u8bfb\u5199)</li> <li>\u5220\u9664\u5e9f\u5f03\u51fd\u6570/\u63d0\u9ad8\u51fd\u6570\u5e9f\u5f03\u7b49\u7ea7</li> <li>\u5e9f\u5f03<code>NetConfig.init</code></li> <li>\u5220\u9664fastest\u51fd\u6570\u63a5\u53d7\u8005</li> <li>\u5220\u9664logRecord\u5c5e\u6027</li> <li>\u4f18\u5316\u57df\u540d\u89e3\u6790\u9519\u8bef\u5f02\u5e38\u4fe1\u606f</li> <li>\u65b0\u589e\u65e0\u7f51\u7edc\u4e0d\u53ef\u7528\u5f02\u5e38<code>NetworkingException</code></li> <li>\u65b0\u589e\u8f93\u51faMultiPart\u53c2\u6570\u65e5\u5fd7</li> <li>\u66f4\u6539RetryInterceptor/LogRecordInterceptor\u5c5e\u6027\u8bbf\u95ee\u6743\u9650</li> </ul>"},{"location":"updates/#312","title":"3.1.2","text":"<ul> <li>\u5347\u7ea7BRV\u81f31.3.51, \u5176\u5185\u90e8\u5347\u7ea7SmartRefreshLayout\u81f32.0.5. SmartRefreshLayout\u76f8\u5173\u4f9d\u8d56\u9700\u8981\u8fc1\u79fb</li> <li>Interval\u6dfb\u52a0<code>onlyResumed</code>\u51fd\u6570</li> <li>Interval\u4fee\u6539<code>life</code>\u51fd\u6570\u53c2\u6570\u4e3aFragmentActivity\u60c5\u51b5\u4e0b\u7684\u81ea\u52a8\u53d6\u6d88\u8f6e\u8be2\u5668\u7684\u751f\u547d\u5468\u671f</li> </ul>"},{"location":"updates/#311","title":"3.1.1","text":"<p>\u5185\u5d4c\u6df7\u6dc6\u89c4\u5219, \u4e0d\u9700\u8981\u624b\u52a8\u6dfb\u52a0</p>"},{"location":"updates/#310","title":"3.1.0","text":"<ul> <li>\u4fee\u590d\u90e8\u5206\u5b50\u7ebf\u7a0b\u5f00\u542f\u4f5c\u7528\u57df\u5d29\u6e83</li> <li>\u7f51\u7edc\u5f02\u5e38\u5806\u6808\u4f7f\u7528 NetConfig.TAG \u4f5c\u4e3a\u6807\u7b7e, \u4f7f\u7528debug\u65e5\u5fd7\u7c7b\u578b\u8f93\u51fa</li> <li>\u9ed8\u8ba4\u8f6c\u6362\u5668\u73b0\u5728\u8981\u6c42HTTP\u72b6\u6001\u7801\u4e3a\u6210\u529f\u624d\u8fd4\u56de\u6570\u636e(\u6cdb\u578bResponse\u8bf7\u6c42\u5b8c\u6210\u90fd\u8fd4\u56de)</li> <li>\u5f00\u542f\u7f16\u8bd1\u5668\u5f3a\u5236\u66ff\u6362\u5e9f\u5f03\u51fd\u6570(\u53ef\u67e5\u770b\u51fd\u6570\u6ce8\u91ca\u66ff\u6362\u89c4\u5219)</li> <li>\u7981\u6b62\u66b4\u9732\u5197\u4f59\u51fd\u6570</li> </ul>"},{"location":"updates/#3027","title":"3.0.27","text":"<ul> <li>setDownloadDir\u51fd\u6570\u540c\u65f6\u652f\u6301\u5b8c\u6574\u8def\u5f84(\u5373\u5305\u542b\u6587\u4ef6\u540d\u79f0)\u548c\u4e0b\u8f7d\u76ee\u5f55</li> </ul>"},{"location":"updates/#3026","title":"3.0.26","text":"<ul> <li>\u4f18\u5316\u8fd4\u56deByteArray\u7c7b\u578b\u6027\u80fd</li> <li>setQuery\u51fd\u6570\u652f\u6301Number/Boolean\u7c7b\u578b</li> <li>\u65b0\u589e\u4e00\u4e2a\u9519\u8bef\u63d0\u793a HttpFailureException</li> </ul>"},{"location":"updates/#3025","title":"3.0.25","text":"<ul> <li>\u8f6e\u8be2\u5668\u652f\u6301ViewModel\u53d6\u6d88</li> <li>\u4fee\u590d\u65e0\u6cd5\u8fd4\u56deByteArray\u7c7b\u578b\u95ee\u9898</li> <li>\u95f4\u63a5\u4f9d\u8d56 update brv 1.3.37</li> <li>\u66f4\u65b0\u51fd\u6570\u6ce8\u91ca</li> </ul>"},{"location":"updates/#3024","title":"3.0.24","text":"<p>\u4fee\u590d\u4e0a\u4f20\u6587\u4ef6\u5305\u542b\u53c2\u6570\u65f6, \u7f16\u7801\u95ee\u9898\u5bfc\u81f4\u7684\u53c2\u6570\u9519\u8bef</p>"},{"location":"updates/#3023","title":"3.0.23","text":"<ul> <li>\u4fee\u590d\u8f6e\u8be2\u5668\u91cd\u590dstart\u65e0\u6548\u95ee\u9898</li> <li>Interval\u5176\u4ed6\u4f18\u5316</li> </ul>"},{"location":"updates/#3021","title":"3.0.21","text":"<ul> <li>Interval\u6dfb\u52a0cancel\u51fd\u6570\u7528\u4e8e\u53d6\u6d88\u8ba1\u65f6\u5668, \u53d6\u6d88\u5b8c\u6210\u4e0d\u4f1a\u8c03\u7528finish</li> </ul>"},{"location":"updates/#3020","title":"3.0.20","text":"<ul> <li>\u65b0\u589e<code>HttpFailureException</code>\u53ca\u5176\u5b50\u7c7b\u8868\u793a\u8bf7\u6c42\u5931\u8d25\u5f02\u5e38</li> <li>\u65b0\u589e<code>HttpResponseException</code>\u53ca\u5176\u5b50\u7c7b\u8868\u793a\u8bf7\u6c42\u6210\u529f\u540e\u53d1\u751f\u7684\u5f02\u5e38</li> <li>\u66f4\u65b0\u4f9d\u8d56\u5e93BRV\u81f31.3.31</li> </ul>"},{"location":"updates/#3019","title":"3.0.19","text":"<ul> <li>\u66f4\u65b0\u4f9d\u8d56\u5e93BRV\u81f31.3.30</li> </ul>"},{"location":"updates/#3018","title":"3.0.18","text":"<ul> <li>\u4fee\u590dResponse\u6d41\u5f02\u5e38\u5173\u95ed\u95ee\u9898</li> </ul>"},{"location":"updates/#3017","title":"3.0.17","text":"<ul> <li>\u4fee\u590dProfiler\u5bfc\u81f4\u7684\u8bf7\u6c42\u95ee\u9898</li> </ul>"},{"location":"updates/#3016","title":"3.0.16","text":"<ul> <li>\u65e5\u5fd7\u8bb0\u5f55\u5668\u4e2d\u8bf7\u6c42\u53c2\u6570\u9ed8\u8ba4\u4f7f\u7528URLDecoder\u89e3\u7801</li> </ul>"},{"location":"updates/#3015","title":"3.0.15","text":"<ul> <li>\u4fee\u590dFileProvider\u51b2\u7a81</li> <li>\u4e0a\u4f20\u6587\u4ef6\u65f6\u9ed8\u8ba4\u751f\u6210filename(\u5f53\u4f60\u672a\u6307\u5b9a\u6587\u4ef6\u540d\u60c5\u51b5\u4e0b)</li> <li>NetCallback\u7f51\u7edc\u8bf7\u6c42\u88ab\u53d6\u6d88\u4e0d\u4f1a\u56de\u8c03onError</li> <li>\u4e3aNetCallback\u6dfb\u52a0Request\u5bf9\u8c61</li> <li>\u5220\u9664\u5185\u90e8Tooltip\u4f9d\u8d56</li> </ul>"},{"location":"updates/#3014","title":"3.0.14","text":"<ul> <li>\u4fee\u590dKType\u7c7b\u578b\u95ee\u9898</li> <li>\u652f\u6301<code>File.install</code>\u51fd\u6570\u5b89\u88c5\u5e94\u7528</li> </ul>"},{"location":"updates/#3013","title":"3.0.13","text":"<ul> <li>\u4f18\u5316\u6807\u7b7e\u76f8\u5173\u51fd\u6570. \u6574\u4e2a\u7f51\u7edc\u751f\u547d\u5468\u671f\u53ef\u4ee5\u5b8c\u7f8e\u4f20\u9012\u53c2\u6570</li> <li>NetCallback\u5177\u5907\u8ddf\u968f\u751f\u547d\u5468\u671f\u81ea\u52a8\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42</li> <li>\u6269\u5c55NetCallback\u6765\u6dfb\u52a0DialogCallback/StateCallback/PageCallback</li> <li>\u5e9f\u5f03\u90e8\u5206\u51fd\u6570, \u4f8b\u5982onDialog\u88ab\u5e9f\u5f03, \u73b0\u5728\u7531<code>NetConfig.dialogFactory</code>\u6784\u5efa\u5168\u5c40\u52a0\u8f7d\u5bf9\u8bdd\u6846</li> <li>initNet\u73b0\u5728\u5e9f\u5f03, \u7531<code>NetConfig.initialize</code>\u53d6\u4ee3. \u6240\u6709\u914d\u7f6e\u4fe1\u606f\u7531NetConfig\u627f\u8f7d</li> <li>RequestParamsException\u6dfb\u52a0\u9519\u8bef\u7801\u4fe1\u606f</li> </ul>"},{"location":"updates/#3012","title":"3.0.12","text":"<ul> <li>\u4fee\u590d\u8f6c\u6362\u5668\u629b\u51fa\u7684\u5f02\u5e38\u5168\u90e8\u88ab<code>ConvertException</code>\u5305\u88f9\u7684\u95ee\u9898</li> <li>NetException\u5b50\u7c7b\u4e0d\u4f1a\u88abConvertException\u5305\u88f9, \u6240\u4ee5\u8981\u6355\u83b7\u8f6c\u6362\u5668\u4e2d\u7684\u81ea\u5b9a\u4e49\u5f02\u5e38\u8bf7\u5176\u7ee7\u627fNetException</li> </ul>"},{"location":"updates/#3011","title":"3.0.11","text":"<ul> <li>\u4fee\u590d\u4e34\u65f6\u4e0b\u8f7d\u6587\u4ef6\u9519\u8bef\u95ee\u9898</li> <li>\u4fee\u590dViewModel\u4f5c\u7528\u57df\u590d\u7528\u95ee\u9898</li> </ul>"},{"location":"updates/#3010","title":"3.0.10","text":"<ul> <li>\u5347\u7ea7Tooltip\u4f9d\u8d56, \u89e3\u51b3\u4f7f\u7528Tooltip_V1.1.1\u4f9d\u8d56\u65f6Net\u5b58\u5728\u5d29\u6e83\u95ee\u9898</li> </ul>"},{"location":"updates/#309","title":"3.0.9","text":"<ul> <li>\u4f18\u5316\u8f6c\u6362\u5668\u5f02\u5e38\u5904\u7406</li> <li>\u8f6c\u6362\u5668\u652f\u6301\u975e\u56fa\u5b9a\u683c\u5f0fJson\u89e3\u6790</li> </ul>"},{"location":"updates/#307","title":"3.0.7","text":"<ul> <li>\u4fee\u590d\u672a\u77e5\u7684TypeToken\u8bbf\u95ee\u6743\u9650\u95ee\u9898</li> </ul>"},{"location":"updates/#306","title":"3.0.6","text":"<ul> <li>\u6240\u6709Json\u89e3\u6790\u6846\u67b6\u90fd\u53ef\u4ee5\u89e3\u6790<code>List&lt;UserModel&gt;</code>\u7b49\u5d4c\u5957\u6cdb\u578b\u6570\u636e\u7ed3\u6784: \u7279\u6b8a\u7ed3\u6784\u89e3\u6790</li> </ul>"},{"location":"updates/#305","title":"3.0.5","text":"<ul> <li>\u4fee\u590dPath\u7f16\u7801\u95ee\u9898</li> <li>\u4e0a\u4f20File\u81ea\u52a8\u8bc6\u522bMediaType</li> </ul>"},{"location":"updates/#304","title":"3.0.4","text":"<ul> <li>\u6dfb\u52a0MediaConst\u8868\u793a\u5e38\u7528MediaType</li> <li>OkHttpBuilder\u6dfb\u52a0<code>setErrorHandler</code>\u53d6\u4ee3onError/onStateError: \u5168\u5c40\u9519\u8bef\u5904\u7406</li> <li>\u63d0\u4f9b\u517c\u5bb9Android4.4(API level 19)\u7684\u7248\u672c: Net-okhttp3</li> </ul>"},{"location":"updates/#303","title":"3.0.3","text":"<ul> <li>\u6dfb\u52a0<code>onResult</code>\u51fd\u6570\u6765\u6267\u884c\u961f\u5217\u8bf7\u6c42: \u961f\u5217\u8bf7\u6c42</li> <li>\u6dfb\u52a0<code>toResult</code>\u51fd\u6570\u6765\u6267\u884c\u540c\u6b65\u8bf7\u6c42: \u540c\u6b65\u8bf7\u6c42</li> <li>\u8bf7\u6c42\u4f53\u65e5\u5fd7\u652f\u6301JSON/\u6587\u672c\u7c7b\u578b</li> <li>LogRecordInterceptor\u66b4\u9732<code>requestString/responseString</code>\u5b9e\u73b0\u51fd\u6570\u7528\u4e8e\u7ee7\u627f\u5b9e\u73b0\u81ea\u5b9a\u4e49\u9700\u6c42</li> </ul>"},{"location":"updates/#302","title":"3.0.2","text":"<p>\u4fee\u590d\u591a\u6e20\u9053\u65e0\u6cd5\u5b89\u88c5\u95ee\u9898</p>"},{"location":"updates/#301","title":"3.0.1","text":"<ul> <li>\u8f6c\u6362\u5668\u652f\u6301KType, \u89e3\u51b3JAVA\u6cdb\u578b\u64e6\u9664\u95ee\u9898</li> <li>\u652f\u6301kotlin-serialization\u8f6c\u6362\u5668</li> <li>\u4fee\u590dJSON\u8bf7\u6c42\u53c2\u6570\u7c7b\u578b\u95ee\u9898</li> </ul>"},{"location":"updates/#30","title":"3.0","text":"<ul> <li>\u91cd\u6784\u4ee3\u7801, \u63d0\u5347\u7a33\u5b9a\u6027\u548c\u5b89\u5168\u6027.</li> <li>\u652f\u6301OkHttp\u7684\u6240\u6709\u51fd\u6570/\u7ec4\u4ef6, \u53ef\u72ec\u7acb\u5347\u7ea7OkHttp\u7248\u672c</li> <li>\u66f4\u52a0\u5f3a\u5927\u7684\u4e0b\u8f7d\u529f\u80fd</li> <li>\u6240\u6709IO\u8bfb\u5199\u4f7f\u7528OKIO</li> <li>\u66f4\u52a0\u4f18\u96c5\u7684\u51fd\u6570\u8bbe\u8ba1</li> </ul>"},{"location":"upload-file/","title":"\u4e0a\u4f20\u6587\u4ef6","text":"<p>\u4e0a\u4f20\u6587\u4ef6\u548c\u666e\u901a\u63a5\u53e3\u8bf7\u6c42\u533a\u522b\u4e0d\u5927</p> <pre><code>scopeNetLife {\nPost&lt;String&gt;(\"upload\") {\nparam(\"fileName\", assetsFile())\n}.await()\n}\n</code></pre> <p>\u4f7f\u7528<code>addUploadListener</code>\u6dfb\u52a0\u4e0a\u4f20\u8fdb\u5ea6\u76d1\u542c\u5668, \u76d1\u542c\u4e0a\u4f20\u8fdb\u5ea6\u5177\u4f53\u4ecb\u7ecd\u5728\u8fdb\u5ea6\u76d1\u542c\u4e2d</p>"},{"location":"upload-file/#_1","title":"\u6307\u5b9a\u7c7b\u578b","text":"<p>\u9ed8\u8ba4\u4f1a\u6839\u636e\u6587\u4ef6\u7684\u540e\u7f00\u540d\u4ea7\u751fMediaType. \u4f46\u662f\u5982\u679c\u4f60\u60f3\u81ea\u5b9a\u4e49MediaType\u53ef\u4ee5\u76f4\u63a5\u521b\u5efaRequestBody\u53c2\u6570</p> <pre><code>scopeNetLife {\nPost&lt;String&gt;(\"upload\") {\nparam(\"file\", assetsFile().toRequestBody(\"image/webp\".toMediaType()))\n}.await()\n}\n</code></pre>"},{"location":"view-model/","title":"ViewModel","text":"<p>Net\u652f\u6301\u5728ViewModel\u4e2d\u521b\u5efa\u7f51\u7edc\u8bf7\u6c42/\u5f02\u6b65\u4efb\u52a1, \u5e76\u4e14\u5728ViewModel\u88ab\u9500\u6bc1\u65f6\u81ea\u52a8\u53d6\u6d88</p>"},{"location":"view-model/#_1","title":"\u4f7f\u7528","text":"<p>\u548c\u4e00\u822c\u7f51\u7edc\u8bf7\u6c42\u6ca1\u6709\u533a\u522b, \u5728ViewModel\u4e2d\u4f7f\u7528\u51fd\u6570<code>scopeLife/scopeNetLife</code>\u8fd9\u4e24\u4e2a\u51fd\u6570\u521b\u5efa\u4f5c\u7528\u57df\u5373\u53ef, \u5177\u4f53\u4ecb\u7ecd\u770b\u4f5c\u7528\u57df</p> <pre><code>class UserViewModel : ViewModel() {\n\n// \u7528\u6237\u4fe1\u606f\nvar userInfo: MutableLiveData&lt;String&gt; = MutableLiveData()\n\n/**\n     * \u62c9\u53d6\u7528\u6237\u4fe1\u606f, \u4f1a\u81ea\u52a8\u901a\u77e5\u9875\u9762\u66f4\u65b0, \u540c\u65f6\u9875\u9762\u9500\u6bc1\u4f1a\u81ea\u52a8\u53d6\u6d88\u7f51\u7edc\u8bf7\u6c42\n     */\nfun fetchUserInfo() = scopeNetLife {\nuserInfo.value = Get&lt;String&gt;(\"api\").await()\n}\n}\n</code></pre> <ol> <li>\u4e0d\u5efa\u8bae\u4f7f\u7528LiveData\u5b9e\u73b0MVVM. \u5e94\u5f53\u4f7f\u7528DataBinding. \u4f46LiveData\u50cfObservableField\u4e00\u6837\u4f7f\u7528</li> <li>\u7b80\u5355\u5730\u4e1a\u52a1\u76f4\u63a5\u5728Activity/Fragment\u4e2d\u8fdb\u884c\u8bf7\u6c42\u4f1a\u66f4\u52a0\u65b9\u4fbf</li> <li>ViewModel\u8fd9\u4e2a\u7c7b\u672c\u8d28\u662f\u5c5e\u4e8e\u9632\u6b62\u6570\u636e\u610f\u5916\u9500\u6bc1\u6216\u8005\u6865\u63a5VM, \u4f46\u4e0d\u662f\u6bcf\u4e2a\u9875\u9762\u90fd\u6709\u8fd9\u79cd\u9700\u6c42</li> </ol> <p></p> <p></p>"}]}